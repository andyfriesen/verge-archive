// Includes 454 Ints, 110 strings and 191 functions
// Includes among others: battlesystem for TCoD, All menusystems,
// and weapon & itemshops
// Everything is now public.
// -Immortalowl-

int healamount[30], charpotr[10], itemamount[500], ammo[20], maxammo[20],
    equipment[500], equipped[500], menupnt[20], eqmenu[10], equipmenttype, amm,
    spell[100], magimenu[10], spellact[100], inmenuitem[99], maxmenuitems,
    chaagi[50], wagiadd[500], chasta[50], wstaadd[500], chaa[50], waadd[500],
    item[500], weapontype[500], inmenuweapon[500], armortype[300],
    inmenuarmor[300], weaponbasetype[500], armoramount[300], armorbasetype[300],
    armor[300], equ[100], inmenuequ[99], equamount[100], cansave, savetemp[10],
    relic[100], relicamount[100], inmenurelic[100], equippedweapon[500],
    equippedarmor[500], equippedequipment[100], equippedrelic[100],
    equippedhelmet[100], equippedlegs[100], equippedshield[100], musicpiece[50],
    basehp[50], weapondamage[500], monsta[20], monac[20], monws[99],
    ebasedamage[10], chaws[50], moncond[20], monattcond[10], mattcondperc[10],
    charcond[50], pointer2, cancausepara[10], cancausepoison[10],
    cancausecurse[10], running;
string itemname[500], tempstring[999], itamount[500], itemdesc[500],
    ammunition[20], maxammunition[20], equipmentdesc[500], equipmentname[500],
    equipstate[500], equipmenteff[500], maxpage, itempages, vali, got, many,
    found, crow, weaponname[100], weapondesc[100], armorname[100],
    armordesc[100], shopitemprice[10], shopweaponprice[10], shoparmorprice[10],
    pieces, charagi[50], charsta[50], chara[50], wetype[500], armtype[300],
    weamount[500], armamount[300], eqamount[100], savemap, savemusic, savechar,
    relicname[100], relicdesc[100], relamount[100], tnext[50], music[99],
    charws[50], moattcond, chacond[50];
int font, nasgha[99], crowns, monstersound[99], piece, enemydamage,
    spellbasetype[99], spellused, battlegoing, spelldamage[99], gotspell[99],
    itemused, gly;
int charpic[50], chalevel[50], chahp[50], chacurhp[50], chamaxhp[50],
    inparty[10], champ[50], chamaxmp[50], chabaseanim[99], chadeadanim[99],
    charini[50], monexp[9], shopitem[50], shopweapon[50], shoparmor[50],
    itemgroup, weapongroup, armorgroup, itemprice[500], weaponprice[100],
    armorprice[100], added, whpadd[500], wmpadd[999], wstradd[500],
    wintadd[500], wacadd[500], wthacoadd[500], temp[9999];
int chastr[50], chaint[50], weapon[500], weaponamount[500], statuex, statuey,
    statue[99], swit[99], battletype, once, aliveparty, levelling,
    spelltype[99], inmenuspell[99], spellamount[99], spellpointcost[99],
    spellhealamount[99];
int armhpadd[300], armmpadd[300], armaadd[300], armintadd[300], armagiadd[300],
    armacadd[300], armthacoadd[300], armstradd[300], armstaadd[300],
    equhpadd[100], equmpadd[100], equstradd[100], equstaadd[100],
    equagiadd[100], equaadd[100], equintadd[100], relichpadd[100],
    relicmpadd[100], relicstradd[100], relicstaadd[100], relicaadd[100],
    relicagiadd[100], relicintadd[100];
int bbox, bbox2, bbox3, pointer1, pnt2, pnt, menub, character[50], itempage,
    maxpages, stat, skil, magi, user, bullets[50], maxbullets[50],
    optionsnumber, songstoneamount;
int charposit[5], X, mmenu, mpic1, mpic2, mpic3, mpic4, mpic5, mpic6, bull,
    textfont, writed;
int soundi, ent1, ent2, i, ichest[100], world[99];
int wochest[70], a, b, d, f, v, u, h, k, m, p, l, r, o, Zmostable,
    Zlantern_flag;
int tdoor[99], tdoor2[99], textplace[99];
int sysfont, gamefont, jar[500], picplacex[99], picplacey[99], picplace2y[99],
    inmenu[10], battle, spellsinmenu;
int mtable, oldposit[99], newposit[99], charipic[99], charipics[99];
int oldhp[1], newhp[99], jar2[5], arkku[20];
int y, nummon2, numchars2;
int songf, conv[99], volu, shop, missed, talk[99], barrl[20];
int ms, sec, min, hour, domain, target;
string charlevel[50], totalprice, chaexp[50], time, col1, col2, recexp,
    spells[100], charhp[40], charmaxhp[40], charname[40], charmaxmp[50],
    charmp[50], charstr[50], charint[50], charthaco[50], charac[50];
int dodo, t, s[99], chrTHAC0[50], chrAC[50], e, Ent[4], mslu, gate, tower[99],
    bell[50], photo[50], cave[99], stone[100], hammer[9], maxsongpages,
    songpage, songfound[99], slums[99];
string equip[9], maxsongpage, songpages, song, songname[99], songlast[99],
    songdesc[99], oldsong, vol, heaamount[100], battlemusa;
int loc1, loc2, loc3, chance, monx, mony, monspellx, monspelly;
int problem, barrel[100], charexp[50];
int im, numchars, allchardead, courty[10];
int im2, dodo2;
int im3, speechpic, jarinside, charpics[99], entlocx2, entlocy2;
int nullSound, openMenuSound, clicksound, menuItemSound, mode[9], crash[9];
int geo, specent, speed, spd[99];
int c, g;
int menubg;
// int flags[8000];
// int gp;
int ImageBuffer, forceret, hole[30], avain[10];
int Layer1;
int loop;
int system_initialized;
int textbox;
int ptrgfx;
string location, number, spehealamount[99], spelldesc[99], spepointcost[99],
    batmap;
int gotox, gotoy;
int done, Uitem[99], dalari[50], characterhp[40], chardead[40],
    charactermaxhp[40], charx[40], chary[40], charcurhp[99], char[99];
int soundeffect[99];
int snd_null;
int snd_mmenu;
int locX;
int locY;
string crownamount, current_map;
int w, nummon, mongroup;
int entlocx, entlocy, j, qnum, apnt, savex, savey, pnt6;
int qpnt, font4, z;
int monstr[10], questio, totalmoneyreceived, loaded, saveloc, lup;
int money, getmoney;
int pnt4, moncrown[10];
int hitx, hity;
int pnt5;
int bbox4, pnt3, skill, skill1, font3;
int font2, damage, mongp;
string dam, dam2, heal1;
int songstone;
int montarget, mnum, battleind;
int attchange, atkchance, targ, mapnum, ent3, ent4, ent5, ent6, lever[20], card,
    card2, monmaxhp[10], damx, damy, font5;
string recmoney, gainedmoney, monspirit, partspirit, rounds, itetype[99],
    spetype[99];
string battlehp[10], battlemaxhp[10], battlemp[10], battlemaxmp[10],
    battlename[10], monstername[10], battlemonstername[10], batmonsterhp[10],
    batmonstermp[10], batmonstermaxhp[10], batmonstermaxmp[10], logi, mappi,
    spellname[99], gainedexp;
int battlechar[10], battlelocx[10], battlelocy[10], inbatmon[20], monsterhp[10],
    monstermp[10], monstermaxmp[10], battlemonster[10], battlemonlocx[10],
    battlemonlocy[10], playerturn, enemyturn, targetx, targety, begin, differx,
    differy, speaking, monselect, deadmon[9], damagex, damagey,
    battleeffect[15], deadchar[10], frombattle, numspells[99], allmondead,
    allmonhp, dualattack[9], defend[10], cancast[10], cast, fireweakness[9],
    iceweakness[9], enemypic[99], humanboss, monstermaxhp[10], healallx[10],
    healally[10], monsterspirit, partyspirit, round, cardplayer[10], cardround,
    gainexp, totalexp, tonext[99], nextlevel[99], itemtype[500], improve[50],
    charpoisoned[50], charpara[50], charcurse[50], charsleep[50],
    charsilence[50], charskillness[50], charstroke[50], chargrazy[50],
    charzombie[50], charberserk[50], charblind[50], start, regroup,
    optionpnt[10], boxes, battlemusic, strongpoison[10], removed,
    monstertype[10], miss, weakmonster[10], load, maxpartyspirit, loitsu[10],
    monstermaxspirit, vara[100], cancausegrazy[10];
#include "djoe.vc"
#include "prompt.vc"
#include "scancode.vc"
#include "scroll.vc"
void shopitemtypes() {
    switch (itemtype[shopitem[x]]) {
    case 1:
        itetype[shopitem[x]] = "Heal(Hp)";
    case 2:
        itetype[shopitem[x]] = "Heal(Mp)";
    case 3:
        itetype[shopitem[x]] = "Heal(Hp+Mp)";
    case 4:
        itetype[shopitem[x]] = "Cure(Poison)";
    case 5:
        itetype[shopitem[x]] = "Cure(Sleep)";
    case 6:
        itetype[shopitem[x]] = "Cure(Silence)";
    case 7:
        itetype[shopitem[x]] = "Cure(Insanity)";
    case 8:
        itetype[shopitem[x]] = "Cure(Skillness)";
    case 9:
        itetype[shopitem[x]] = "Cure(Stroke)";
    case 10:
        itetype[shopitem[x]] = "Cure(Curse)";
    case 11:
        itetype[shopitem[x]] = "Heal(All)";
    case 12:
        itetype[shopitem[x]] = "Attack enemy";
    case 13:
        itetype[shopitem[x]] = "Raise(Str)";
    case 14:
        itetype[shopitem[x]] = "Raise(Maxhp)";
    case 15:
        itetype[shopitem[x]] = "Raise(Maxmp)";
    case 16:
        itetype[shopitem[x]] = "Raise(Agi)";
    case 17:
        itetype[shopitem[x]] = "Raise(Sta)";
    case 18:
        itetype[shopitem[x]] = "Raise(A)";
    case 19:
        itetype[shopitem[x]] = "Raise(Int)";
    case 20:
        itetype[shopitem[x]] = "Raise(Ws)";
    case 21:
        itetype[shopitem[x]] = "Raise(Ac)";
    case 22:
        itetype[shopitem[x]] = "Cure(berserk)";
    case 23:
        itetype[shopitem[x]] = "Cure(zombie)";
    case 24:
        itetype[shopitem[x]] = "Cure(paralyze)";
    case 26:
        itetype[shopitem[x]] = "Carcass";
    case 25:
        itetype[shopitem[x]] = "Cure(blind)";
    }
}

void info() {
    while (mmenu = 7) {
        render();
        infomenuparts();
        showtime();
        gotoxy(20, 100);
        printstring(font4, "P");
        gotoxy(50, 100);
        printstring(font, "Character is poisoned and will every round");
        gotoxy(50, 110);
        printstring(font, "be inflicted with random 10 damage.");
        gotoxy(20, 120);
        printstring(font4, "R");
        gotoxy(50, 120);
        printstring(font, "Character is paralyzed and can't");
        gotoxy(50, 130);
        printstring(font, "do basically anything.");
        gotoxy(20, 140);
        printstring(font4, "S");
        gotoxy(50, 140);
        printstring(font, "Character is sleeping and can't");
        gotoxy(50, 150);
        printstring(font, "do attacks. Can wake if attacked.");
        gotoxy(20, 160);
        printstring(font4, "L");
        gotoxy(50, 160);
        printstring(font, "Character is silenced and can't");
        gotoxy(50, 170);
        printstring(font, "cast spells.");
        gotoxy(20, 180);
        printstring(font4, "K");
        gotoxy(50, 180);
        printstring(font, "Character has became skilless");
        gotoxy(50, 190);
        printstring(font, "and can't use skills.");
        gotoxy(20, 200);
        printstring(font4, "U");
        gotoxy(50, 200);
        printstring(font, "Character is unconcious and can't take");
        gotoxy(50, 210);
        printstring(font, "part in combat.");
        gotoxy(20, 220);
        printstring(font4, "G");
        gotoxy(50, 220);
        printstring(font, "Character is insane and chooses attacktarget");
        gotoxy(50, 230);
        printstring(font, "randomly. Also spells are inflicted.");
        gotoxy(20, 240);
        printstring(font4, "Z");
        gotoxy(50, 240);
        printstring(font, "Character is a zombie and isn't inflicted");
        gotoxy(50, 250);
        printstring(font, "by spirit, but is more vulnerable to attacks.");
        gotoxy(20, 260);
        printstring(font4, "C");
        gotoxy(50, 260);
        printstring(font, "Character is cursed and all");
        gotoxy(50, 270);
        printstring(font, "damage is halved.");
        gotoxy(20, 280);
        printstring(font4, "B");
        gotoxy(50, 280);
        printstring(font, "Character is berserked and does only");
        gotoxy(50, 290);
        printstring(font, "attacks in battle.");
        gotoxy(20, 300);
        printstring(font4, "A");
        gotoxy(50, 300);
        printstring(font, "Character is blinded and weaponskill");
        gotoxy(50, 310);
        printstring(font, "is halved.");
        gotoxy(20, 320);
        printstring(font, "Alt");
        gotoxy(50, 320);
        printstring(font, "Exit mainmenu");
        gotoxy(20, 330);
        printstring(font, "Ctrl");
        gotoxy(50, 330);
        printstring(font, "Exit submenu");
        gotoxy(20, 340);
        printstring(font, "L-shift");
        gotoxy(100, 340);
        printstring(font, "Run");
        gotoxy(20, 350);
        printstring(font, "Ctrl");
        gotoxy(50, 350);
        printstring(font, "Walk");
        showpage();
        updatecontrols();
        if (key[29]) {
            unpress(key[29]);
            mmenu = 1;
        }
        if (key[28]) {
            unpress(key[28]);
            mmenu = 1;
        }
    }
}
void showarmorcustomers() {
    if (inparty[1] > 0) {
        Tscalesprite(490, 20, 96, 96, 48, 48, charpic[inparty[1]]);
        gotoXY(490, 70);
        printstring(font, charname[inparty[1]]);
    }
    if (inparty[2] > 0) {
        Tscalesprite(550, 20, 96, 96, 48, 48, charpic[inparty[2]]);
        gotoXY(550, 70);
        printstring(font, charname[inparty[2]]);
    }
    if (inparty[3] > 0) {
        Tscalesprite(490, 80, 96, 96, 48, 48, charpic[inparty[3]]);
        gotoXY(490, 130);
        printstring(font, charname[inparty[3]]);
    }
    if (inparty[4] > 0) {
        Tscalesprite(550, 80, 96, 96, 48, 48, charpic[inparty[4]]);
        gotoXY(550, 130);
        printstring(font, charname[inparty[4]]);
    }
    if (inparty[5] > 0) {
        Tscalesprite(490, 140, 96, 96, 48, 48, charpic[inparty[5]]);
        gotoXY(490, 190);
        printstring(font, charname[inparty[5]]);
    }
    if (inparty[6] > 0) {
        Tscalesprite(550, 140, 96, 96, 48, 48, charpic[inparty[6]]);
        gotoXY(550, 190);
        printstring(font, charname[inparty[6]]);
    }
    if (inparty[7] > 0) {
        Tscalesprite(490, 200, 96, 96, 48, 48, charpic[inparty[7]]);
        gotoXY(490, 250);
        printstring(font, charname[inparty[7]]);
    }
    if (inparty[8] > 0) {
        Tscalesprite(550, 200, 96, 96, 48, 48, charpic[inparty[8]]);
        gotoXY(550, 250);
        printstring(font, charname[inparty[8]]);
    }
    gotoxy(10, 80);
    printstring(font, "Armor name:");
    gotoxy(120, 80);
    printstring(font, "Armor type:");
    gotoxy(220, 80);
    printstring(font, "Armor description:");
    if (menupnt[14] = 2) {
        gotoxy(350, 80);
        printstring(font, "Price:");
    }
    if (menupnt[14] = 5) {
        gotoxy(350, 80);
        printstring(font, "Price:");
    }
    if (menupnt[14] = 4) {
        gotoxy(350, 80);
        printstring(font, "Amount:");
        gotoxy(400, 80);
        printstring(font, "Price:");
    }
}
void showweaponcustomers() {
    if (inparty[1] > 0) {
        Tscalesprite(490, 20, 96, 96, 48, 48, charpic[inparty[1]]);
        gotoXY(490, 70);
        printstring(font, charname[inparty[1]]);
    }
    if (inparty[2] > 0) {
        Tscalesprite(550, 20, 96, 96, 48, 48, charpic[inparty[2]]);
        gotoXY(550, 70);
        printstring(font, charname[inparty[2]]);
    }
    if (inparty[3] > 0) {
        Tscalesprite(490, 80, 96, 96, 48, 48, charpic[inparty[3]]);
        gotoXY(490, 130);
        printstring(font, charname[inparty[3]]);
    }
    if (inparty[4] > 0) {
        Tscalesprite(550, 80, 96, 96, 48, 48, charpic[inparty[4]]);
        gotoXY(550, 130);
        printstring(font, charname[inparty[4]]);
    }
    if (inparty[5] > 0) {
        Tscalesprite(490, 140, 96, 96, 48, 48, charpic[inparty[5]]);
        gotoXY(490, 190);
        printstring(font, charname[inparty[5]]);
    }
    if (inparty[6] > 0) {
        Tscalesprite(550, 140, 96, 96, 48, 48, charpic[inparty[6]]);
        gotoXY(550, 190);
        printstring(font, charname[inparty[6]]);
    }
    if (inparty[7] > 0) {
        Tscalesprite(490, 200, 96, 96, 48, 48, charpic[inparty[7]]);
        gotoXY(490, 250);
        printstring(font, charname[inparty[7]]);
    }
    if (inparty[8] > 0) {
        Tscalesprite(550, 200, 96, 96, 48, 48, charpic[inparty[8]]);
        gotoXY(550, 250);
        printstring(font, charname[inparty[8]]);
    }
    gotoxy(10, 80);
    printstring(font, "Weapon name:");
    gotoxy(120, 80);
    printstring(font, "Weapon type:");
    gotoxy(220, 80);
    printstring(font, "Weapon description:");
    if (menupnt[14] = 1) {
        gotoxy(350, 80);
        printstring(font, "Price:");
    }
    if (menupnt[14] = 5) {
        gotoxy(350, 80);
        printstring(font, "Price:");
    }
    if (menupnt[14] = 3) {
        gotoxy(350, 80);
        printstring(font, "Amount:");
        gotoxy(400, 80);
        printstring(font, "Price:");
    }
}
void showcustomers() {
    if (inparty[1] > 0) {
        Tscalesprite(490, 20, 96, 96, 48, 48, charpic[inparty[1]]);
        gotoXY(490, 70);
        printstring(font, charname[inparty[1]]);
    }
    if (inparty[2] > 0) {
        Tscalesprite(550, 20, 96, 96, 48, 48, charpic[inparty[2]]);
        gotoXY(550, 70);
        printstring(font, charname[inparty[2]]);
    }
    if (inparty[3] > 0) {
        Tscalesprite(490, 80, 96, 96, 48, 48, charpic[inparty[3]]);
        gotoXY(490, 130);
        printstring(font, charname[inparty[3]]);
    }
    if (inparty[4] > 0) {
        Tscalesprite(550, 80, 96, 96, 48, 48, charpic[inparty[4]]);
        gotoXY(550, 130);
        printstring(font, charname[inparty[4]]);
    }
    if (inparty[5] > 0) {
        Tscalesprite(490, 140, 96, 96, 48, 48, charpic[inparty[5]]);
        gotoXY(490, 190);
        printstring(font, charname[inparty[5]]);
    }
    if (inparty[6] > 0) {
        Tscalesprite(550, 140, 96, 96, 48, 48, charpic[inparty[6]]);
        gotoXY(550, 190);
        printstring(font, charname[inparty[6]]);
    }
    if (inparty[7] > 0) {
        Tscalesprite(490, 200, 96, 96, 48, 48, charpic[inparty[7]]);
        gotoXY(490, 250);
        printstring(font, charname[inparty[7]]);
    }
    if (inparty[8] > 0) {
        Tscalesprite(550, 200, 96, 96, 48, 48, charpic[inparty[8]]);
        gotoXY(550, 250);
        printstring(font, charname[inparty[8]]);
    }
    gotoxy(10, 80);
    printstring(font, "Item name:");
    gotoxy(120, 80);
    printstring(font, "Item type:");
    gotoxy(220, 80);
    printstring(font, "Item description:");
    if (menupnt[14] = 1) {
        gotoxy(350, 80);
        printstring(font, "Price:");
    }
    if (menupnt[14] = 3) {
        gotoxy(350, 80);
        printstring(font, "Price:");
    }
    if (menupnt[14] = 2) {
        gotoxy(350, 80);
        printstring(font, "Amount:");
        gotoxy(400, 80);
        printstring(font, "Price:");
    }
}

void showshoparmors() {
    shoparmors();
    armornames();
    a = 100;
    temp[9023] = temp[46] + 1;
    For(x = 1; x < temp[9023]; x++) {
        gotoxy(10, a);
        printstring(font, armorname[shoparmor[x]]);
        gotoxy(120, a);
        shoparmortypes();
        printstring(font, armtype[shoparmor[x]]);
        gotoxy(220, a);
        printstring(font, armordesc[shoparmor[x]]);
        gotoxy(370, a);
        shoparmorprice[x] = str(armorprice[shoparmor[x]]);
        printstring(font, shoparmorprice[x]);
        a = a + 10;
    }
}
void showshopweapons() {
    shopweapons();
    weaponnames();
    a = 100;
    temp[9023] = temp[45] + 1;
    For(x = 1; x < temp[9023]; x++) {
        gotoxy(10, a);
        printstring(font, weaponname[shopweapon[x]]);
        gotoxy(120, a);
        shopweapontypes();
        printstring(font, wetype[shopweapon[x]]);
        gotoxy(220, a);
        printstring(font, weapondesc[shopweapon[x]]);
        gotoxy(370, a);
        shopweaponprice[x] = str(weaponprice[shopweapon[x]]);
        printstring(font, shopweaponprice[x]);
        a = a + 10;
    }
}

void showshopitems() {
    shopitems();
    itemnames();
    a = 100;
    temp[9023] = temp[45] + 1;
    For(x = 1; x < temp[9023]; x++) {
        gotoxy(10, a);
        printstring(font, itemname[shopitem[x]]);
        gotoxy(120, a);
        shopitemtypes();
        printstring(font, itetype[shopitem[x]]);
        gotoxy(220, a);
        printstring(font, itemdesc[shopitem[x]]);
        gotoxy(360, a);
        shopitemprice[x] = str(itemprice[shopitem[x]]);
        printstring(font, shopitemprice[x]);
        a = a + 10;
    }
}

void itemshop(int items, int it) {
    int i, j;
    menupnt[14] = 1;
    menupnt[15] = 1;
    menupnt[16] = 0;
    mpic1 = loadimage("menu.pcx");
    mpic2 = loadimage("ibox1.pcx");
    mpic3 = loadimage("ibox1.pcx");
    mpic4 = loadimage("ibox1.pcx");
    mpic5 = loadimage("ibox1.pcx");
    mpic6 = loadimage("ibox1.pcx");
    nullSound = cacheSound("null.wav");
    openMenuSound = cacheSound("menuopen.wav");
    clicksound = cachesound("click.wav");
    menuItemSound = cacheSound("menumove.wav");
    pointer1 = loadimage("point.pcx");
    pointer2 = loadimage("point2.pcx");
    crownamount = str(crowns);
    if (crowns > 9999) {
        crowns = 9999;
    }
    setresolution(640, 480);
    shop = 1;
    temp[501] = crowns;
    temp[500] = 0;
    totalprice = str(temp[500]);
    piece = 0;
    pieces = str(piece);
    itemnames();
    weaponnames();
    armornames();
    itemgroup = items;
    temp[45] = it;
    while (shop = 1) {
        render();
        palettemorph(0, 0, 0, 0, 63);
        Tcopysprite(0, 0, 640, 480, mpic1);
        Tcopysprite(0, 0, 179, 29, mpic3);
        gotoXY(10, 10);
        printstring(1, "Item store");
        gotoXY(500, 340);
        printstring(1, "Items");
        gotoXY(500, 360);
        printstring(1, "Sell");
        gotoXY(500, 380);
        printstring(1, "Nothing");
        showcustomers();
        TscaleSprite(480, 325 + (20 * menupnt[14]), 7, 9, 7, 9, pointer1);
        TscaleSprite(0, 90 + (10 * menupnt[15]), 7, 9, 7, 9, pointer1);
        showshopitems();
        showcustomers();
        showtime();
        showpage();
        updatecontrols();
        If(key[80]) {
            menupnt[14]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            menupnt[14]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[14] < 1) { menupnt[14] = 3; }
        if (menupnt[14] > 3) {
            menupnt[14] = 1;
        }
        if (key[28]) {
            unpress(key[28]);
            shop = 11;
            if (menupnt[14] = 2) {
                while (shop = 11) {
                    render();
                    palettemorph(0, 0, 0, 0, 63);
                    Tcopysprite(0, 0, 640, 480, mpic1);
                    Tcopysprite(0, 0, 179, 29, mpic3);
                    gotoXY(10, 10);
                    printstring(1, "Item store");
                    gotoXY(500, 340);
                    printstring(1, "Items");
                    gotoXY(500, 360);
                    printstring(1, "Sell");
                    gotoXY(500, 380);
                    printstring(1, "Nothing");
                    showcustomers();
                    TscaleSprite(
                        480, 325 + (20 * menupnt[14]), 7, 9, 7, 9, pointer1);
                    TscaleSprite(
                        0, 90 + (10 * menupnt[15]), 7, 9, 7, 9, pointer1);
                    shitems();
                    showcustomers();
                    showtime();
                    showpage();
                    updatecontrols();
                    If(key[80]) {
                        menupnt[15]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[15]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[15] < 1) { menupnt[15] = inmenu[1]; }
                    if (menupnt[15] > inmenu[1]) {
                        menupnt[15] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        shop = 1;
                    }
                    if (key[28] && itemamount[inmenuitem[menupnt[15]]] > 0) {
                        unpress(key[28]);
                        shop = 12;
                        while (shop = 12) {
                            render();
                            palettemorph(0, 0, 0, 0, 63);
                            Tcopysprite(0, 0, 640, 480, mpic1);
                            Tcopysprite(0, 0, 179, 29, mpic3);
                            gotoXY(10, 10);
                            printstring(1, "Item store");
                            showcustomers();
                            TscaleSprite(0, 90 + (10 * menupnt[15]), 7, 9, 7, 9,
                                pointer1);
                            shitems();
                            showcustomers();
                            showtime();
                            gotoXY(470, 325);
                            Tcopysprite(465, 320, 179, 29, mpic3);
                            Tcopysprite(465, 350, 179, 29, mpic3);
                            gotoXY(470, 325);
                            piece = 0 + menupnt[16];
                            if (piece > itemamount[inmenuitem[menupnt[15]]]) {
                                piece = itemamount[inmenuitem[menupnt[15]]];
                            }
                            pieces = str(piece);
                            temp[504] = itemprice[inmenuitem[menupnt[15]]] / 2;
                            tempstring[5] = str(temp[504]);
                            printstring(font, "I wish to sell ");
                            printstring(font, pieces);
                            printstring(font, " pieces.");
                            gotoXY(470, 355);
                            printstring(font, pieces);
                            printstring(font, " * a' ");
                            printstring(font, tempstring[5]);
                            printstring(font, " = ");
                            temp[500] = piece * temp[504];
                            totalprice = str(temp[500]);
                            printstring(font, totalprice);
                            printstring(font, " Crowns");
                            menupnt[17] = 1;
                            showpage();
                            updatecontrols();
                            If(key[77]) {
                                menupnt[16]++;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[75]) {
                                menupnt[16]--;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[80]) {
                                menupnt[16] = menupnt[16] - 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[72]) {
                                menupnt[16] = menupnt[16] + 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            if (menupnt[16] < 1) {
                                menupnt[16] =
                                    itemamount[inmenuitem[menupnt[15]]];
                            }
                            if (menupnt[16] >
                                itemamount[inmenuitem[menupnt[15]]]) {
                                menupnt[16] = 1;
                            }

                            if (key[29]) {
                                unpress(key[29]);
                                shop = 11;
                            }
                            if (key[28]) {
                                unpress(key[28]);
                                shop = 13;
                                while (shop = 13) {
                                    render();
                                    palettemorph(0, 0, 0, 0, 63);
                                    Tcopysprite(0, 0, 640, 480, mpic1);
                                    Tcopysprite(0, 0, 179, 29, mpic3);
                                    gotoXY(10, 10);
                                    printstring(1, "Item store");
                                    showcustomers();
                                    TscaleSprite(0, 90 + (10 * menupnt[15]), 7,
                                        9, 7, 9, pointer1);
                                    shitems();
                                    showcustomers();
                                    showtime();
                                    gotoXY(470, 325);
                                    Tcopysprite(465, 320, 179, 29, mpic3);
                                    Tcopysprite(465, 350, 179, 29, mpic3);
                                    Tcopysprite(465, 380, 179, 29, mpic3);
                                    Tcopysprite(465, 410, 179, 29, mpic3);
                                    gotoXY(470, 325);
                                    piece = 0 + menupnt[16];
                                    if (piece >
                                        itemamount[inmenuitem[menupnt[15]]]) {
                                        piece =
                                            itemamount[inmenuitem[menupnt[15]]];
                                    }
                                    pieces = str(piece);
                                    temp[504] =
                                        itemprice[inmenuitem[menupnt[15]]] / 2;
                                    tempstring[5] = str(temp[504]);
                                    printstring(font, "I wish to sell ");
                                    printstring(font, pieces);
                                    printstring(font, " pieces.");
                                    gotoXY(470, 355);
                                    printstring(font, pieces);
                                    printstring(font, " * a' ");
                                    printstring(font, tempstring[5]);
                                    printstring(font, " = ");
                                    temp[500] = piece * temp[504];
                                    totalprice = str(temp[500]);
                                    printstring(font, totalprice);
                                    printstring(font, " Crowns");
                                    switch (menupnt[17]) {
                                    case 1:
                                        TscaleSprite(
                                            485, 415, 7, 9, 7, 9, pointer1);
                                    case 2:
                                        TscaleSprite(
                                            555, 415, 7, 9, 7, 9, pointer1);
                                    }
                                    gotoxy(490, 385);
                                    done = 0;
                                    printstring(font, "Do you accept?");
                                    gotoxy(490, 415);
                                    printstring(font, " Yes ");
                                    gotoxy(560, 415);
                                    printstring(font, " No ");
                                    showtime();
                                    showpage();
                                    updatecontrols();
                                    If(key[77]) {
                                        menupnt[17]++;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    If(key[75]) {
                                        menupnt[17]--;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    if (menupnt[17] < 1) {
                                        menupnt[17] = 2;
                                    }
                                    if (menupnt[17] > 2) {
                                        menupnt[17] = 1;
                                    }
                                    if (key[29]) {
                                        unpress(key[29]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 2) {
                                        unpress(key[28]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 1) {
                                        unpress(key[28]);
                                        shop = 14;
                                        temp[509] =
                                            itemamount[inmenuitem[menupnt[15]]];
                                        if (piece < temp[509]) {
                                            temp[503] = temp[500];
                                            itemamount
                                                [inmenuitem[menupnt[15]]] =
                                                    itemamount[inmenuitem
                                                            [menupnt[15]]] -
                                                    piece;
                                            if (itemamount
                                                    [inmenuitem[menupnt[15]]] <
                                                0) {
                                                inmenu[1] = inmenu[1] - 1;
                                            }
                                            if (itemamount
                                                    [inmenuitem[menupnt[15]]] =
                                                        0) {
                                                inmenu[1] = inmenu[1] - 1;
                                            }
                                            crowns = crowns + temp[503];
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tcopysprite(
                                                    0, 0, 179, 29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(1, "Item store");
                                                showcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                shitems();
                                                showcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(
                                                    font, " Thank you! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (piece = temp[509]) {
                                            temp[503] = temp[500];
                                            itemamount
                                                [inmenuitem[menupnt[15]]] =
                                                    itemamount[inmenuitem
                                                            [menupnt[15]]] -
                                                    piece;
                                            if (itemamount
                                                    [inmenuitem[menupnt[15]]] <
                                                0) {
                                                inmenu[1] = inmenu[1] - 1;
                                            }
                                            if (itemamount
                                                    [inmenuitem[menupnt[15]]] =
                                                        0) {
                                                inmenu[1] = inmenu[1] - 1;
                                            }
                                            crowns = crowns + temp[503];
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tcopysprite(
                                                    0, 0, 179, 29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(1, "Item store");
                                                showcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                shitems();
                                                showcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(
                                                    font, " Thank you! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (piece > temp[509]) {
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tcopysprite(
                                                    0, 0, 179, 29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(1, "Item store");
                                                showcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                shitems();
                                                showcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(font,
                                                    " Not enough items! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }

            if (menupnt[14] = 3) {
                unpress(key[28]);
                shop = 0;
                setresolution(360, 240);
                palettemorph(0, 0, 0, 0, 63);
            }
            if (menupnt[14] = 1) {
                while (shop = 11) {
                    render();
                    palettemorph(0, 0, 0, 0, 63);
                    Tcopysprite(0, 0, 640, 480, mpic1);
                    Tcopysprite(0, 0, 179, 29, mpic3);
                    gotoXY(10, 10);
                    printstring(1, "Item store");
                    gotoXY(500, 340);
                    printstring(1, "Items");
                    gotoXY(500, 360);
                    printstring(1, "Sell");
                    gotoXY(500, 380);
                    printstring(1, "Nothing");
                    showcustomers();
                    TscaleSprite(
                        480, 325 + (20 * menupnt[14]), 7, 9, 7, 9, pointer1);
                    TscaleSprite(
                        0, 90 + (10 * menupnt[15]), 7, 9, 7, 9, pointer1);
                    showshopitems();
                    showcustomers();
                    Tcopysprite(465, 440, 179, 29, mpic3);
                    gotoxy(490, 445);
                    printstring(font, "Select item");
                    showtime();
                    showpage();
                    updatecontrols();
                    If(key[80]) {
                        menupnt[15]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[15]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[15] < 1) { menupnt[15] = it; }
                    if (menupnt[15] > it) {
                        menupnt[15] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        shop = 1;
                    }
                    if (key[28]) {
                        unpress(key[28]);
                        shop = 12;
                        while (shop = 12) {
                            render();
                            palettemorph(0, 0, 0, 0, 63);
                            Tcopysprite(0, 0, 640, 480, mpic1);
                            Tcopysprite(0, 0, 179, 29, mpic3);
                            gotoXY(10, 10);
                            printstring(1, "Item store");
                            showcustomers();
                            TscaleSprite(0, 90 + (10 * menupnt[15]), 7, 9, 7, 9,
                                pointer1);
                            showshopitems();
                            showcustomers();
                            showtime();
                            gotoXY(470, 325);
                            Tcopysprite(465, 320, 179, 29, mpic3);
                            Tcopysprite(465, 350, 179, 29, mpic3);
                            gotoXY(470, 325);
                            piece = 0 + menupnt[16];
                            pieces = str(piece);
                            shopitemprice[shopitem[menupnt[15]]] =
                                str(itemprice[shopitem[menupnt[15]]]);
                            printstring(font, "I wish to buy ");
                            printstring(font, pieces);
                            printstring(font, " pieces.");
                            gotoXY(470, 355);
                            printstring(font, pieces);
                            printstring(font, " * a' ");
                            printstring(
                                font, shopitemprice[shopitem[menupnt[15]]]);
                            printstring(font, " = ");
                            temp[500] =
                                piece * itemprice[shopitem[menupnt[15]]];
                            totalprice = str(temp[500]);
                            printstring(font, totalprice);
                            printstring(font, " Crowns");
                            menupnt[17] = 1;
                            showpage();
                            updatecontrols();
                            If(key[77]) {
                                menupnt[16]++;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[75]) {
                                menupnt[16]--;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[80]) {
                                menupnt[16] = menupnt[16] - 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[72]) {
                                menupnt[16] = menupnt[16] + 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            if (menupnt[16] < 0) {
                                menupnt[16] = 0;
                            }
                            if (key[29]) {
                                unpress(key[29]);
                                piece = 0;
                                temp[500] = 0;
                                temp[503] = 0;
                                temp[504] = 0;
                                shop = 11;
                            }
                            if (key[28]) {
                                unpress(key[28]);
                                shop = 13;
                                while (shop = 13) {
                                    render();
                                    palettemorph(0, 0, 0, 0, 63);
                                    Tcopysprite(0, 0, 640, 480, mpic1);
                                    Tcopysprite(0, 0, 179, 29, mpic3);
                                    gotoXY(10, 10);
                                    printstring(1, "Item store");
                                    showcustomers();
                                    TscaleSprite(0, 90 + (10 * menupnt[15]), 7,
                                        9, 7, 9, pointer1);
                                    showshopitems();
                                    showcustomers();
                                    showtime();
                                    gotoXY(470, 325);
                                    Tcopysprite(465, 320, 179, 29, mpic3);
                                    Tcopysprite(465, 350, 179, 29, mpic3);
                                    Tcopysprite(465, 380, 179, 29, mpic3);
                                    Tcopysprite(465, 410, 179, 29, mpic3);
                                    gotoXY(470, 325);
                                    piece = 0 + menupnt[16];
                                    pieces = str(piece);
                                    shopitemprice[shopitem[menupnt[15]]] =
                                        str(itemprice[shopitem[menupnt[15]]]);
                                    printstring(font, "I wish to buy ");
                                    printstring(font, pieces);
                                    printstring(font, " pieces.");
                                    gotoXY(470, 355);
                                    printstring(font, pieces);
                                    printstring(font, " * a' ");
                                    printstring(font,
                                        shopitemprice[shopitem[menupnt[15]]]);
                                    printstring(font, " = ");
                                    temp[500] =
                                        piece *
                                        itemprice[shopitem[menupnt[15]]];
                                    totalprice = str(temp[500]);
                                    printstring(font, totalprice);
                                    printstring(font, " Crowns");
                                    switch (menupnt[17]) {
                                    case 1:
                                        TscaleSprite(
                                            485, 415, 7, 9, 7, 9, pointer1);
                                    case 2:
                                        TscaleSprite(
                                            555, 415, 7, 9, 7, 9, pointer1);
                                    }
                                    gotoxy(490, 385);
                                    done = 0;
                                    printstring(font, "Do you accept?");
                                    gotoxy(490, 415);
                                    printstring(font, " Yes ");
                                    gotoxy(560, 415);
                                    printstring(font, " No ");
                                    showtime();
                                    showpage();
                                    updatecontrols();
                                    If(key[77]) {
                                        menupnt[17]++;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    If(key[75]) {
                                        menupnt[17]--;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    if (menupnt[17] < 1) {
                                        menupnt[17] = 2;
                                    }
                                    if (menupnt[17] > 2) {
                                        menupnt[17] = 1;
                                    }
                                    if (key[29]) {
                                        unpress(key[29]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 2) {
                                        unpress(key[28]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 1) {
                                        unpress(key[28]);
                                        temp[508] = crowns;
                                        if (temp[508] > temp[500]) {
                                            shop = 14;
                                            crowns = crowns - temp[500];
                                            itemamount[shopitem[menupnt[15]]] =
                                                itemamount
                                                    [shopitem[menupnt[15]]] +
                                                piece;
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tcopysprite(
                                                    0, 0, 179, 29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(1, "Item store");
                                                showcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showshopitems();
                                                showcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shopitemprice
                                                    [shopitem[menupnt[15]]] =
                                                        str(itemprice[shopitem
                                                                [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shopitemprice[shopitem
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    itemprice
                                                        [shopitem[menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(font, "Thank you!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (temp[508] = temp[500]) {
                                            shop = 14;
                                            crowns = crowns - temp[500];
                                            itemamount[shopitem[menupnt[15]]] =
                                                itemamount
                                                    [shopitem[menupnt[15]]] +
                                                piece;
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tcopysprite(
                                                    0, 0, 179, 29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(1, "Item store");
                                                showcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showshopitems();
                                                showcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                gotoXY(470, 325);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shopitemprice
                                                    [shopitem[menupnt[15]]] =
                                                        str(itemprice[shopitem
                                                                [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shopitemprice[shopitem
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    itemprice
                                                        [shopitem[menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(font, "Thank you!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (temp[508] < temp[500]) {
                                            shop = 14;
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tcopysprite(
                                                    0, 0, 179, 29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(1, "Item store");
                                                showcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showshopitems();
                                                showcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                gotoXY(470, 325);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shopitemprice
                                                    [shopitem[menupnt[15]]] =
                                                        str(itemprice[shopitem
                                                                [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shopitemprice[shopitem
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    itemprice
                                                        [shopitem[menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(
                                                    font, "Not enough crowns!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
void weaponshop(int weapons, int armors, int it, int that) {
    int i, j;
    menupnt[14] = 1;
    menupnt[15] = 1;
    menupnt[16] = 0;
    mpic1 = loadimage("menu.pcx");
    mpic2 = loadimage("ibox1.pcx");
    mpic3 = loadimage("ibox1.pcx");
    mpic4 = loadimage("ibox1.pcx");
    mpic5 = loadimage("ibox1.pcx");
    mpic6 = loadimage("ibox1.pcx");
    nullSound = cacheSound("null.wav");
    openMenuSound = cacheSound("menuopen.wav");
    clicksound = cachesound("click.wav");
    menuItemSound = cacheSound("menumove.wav");
    pointer1 = loadimage("point.pcx");
    pointer2 = loadimage("point2.pcx");
    crownamount = str(crowns);
    if (crowns > 9999) {
        crowns = 9999;
    }
    setresolution(640, 480);
    shop = 1;
    temp[501] = crowns;
    temp[500] = 0;
    totalprice = str(temp[500]);
    piece = 0;
    pieces = str(piece);
    weaponnames();
    armornames();
    weapongroup = weapons;
    armorgroup = armors;
    temp[45] = it;
    temp[46] = that;
    while (shop = 1) {
        render();
        palettemorph(0, 0, 0, 0, 63);
        Tcopysprite(0, 0, 640, 480, mpic1);
        Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
        gotoXY(10, 10);
        printstring(1, "Weapon & armor store");
        gotoXY(500, 340);
        printstring(1, "Weapons");
        gotoXY(500, 360);
        printstring(1, "Armors");
        gotoXY(500, 380);
        printstring(1, "Sell weapons");
        gotoXY(500, 400);
        printstring(1, "Sell armors");
        gotoXY(500, 420);
        printstring(1, "Nothing");
        TscaleSprite(480, 325 + (20 * menupnt[14]), 7, 9, 7, 9, pointer1);
        TscaleSprite(0, 90 + (10 * menupnt[15]), 7, 9, 7, 9, pointer1);
        switch (menupnt[14]) {
        case 1:
            showshopweapons();
            showweaponcustomers();
        case 2:
            showshoparmors();
            Tscalesprite(0, 450, 179, 29, 199, 29, mpic3);
            tempstring[11] = str(armacadd[shoparmor[menupnt[15]]]);
            gotoXY(5, 455);
            printstring(1, "Increases ac by: " + tempstring[11]);
            showarmorcustomers();
        case 3:
            showweaponcustomers();
        case 4:
            showarmorcustomers();
        }
        showtime();
        showpage();
        updatecontrols();
        If(key[80]) {
            menupnt[14]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            menupnt[14]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[14] < 1) { menupnt[14] = 5; }
        if (menupnt[14] > 5) {
            menupnt[14] = 1;
        }
        if (key[28]) {
            unpress(key[28]);
            shop = 11;
            if (menupnt[14] = 3) {
                while (shop = 11) {
                    render();
                    palettemorph(0, 0, 0, 0, 63);
                    Tcopysprite(0, 0, 640, 480, mpic1);
                    Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                    gotoXY(10, 10);
                    printstring(1, "Weapon & armor store");
                    gotoXY(500, 340);
                    printstring(1, "Weapons");
                    gotoXY(500, 360);
                    printstring(1, "Armors");
                    gotoXY(500, 380);
                    printstring(1, "Sell");
                    gotoXY(500, 400);
                    printstring(1, "Nothing");
                    TscaleSprite(
                        480, 325 + (20 * menupnt[14]), 7, 9, 7, 9, pointer1);
                    TscaleSprite(
                        0, 90 + (10 * menupnt[15]), 7, 9, 7, 9, pointer1);
                    shweapons();
                    showweaponcustomers();
                    showtime();
                    showpage();
                    updatecontrols();
                    If(key[80]) {
                        menupnt[15]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[15]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[15] < 1) { menupnt[15] = inmenu[3]; }
                    if (menupnt[15] > inmenu[3]) {
                        menupnt[15] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        shop = 1;
                    }
                    if (key[28] &&
                        weaponamount[inmenuweapon[menupnt[15]]] > 0) {
                        unpress(key[28]);
                        shop = 12;
                        while (shop = 12) {
                            render();
                            palettemorph(0, 0, 0, 0, 63);
                            Tcopysprite(0, 0, 640, 480, mpic1);
                            Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                            gotoXY(10, 10);
                            printstring(1, "Weapon & armor store");
                            TscaleSprite(0, 90 + (10 * menupnt[15]), 7, 9, 7, 9,
                                pointer1);
                            shweapons();
                            showweaponcustomers();
                            showtime();
                            gotoXY(470, 325);
                            Tcopysprite(465, 320, 179, 29, mpic3);
                            Tcopysprite(465, 350, 179, 29, mpic3);
                            gotoXY(470, 325);
                            piece = 0 + menupnt[16];
                            if (piece >
                                weaponamount[inmenuweapon[menupnt[15]]]) {
                                piece = weaponamount[inmenuweapon[menupnt[15]]];
                            }
                            pieces = str(piece);
                            temp[504] =
                                weaponprice[inmenuweapon[menupnt[15]]] / 2;
                            tempstring[5] = str(temp[504]);
                            printstring(font, "I wish to sell ");
                            printstring(font, pieces);
                            printstring(font, " pieces.");
                            gotoXY(470, 355);
                            printstring(font, pieces);
                            printstring(font, " * a' ");
                            printstring(font, tempstring[5]);
                            printstring(font, " = ");
                            temp[500] = piece * temp[504];
                            totalprice = str(temp[500]);
                            printstring(font, totalprice);
                            printstring(font, " Crowns");
                            menupnt[17] = 1;
                            showpage();
                            updatecontrols();
                            If(key[77]) {
                                menupnt[16]++;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[75]) {
                                menupnt[16]--;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[80]) {
                                menupnt[16] = menupnt[16] - 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[72]) {
                                menupnt[16] = menupnt[16] + 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            if (menupnt[16] < 1) {
                                menupnt[16] =
                                    weaponamount[inmenuweapon[menupnt[15]]];
                            }
                            if (menupnt[16] >
                                weaponamount[inmenuweapon[menupnt[15]]]) {
                                menupnt[16] = 1;
                            }

                            if (key[29]) {
                                unpress(key[29]);
                                shop = 11;
                            }
                            if (key[28]) {
                                unpress(key[28]);
                                shop = 13;
                                while (shop = 13) {
                                    render();
                                    palettemorph(0, 0, 0, 0, 63);
                                    Tcopysprite(0, 0, 640, 480, mpic1);
                                    Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                                    gotoXY(10, 10);
                                    printstring(1, "Weapon & armor store");
                                    TscaleSprite(0, 90 + (10 * menupnt[15]), 7,
                                        9, 7, 9, pointer1);
                                    shweapons();
                                    showweaponcustomers();
                                    showtime();
                                    gotoXY(470, 325);
                                    Tcopysprite(465, 320, 179, 29, mpic3);
                                    Tcopysprite(465, 350, 179, 29, mpic3);
                                    Tcopysprite(465, 380, 179, 29, mpic3);
                                    Tcopysprite(465, 410, 179, 29, mpic3);
                                    gotoXY(470, 325);
                                    piece = 0 + menupnt[16];
                                    if (piece >
                                        weaponamount
                                            [inmenuweapon[menupnt[15]]]) {
                                        piece = weaponamount
                                            [inmenuweapon[menupnt[15]]];
                                    }
                                    pieces = str(piece);
                                    temp[504] =
                                        weaponprice[inmenuweapon[menupnt[15]]] /
                                        2;
                                    tempstring[5] = str(temp[504]);
                                    printstring(font, "I wish to sell ");
                                    printstring(font, pieces);
                                    printstring(font, " pieces.");
                                    gotoXY(470, 355);
                                    printstring(font, pieces);
                                    printstring(font, " * a' ");
                                    printstring(font, tempstring[5]);
                                    printstring(font, " = ");
                                    temp[500] = piece * temp[504];
                                    totalprice = str(temp[500]);
                                    printstring(font, totalprice);
                                    printstring(font, " Crowns");
                                    switch (menupnt[17]) {
                                    case 1:
                                        TscaleSprite(
                                            485, 415, 7, 9, 7, 9, pointer1);
                                    case 2:
                                        TscaleSprite(
                                            555, 415, 7, 9, 7, 9, pointer1);
                                    }
                                    gotoxy(490, 385);
                                    done = 0;
                                    printstring(font, "Do you accept?");
                                    gotoxy(490, 415);
                                    printstring(font, " Yes ");
                                    gotoxy(560, 415);
                                    printstring(font, " No ");
                                    showtime();
                                    showpage();
                                    updatecontrols();
                                    If(key[77]) {
                                        menupnt[17]++;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    If(key[75]) {
                                        menupnt[17]--;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    if (menupnt[17] < 1) {
                                        menupnt[17] = 2;
                                    }
                                    if (menupnt[17] > 2) {
                                        menupnt[17] = 1;
                                    }
                                    if (key[29]) {
                                        unpress(key[29]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 2) {
                                        unpress(key[28]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 1) {
                                        unpress(key[28]);
                                        shop = 14;
                                        temp[509] = weaponamount
                                            [inmenuweapon[menupnt[15]]];
                                        if (piece < temp[509]) {
                                            temp[503] = temp[500];
                                            weaponamount
                                                [inmenuweapon[menupnt[15]]] =
                                                    weaponamount[inmenuweapon
                                                            [menupnt[15]]] -
                                                    piece;
                                            if (weaponamount[inmenuweapon
                                                        [menupnt[15]]] < 0) {
                                                inmenu[3] = inmenu[3] - 1;
                                            }
                                            if (weaponamount[inmenuweapon
                                                        [menupnt[15]]] = 0) {
                                                inmenu[3] = inmenu[3] - 1;
                                            }
                                            crowns = crowns + temp[503];
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                shweapons();
                                                showweaponcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(
                                                    font, " Thank you! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (piece = temp[509]) {
                                            temp[503] = temp[500];
                                            weaponamount
                                                [inmenuweapon[menupnt[15]]] =
                                                    weaponamount[inmenuweapon
                                                            [menupnt[15]]] -
                                                    piece;
                                            if (weaponamount[inmenuweapon
                                                        [menupnt[15]]] < 0) {
                                                inmenu[3] = inmenu[3] - 1;
                                            }
                                            if (weaponamount[inmenuweapon
                                                        [menupnt[15]]] = 0) {
                                                inmenu[3] = inmenu[3] - 1;
                                            }
                                            crowns = crowns + temp[503];
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                shweapons();
                                                showweaponcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(
                                                    font, " Thank you! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (piece > temp[509]) {
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                shweapons();
                                                showweaponcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(font,
                                                    " Not enough items! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }

            if (menupnt[14] = 4) {
                while (shop = 11) {
                    render();
                    palettemorph(0, 0, 0, 0, 63);
                    Tcopysprite(0, 0, 640, 480, mpic1);
                    Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                    gotoXY(10, 10);
                    printstring(1, "Weapon & armor store");
                    gotoXY(500, 340);
                    printstring(1, "Weapons");
                    gotoXY(500, 360);
                    printstring(1, "Armors");
                    gotoXY(500, 380);
                    printstring(1, "Sell");
                    gotoXY(500, 400);
                    printstring(1, "Nothing");
                    TscaleSprite(
                        480, 325 + (20 * menupnt[14]), 7, 9, 7, 9, pointer1);
                    TscaleSprite(
                        0, 90 + (10 * menupnt[15]), 7, 9, 7, 9, pointer1);
                    sharmors();
                    showarmorcustomers();
                    showtime();
                    showpage();
                    updatecontrols();
                    If(key[80]) {
                        menupnt[15]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[15]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[15] < 1) { menupnt[15] = inmenu[4]; }
                    if (menupnt[15] > inmenu[4]) {
                        menupnt[15] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        shop = 1;
                    }
                    if (key[28] && armoramount[inmenuarmor[menupnt[15]]] > 0) {
                        unpress(key[28]);
                        shop = 12;
                        while (shop = 12) {
                            render();
                            palettemorph(0, 0, 0, 0, 63);
                            Tcopysprite(0, 0, 640, 480, mpic1);
                            Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                            gotoXY(10, 10);
                            printstring(1, "Weapon & armor store");
                            TscaleSprite(0, 90 + (10 * menupnt[15]), 7, 9, 7, 9,
                                pointer1);
                            sharmors();
                            showarmorcustomers();
                            showtime();
                            gotoXY(470, 325);
                            Tcopysprite(465, 320, 179, 29, mpic3);
                            Tcopysprite(465, 350, 179, 29, mpic3);
                            gotoXY(470, 325);
                            piece = 0 + menupnt[16];
                            if (piece > armoramount[inmenuarmor[menupnt[15]]]) {
                                piece = armoramount[inmenuarmor[menupnt[15]]];
                            }
                            pieces = str(piece);
                            temp[504] =
                                armorprice[inmenuarmor[menupnt[15]]] / 2;
                            tempstring[5] = str(temp[504]);
                            printstring(font, "I wish to sell ");
                            printstring(font, pieces);
                            printstring(font, " pieces.");
                            gotoXY(470, 355);
                            printstring(font, pieces);
                            printstring(font, " * a' ");
                            printstring(font, tempstring[5]);
                            printstring(font, " = ");
                            temp[500] = piece * temp[504];
                            totalprice = str(temp[500]);
                            printstring(font, totalprice);
                            printstring(font, " Crowns");
                            menupnt[17] = 1;
                            showpage();
                            updatecontrols();
                            If(key[77]) {
                                menupnt[16]++;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[75]) {
                                menupnt[16]--;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[80]) {
                                menupnt[16] = menupnt[16] - 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[72]) {
                                menupnt[16] = menupnt[16] + 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            if (menupnt[16] < 1) {
                                menupnt[16] =
                                    armoramount[inmenuarmor[menupnt[15]]];
                            }
                            if (menupnt[16] >
                                armoramount[inmenuarmor[menupnt[15]]]) {
                                menupnt[16] = 1;
                            }

                            if (key[29]) {
                                unpress(key[29]);
                                shop = 11;
                            }
                            if (key[28]) {
                                unpress(key[28]);
                                shop = 13;
                                while (shop = 13) {
                                    render();
                                    palettemorph(0, 0, 0, 0, 63);
                                    Tcopysprite(0, 0, 640, 480, mpic1);
                                    Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                                    gotoXY(10, 10);
                                    printstring(1, "Weapon & armor store");
                                    TscaleSprite(0, 90 + (10 * menupnt[15]), 7,
                                        9, 7, 9, pointer1);
                                    sharmors();
                                    showarmorcustomers();
                                    showtime();
                                    gotoXY(470, 325);
                                    Tcopysprite(465, 320, 179, 29, mpic3);
                                    Tcopysprite(465, 350, 179, 29, mpic3);
                                    Tcopysprite(465, 380, 179, 29, mpic3);
                                    Tcopysprite(465, 410, 179, 29, mpic3);
                                    gotoXY(470, 325);
                                    piece = 0 + menupnt[16];
                                    if (piece >
                                        armoramount[inmenuarmor[menupnt[15]]]) {
                                        piece = armoramount
                                            [inmenuarmor[menupnt[15]]];
                                    }
                                    pieces = str(piece);
                                    temp[504] =
                                        armorprice[inmenuarmor[menupnt[15]]] /
                                        2;
                                    tempstring[5] = str(temp[504]);
                                    printstring(font, "I wish to sell ");
                                    printstring(font, pieces);
                                    printstring(font, " pieces.");
                                    gotoXY(470, 355);
                                    printstring(font, pieces);
                                    printstring(font, " * a' ");
                                    printstring(font, tempstring[5]);
                                    printstring(font, " = ");
                                    temp[500] = piece * temp[504];
                                    totalprice = str(temp[500]);
                                    printstring(font, totalprice);
                                    printstring(font, " Crowns");
                                    switch (menupnt[17]) {
                                    case 1:
                                        TscaleSprite(
                                            485, 415, 7, 9, 7, 9, pointer1);
                                    case 2:
                                        TscaleSprite(
                                            555, 415, 7, 9, 7, 9, pointer1);
                                    }
                                    gotoxy(490, 385);
                                    done = 0;
                                    printstring(font, "Do you accept?");
                                    gotoxy(490, 415);
                                    printstring(font, " Yes ");
                                    gotoxy(560, 415);
                                    printstring(font, " No ");
                                    showtime();
                                    showpage();
                                    updatecontrols();
                                    If(key[77]) {
                                        menupnt[17]++;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    If(key[75]) {
                                        menupnt[17]--;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    if (menupnt[17] < 1) {
                                        menupnt[17] = 2;
                                    }
                                    if (menupnt[17] > 2) {
                                        menupnt[17] = 1;
                                    }
                                    if (key[29]) {
                                        unpress(key[29]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 2) {
                                        unpress(key[28]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 1) {
                                        unpress(key[28]);
                                        shop = 14;
                                        temp[509] = armoramount
                                            [inmenuarmor[menupnt[15]]];
                                        if (piece < temp[509]) {
                                            temp[503] = temp[500];
                                            armoramount
                                                [inmenuarmor[menupnt[15]]] =
                                                    armoramount[inmenuarmor
                                                            [menupnt[15]]] -
                                                    piece;
                                            if (armoramount
                                                    [inmenuarmor[menupnt[15]]] <
                                                0) {
                                                inmenu[4] = inmenu[4] - 1;
                                            }
                                            if (armoramount
                                                    [inmenuarmor[menupnt[15]]] =
                                                        0) {
                                                inmenu[4] = inmenu[4] - 1;
                                            }
                                            crowns = crowns + temp[503];
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                sharmors();
                                                showarmorcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(
                                                    font, " Thank you! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (piece = temp[509]) {
                                            temp[503] = temp[500];
                                            armoramount
                                                [inmenuarmor[menupnt[15]]] =
                                                    armoramount[inmenuarmor
                                                            [menupnt[15]]] -
                                                    piece;
                                            if (armoramount
                                                    [inmenuarmor[menupnt[15]]] <
                                                0) {
                                                inmenu[4] = inmenu[4] - 1;
                                            }
                                            if (armoramount
                                                    [inmenuarmor[menupnt[15]]] =
                                                        0) {
                                                inmenu[4] = inmenu[4] - 1;
                                            }
                                            crowns = crowns + temp[503];
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                sharmors();
                                                showarmorcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(
                                                    font, " Thank you! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (piece > temp[509]) {
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                sharmors();
                                                showarmorcustomers();
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                gotoxy(490, 325);
                                                printstring(font,
                                                    " Not enough items! ");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                If(key[77]) {
                                                    menupnt[17]++;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                If(key[75]) {
                                                    menupnt[17]--;
                                                    playsound(
                                                        menuitemsound, 64, 128);
                                                    del(10, 0, 0, 0);
                                                }
                                                if (menupnt[17] < 1) {
                                                    menupnt[17] = 2;
                                                }
                                                if (menupnt[17] > 2) {
                                                    menupnt[17] = 1;
                                                }
                                                if (key[29]) {
                                                    unpress(key[29]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 12;
                                                }
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }

            if (menupnt[14] = 5) {
                unpress(key[28]);
                shop = 0;
                setresolution(360, 240);
                palettemorph(0, 0, 0, 0, 63);
            }
            if (menupnt[14] = 1) {
                while (shop = 11) {
                    render();
                    palettemorph(0, 0, 0, 0, 63);
                    Tcopysprite(0, 0, 640, 480, mpic1);
                    Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                    gotoXY(10, 10);
                    printstring(1, "Weapon & armor store");
                    gotoXY(500, 340);
                    printstring(1, "Weapons");
                    gotoXY(500, 360);
                    printstring(1, "Armors");
                    gotoXY(500, 380);
                    printstring(1, "Sell weapons");
                    gotoXY(500, 400);
                    printstring(1, "Sell armors");
                    gotoXY(500, 420);
                    printstring(1, "Nothing");
                    TscaleSprite(
                        480, 325 + (20 * menupnt[14]), 7, 9, 7, 9, pointer1);
                    TscaleSprite(
                        0, 90 + (10 * menupnt[15]), 7, 9, 7, 9, pointer1);
                    switch (menupnt[14]) {
                    case 1:
                        showshopweapons();
                        showweaponcustomers();
                    case 2:
                        showshoparmors();
                        showarmorcustomers();
                    case 3:
                        showweaponcustomers();
                    case 4:
                        showarmorcustomers();
                    }
                    Tcopysprite(465, 440, 179, 29, mpic3);
                    gotoxy(490, 445);
                    printstring(font, "Select weapon");
                    showtime();
                    showpage();
                    updatecontrols();
                    If(key[80]) {
                        menupnt[15]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[15]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[15] < 1) { menupnt[15] = it; }
                    if (menupnt[15] > it) {
                        menupnt[15] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        shop = 1;
                    }
                    if (key[28]) {
                        unpress(key[28]);
                        shop = 12;
                        while (shop = 12) {
                            render();
                            palettemorph(0, 0, 0, 0, 63);
                            Tcopysprite(0, 0, 640, 480, mpic1);
                            Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                            gotoXY(10, 10);
                            printstring(1, "Weapon & armor store");
                            showshopweapons();
                            showweaponcustomers();
                            TscaleSprite(0, 90 + (10 * menupnt[15]), 7, 9, 7, 9,
                                pointer1);
                            showtime();
                            gotoXY(470, 325);
                            Tcopysprite(465, 320, 179, 29, mpic3);
                            Tcopysprite(465, 350, 179, 29, mpic3);
                            gotoXY(470, 325);
                            piece = 0 + menupnt[16];
                            pieces = str(piece);
                            shopweaponprice[shopweapon[menupnt[15]]] =
                                str(weaponprice[shopweapon[menupnt[15]]]);
                            printstring(font, "I wish to buy ");
                            printstring(font, pieces);
                            printstring(font, " pieces.");
                            gotoXY(470, 355);
                            printstring(font, pieces);
                            printstring(font, " * a' ");
                            printstring(
                                font, shopweaponprice[shopweapon[menupnt[15]]]);
                            printstring(font, " = ");
                            temp[500] =
                                piece * weaponprice[shopweapon[menupnt[15]]];
                            totalprice = str(temp[500]);
                            printstring(font, totalprice);
                            printstring(font, " Crowns");
                            menupnt[17] = 1;
                            showpage();
                            updatecontrols();
                            If(key[77]) {
                                menupnt[16]++;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[75]) {
                                menupnt[16]--;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[80]) {
                                menupnt[16] = menupnt[16] - 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[72]) {
                                menupnt[16] = menupnt[16] + 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            if (menupnt[16] < 0) {
                                menupnt[16] = 0;
                            }
                            if (key[29]) {
                                unpress(key[29]);
                                piece = 0;
                                temp[500] = 0;
                                temp[503] = 0;
                                temp[504] = 0;
                                shop = 11;
                            }
                            if (key[28]) {
                                unpress(key[28]);
                                shop = 13;
                                while (shop = 13) {
                                    render();
                                    palettemorph(0, 0, 0, 0, 63);
                                    Tcopysprite(0, 0, 640, 480, mpic1);
                                    Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                                    gotoXY(10, 10);
                                    printstring(1, "Weapon & armor store");
                                    showshopweapons();
                                    showweaponcustomers();
                                    TscaleSprite(0, 90 + (10 * menupnt[15]), 7,
                                        9, 7, 9, pointer1);
                                    showtime();
                                    gotoXY(470, 325);
                                    Tcopysprite(465, 320, 179, 29, mpic3);
                                    Tcopysprite(465, 350, 179, 29, mpic3);
                                    Tcopysprite(465, 380, 179, 29, mpic3);
                                    Tcopysprite(465, 410, 179, 29, mpic3);
                                    gotoXY(470, 325);
                                    piece = 0 + menupnt[16];
                                    pieces = str(piece);
                                    shopweaponprice[shopweapon[menupnt[15]]] =
                                        str(weaponprice
                                                [shopweapon[menupnt[15]]]);
                                    printstring(font, "I wish to buy ");
                                    printstring(font, pieces);
                                    printstring(font, " pieces.");
                                    gotoXY(470, 355);
                                    printstring(font, pieces);
                                    printstring(font, " * a' ");
                                    printstring(font,
                                        shopweaponprice
                                            [shopweapon[menupnt[15]]]);
                                    printstring(font, " = ");
                                    temp[500] =
                                        piece *
                                        weaponprice[shopweapon[menupnt[15]]];
                                    totalprice = str(temp[500]);
                                    printstring(font, totalprice);
                                    printstring(font, " Crowns");
                                    switch (menupnt[17]) {
                                    case 1:
                                        TscaleSprite(
                                            485, 415, 7, 9, 7, 9, pointer1);
                                    case 2:
                                        TscaleSprite(
                                            555, 415, 7, 9, 7, 9, pointer1);
                                    }
                                    gotoxy(490, 385);
                                    done = 0;
                                    printstring(font, "Do you accept?");
                                    gotoxy(490, 415);
                                    printstring(font, " Yes ");
                                    gotoxy(560, 415);
                                    printstring(font, " No ");
                                    showtime();
                                    showpage();
                                    updatecontrols();
                                    If(key[77]) {
                                        menupnt[17]++;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    If(key[75]) {
                                        menupnt[17]--;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    if (menupnt[17] < 1) {
                                        menupnt[17] = 2;
                                    }
                                    if (menupnt[17] > 2) {
                                        menupnt[17] = 1;
                                    }
                                    if (key[29]) {
                                        unpress(key[29]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 2) {
                                        unpress(key[28]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 1) {
                                        unpress(key[28]);
                                        temp[508] = crowns;
                                        if (temp[508] > temp[500]) {
                                            shop = 14;
                                            crowns = crowns - temp[500];
                                            weaponamount
                                                [shopweapon[menupnt[15]]] =
                                                    weaponamount[shopweapon
                                                            [menupnt[15]]] +
                                                    piece;
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                showshopweapons();
                                                showweaponcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                gotoXY(470, 325);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shopweaponprice[shopweapon
                                                        [menupnt[15]]] =
                                                    str(weaponprice[shopweapon
                                                            [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shopweaponprice[shopweapon
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    weaponprice[shopweapon
                                                            [menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(font, "Thank you!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (temp[508] = temp[500]) {
                                            shop = 14;
                                            crowns = crowns - temp[500];
                                            weaponamount
                                                [shopweapon[menupnt[15]]] =
                                                    weaponamount[shopweapon
                                                            [menupnt[15]]] +
                                                    piece;
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                showshopweapons();
                                                showweaponcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                gotoXY(470, 325);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shopweaponprice[shopweapon
                                                        [menupnt[15]]] =
                                                    str(weaponprice[shopweapon
                                                            [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shopweaponprice[shopweapon
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    weaponprice[shopweapon
                                                            [menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(font, "Thank you!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (temp[508] < temp[500]) {
                                            shop = 14;
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                showshopweapons();
                                                showweaponcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                gotoXY(470, 325);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shopweaponprice[shopweapon
                                                        [menupnt[15]]] =
                                                    str(weaponprice[shopweapon
                                                            [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shopweaponprice[shopweapon
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    weaponprice[shopweapon
                                                            [menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(
                                                    font, "Not enough crowns!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (menupnt[14] = 2) {
                while (shop = 11) {
                    render();
                    palettemorph(0, 0, 0, 0, 63);
                    Tcopysprite(0, 0, 640, 480, mpic1);
                    Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                    gotoXY(10, 10);
                    printstring(1, "Weapon & armor store");
                    gotoXY(500, 340);
                    printstring(1, "Weapons");
                    gotoXY(500, 360);
                    printstring(1, "Armors");
                    gotoXY(500, 380);
                    printstring(1, "Sell weapons");
                    gotoXY(500, 400);
                    printstring(1, "Sell armors");
                    gotoXY(500, 420);
                    printstring(1, "Nothing");
                    TscaleSprite(
                        480, 325 + (20 * menupnt[14]), 7, 9, 7, 9, pointer1);
                    TscaleSprite(
                        0, 90 + (10 * menupnt[15]), 7, 9, 7, 9, pointer1);
                    switch (menupnt[14]) {
                    case 1:
                        showshopweapons();
                        showweaponcustomers();
                    case 2:
                        showshoparmors();
                        Tscalesprite(0, 450, 179, 29, 199, 29, mpic3);
                        tempstring[11] = str(armacadd[shoparmor[menupnt[15]]]);
                        gotoXY(5, 455);
                        printstring(1, "Increases ac by: " + tempstring[11]);
                        showarmorcustomers();
                    case 3:
                        showweaponcustomers();
                    case 4:
                        showarmorcustomers();
                    }
                    Tcopysprite(465, 440, 179, 29, mpic3);
                    gotoxy(490, 445);
                    printstring(font, "Select armor");
                    showtime();
                    showpage();
                    updatecontrols();
                    If(key[80]) {
                        menupnt[15]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[15]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[15] < 1) { menupnt[15] = that; }
                    if (menupnt[15] > that) {
                        menupnt[15] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        shop = 1;
                    }
                    if (key[28]) {
                        unpress(key[28]);
                        shop = 12;
                        while (shop = 12) {
                            render();
                            palettemorph(0, 0, 0, 0, 63);
                            Tcopysprite(0, 0, 640, 480, mpic1);
                            Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                            Tcopysprite(0, 450, 179, 29, mpic3);
                            tempstring[11] =
                                str(armacadd[shoparmor[menupnt[15]]]);
                            gotoXY(5, 455);
                            printstring(
                                1, "Increases ac by: " + tempstring[11]);
                            gotoXY(10, 10);
                            printstring(1, "Weapon & armor store");
                            showshoparmors();
                            showarmorcustomers();
                            TscaleSprite(0, 90 + (10 * menupnt[15]), 7, 9, 7, 9,
                                pointer1);
                            showtime();
                            gotoXY(470, 325);
                            Tcopysprite(465, 320, 179, 29, mpic3);
                            Tcopysprite(465, 350, 179, 29, mpic3);
                            gotoXY(470, 325);
                            piece = 0 + menupnt[16];
                            pieces = str(piece);
                            shoparmorprice[shoparmor[menupnt[15]]] =
                                str(armorprice[shoparmor[menupnt[15]]]);
                            printstring(font, "I wish to buy ");
                            printstring(font, pieces);
                            printstring(font, " pieces.");
                            gotoXY(470, 355);
                            printstring(font, pieces);
                            printstring(font, " * a' ");
                            printstring(
                                font, shoparmorprice[shoparmor[menupnt[15]]]);
                            printstring(font, " = ");
                            temp[500] =
                                piece * armorprice[shoparmor[menupnt[15]]];
                            totalprice = str(temp[500]);
                            printstring(font, totalprice);
                            printstring(font, " Crowns");
                            menupnt[17] = 1;
                            showpage();
                            updatecontrols();
                            If(key[77]) {
                                menupnt[16]++;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[75]) {
                                menupnt[16]--;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[80]) {
                                menupnt[16] = menupnt[16] - 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[72]) {
                                menupnt[16] = menupnt[16] + 10;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            if (menupnt[16] < 0) {
                                menupnt[16] = 0;
                            }
                            if (key[29]) {
                                unpress(key[29]);
                                piece = 0;
                                temp[500] = 0;
                                temp[503] = 0;
                                temp[504] = 0;
                                shop = 11;
                            }
                            if (key[28]) {
                                unpress(key[28]);
                                shop = 13;
                                while (shop = 13) {
                                    render();
                                    palettemorph(0, 0, 0, 0, 63);
                                    Tcopysprite(0, 0, 640, 480, mpic1);
                                    Tscalesprite(0, 0, 179, 29, 229, 29, mpic3);
                                    Tscalesprite(
                                        0, 450, 179, 29, 199, 29, mpic3);
                                    tempstring[11] =
                                        str(armacadd[shoparmor[menupnt[15]]]);
                                    gotoXY(5, 455);
                                    printstring(1,
                                        "Increases ac by: " + tempstring[11]);
                                    gotoXY(10, 10);
                                    printstring(1, "Weapon & armor store");
                                    showshoparmors();
                                    showarmorcustomers();
                                    TscaleSprite(0, 90 + (10 * menupnt[15]), 7,
                                        9, 7, 9, pointer1);
                                    showtime();
                                    gotoXY(470, 325);
                                    Tcopysprite(465, 320, 179, 29, mpic3);
                                    Tcopysprite(465, 350, 179, 29, mpic3);
                                    Tcopysprite(465, 380, 179, 29, mpic3);
                                    Tcopysprite(465, 410, 179, 29, mpic3);
                                    gotoXY(470, 325);
                                    piece = 0 + menupnt[16];
                                    pieces = str(piece);
                                    shoparmorprice[shoparmor[menupnt[15]]] =
                                        str(armorprice[shoparmor[menupnt[15]]]);
                                    printstring(font, "I wish to buy ");
                                    printstring(font, pieces);
                                    printstring(font, " pieces.");
                                    gotoXY(470, 355);
                                    printstring(font, pieces);
                                    printstring(font, " * a' ");
                                    printstring(font,
                                        shoparmorprice[shoparmor[menupnt[15]]]);
                                    printstring(font, " = ");
                                    temp[500] =
                                        piece *
                                        armorprice[shoparmor[menupnt[15]]];
                                    totalprice = str(temp[500]);
                                    printstring(font, totalprice);
                                    printstring(font, " Crowns");
                                    switch (menupnt[17]) {
                                    case 1:
                                        TscaleSprite(
                                            485, 415, 7, 9, 7, 9, pointer1);
                                    case 2:
                                        TscaleSprite(
                                            555, 415, 7, 9, 7, 9, pointer1);
                                    }
                                    gotoxy(490, 385);
                                    done = 0;
                                    printstring(font, "Do you accept?");
                                    gotoxy(490, 415);
                                    printstring(font, " Yes ");
                                    gotoxy(560, 415);
                                    printstring(font, " No ");
                                    showtime();
                                    showpage();
                                    updatecontrols();
                                    If(key[77]) {
                                        menupnt[17]++;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    If(key[75]) {
                                        menupnt[17]--;
                                        playsound(menuitemsound, 64, 128);
                                        del(10, 0, 0, 0);
                                    }
                                    if (menupnt[17] < 1) {
                                        menupnt[17] = 2;
                                    }
                                    if (menupnt[17] > 2) {
                                        menupnt[17] = 1;
                                    }
                                    if (key[29]) {
                                        unpress(key[29]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 2) {
                                        unpress(key[28]);
                                        piece = 0;
                                        temp[500] = 0;
                                        temp[503] = 0;
                                        temp[504] = 0;
                                        shop = 12;
                                    }
                                    if (key[28] && menupnt[17] = 1) {
                                        unpress(key[28]);
                                        temp[508] = crowns;
                                        if (temp[508] > temp[500]) {
                                            shop = 14;
                                            crowns = crowns - temp[500];
                                            armoramount
                                                [shoparmor[menupnt[15]]] =
                                                    armoramount[shoparmor
                                                            [menupnt[15]]] +
                                                    piece;
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                Tscalesprite(0, 450, 179, 29,
                                                    199, 29, mpic3);
                                                tempstring[11] =
                                                    str(armacadd[shoparmor
                                                            [menupnt[15]]]);
                                                gotoXY(5, 455);
                                                printstring(
                                                    1, "Increases ac by: " +
                                                           tempstring[11]);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                showshoparmors();
                                                showarmorcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                gotoXY(470, 325);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shoparmorprice
                                                    [shoparmor[menupnt[15]]] =
                                                        str(armorprice[shoparmor
                                                                [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shoparmorprice[shoparmor
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    armorprice[shoparmor
                                                            [menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(font, "Thank you!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (temp[508] = temp[500]) {
                                            shop = 14;
                                            crowns = crowns - temp[500];
                                            armoramount
                                                [shoparmor[menupnt[15]]] =
                                                    armoramount[shoparmor
                                                            [menupnt[15]]] +
                                                    piece;
                                            crownamount = str(crowns);
                                            soundeffect[11] =
                                                cachesound("coins.wav");
                                            playsound(soundeffect[11], 64, 128);
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                Tscalesprite(0, 450, 179, 29,
                                                    199, 29, mpic3);
                                                tempstring[11] =
                                                    str(armacadd[shoparmor
                                                            [menupnt[15]]]);
                                                gotoXY(5, 455);
                                                printstring(
                                                    1, "Increases ac by: " +
                                                           tempstring[11]);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                showshoparmors();
                                                showarmorcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                gotoXY(470, 325);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shoparmorprice
                                                    [shoparmor[menupnt[15]]] =
                                                        str(armorprice[shoparmor
                                                                [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shoparmorprice[shoparmor
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    armorprice[shoparmor
                                                            [menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(font, "Thank you!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                        if (temp[508] < temp[500]) {
                                            shop = 14;
                                            while (shop = 14) {
                                                render();
                                                palettemorph(0, 0, 0, 0, 63);
                                                Tcopysprite(
                                                    0, 0, 640, 480, mpic1);
                                                Tscalesprite(0, 0, 179, 29, 229,
                                                    29, mpic3);
                                                Tscalesprite(0, 450, 179, 29,
                                                    199, 29, mpic3);
                                                tempstring[11] =
                                                    str(armacadd[shoparmor
                                                            [menupnt[15]]]);
                                                gotoXY(5, 455);
                                                printstring(
                                                    1, "Increases ac by: " +
                                                           tempstring[11]);
                                                gotoXY(10, 10);
                                                printstring(
                                                    1, "Weapon & armor store");
                                                showshoparmors();
                                                showarmorcustomers();
                                                TscaleSprite(0,
                                                    90 + (10 * menupnt[15]), 7,
                                                    9, 7, 9, pointer1);
                                                showtime();
                                                gotoXY(470, 325);
                                                Tcopysprite(
                                                    465, 320, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 350, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 380, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 410, 179, 29, mpic3);
                                                Tcopysprite(
                                                    465, 440, 179, 29, mpic3);
                                                gotoXY(470, 325);
                                                piece = 0 + menupnt[16];
                                                pieces = str(piece);
                                                shoparmorprice
                                                    [shoparmor[menupnt[15]]] =
                                                        str(armorprice[shoparmor
                                                                [menupnt[15]]]);
                                                printstring(
                                                    font, "I wish to buy ");
                                                printstring(font, pieces);
                                                printstring(font, " pieces.");
                                                gotoXY(470, 355);
                                                printstring(font, pieces);
                                                printstring(font, " * a' ");
                                                printstring(
                                                    font,
                                                    shoparmorprice[shoparmor
                                                            [menupnt[15]]]);
                                                printstring(font, " = ");
                                                temp[500] =
                                                    piece *
                                                    armorprice[shoparmor
                                                            [menupnt[15]]];
                                                totalprice = str(temp[500]);
                                                printstring(font, totalprice);
                                                printstring(font, " Crowns");
                                                switch (menupnt[17]) {
                                                case 1:
                                                    TscaleSprite(485, 415, 7, 9,
                                                        7, 9, pointer1);
                                                case 2:
                                                    TscaleSprite(555, 415, 7, 9,
                                                        7, 9, pointer1);
                                                }
                                                gotoxy(490, 385);
                                                printstring(
                                                    font, "Do you accept?");
                                                gotoxy(490, 415);
                                                printstring(font, " Yes ");
                                                gotoxy(560, 415);
                                                printstring(font, " No ");
                                                gotoxy(490, 445);
                                                printstring(
                                                    font, "Not enough crowns!");
                                                showtime();
                                                showpage();
                                                updatecontrols();
                                                if (key[28]) {
                                                    unpress(key[28]);
                                                    piece = 0;
                                                    temp[500] = 0;
                                                    temp[503] = 0;
                                                    temp[504] = 0;
                                                    shop = 1;
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

void poisoned() {
    temp[711] = random(10);
    if (strongpoison[inparty[playerturn]] = 1) {
        temp[711] = random(20);
    }
    chahp[inparty[playerturn]] = chahp[inparty[playerturn]] - temp[711];
    battlehp[montarget] = str(chahp[inparty[montarget]]);
    partyspirit = partyspirit - temp[711];
    if (partyspirit > maxpartyspirit) {
        partyspirit = maxpartyspirit;
    }
    partspirit = str(partyspirit);
    if (chahp[inparty[montarget]] < 0) {
        deadchar[montarget] = 0;
        charstroke[inparty[montarget]] = 1;
        checkdie2();
    }
    if (chahp[inparty[montarget]] = 0) {
        deadchar[montarget] = 0;
        charstroke[inparty[montarget]] = 1;
        checkdie2();
    }
    dam = str(temp[711]);
    damagex = battlelocx[playerturn] * 16;
    damagex = damagex + 30;
    damagey = battlelocy[playerturn] * 16;
    damagey = damagey + 5;
    render();
    gotoxy(damagex, damagey);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey);
    printstring(font4, "P " + dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 1);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 1);
    printstring(font4, "P " + dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 2);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 2);
    printstring(font4, "P ");
    gotoxy(damagex, damagey + 2);
    printstring(font2, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 3);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 3);
    printstring(font4, "P " + dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, "P " + dam);
    showpage();
    if (partyspirit <= 0) {
        vara[20] = 1;
        gameover();
    }
    allchardead = 0;
    for (x = 1; x = numchars; x++) {
        if (deadchar[x] = 0) {
            allchardead = allchardead + 1;
        }
    }
    if (allchardead = numchars) {
        vara[20] = 2;
        gameover();
    }
}
void charconditions() {
    For(x = 1; x < numchars2; x++) {
        if (charpoisoned[inparty[x]] =
                0 && charpara[inparty[x]] =
                    0 && charcurse[inparty[x]] =
                        0 && charsleep[inparty[x]] =
                            0 && charsilence[inparty[x]] =
                                0 && charskillness[inparty[x]] =
                                    0 && charstroke[inparty[x]] =
                                        0 && chargrazy[inparty[x]] =
                                            0 && charzombie[inparty[x]] =
                                                0 && charberserk[inparty[x]] =
                                                    0 && charblind[inparty[x]] =
                                                        0) {
            chacond[inparty[x]] = "Fine";
            gotoxy(350, textplace[x]);
            printstring(1, chacond[inparty[x]]);
        }
        if (charpoisoned[inparty[x]] = 1) {
            chacond[inparty[x]] = "P";
            gotoxy(350, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (charpara[inparty[x]] = 1) {
            chacond[inparty[x]] = "R";
            gotoxy(360, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (charcurse[inparty[x]] = 1) {
            chacond[inparty[x]] = "C";
            gotoxy(370, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (charsleep[inparty[x]] = 1) {
            chacond[inparty[x]] = "S";
            gotoxy(380, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (charsilence[inparty[x]] = 1) {
            chacond[inparty[x]] = "L";
            gotoxy(390, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (charskillness[inparty[x]] = 1) {
            chacond[inparty[x]] = "K";
            gotoxy(400, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (chargrazy[inparty[x]] = 1) {
            chacond[inparty[x]] = "G";
            gotoxy(410, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (charzombie[inparty[x]] = 1) {
            chacond[inparty[x]] = "Z";
            gotoxy(420, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (charberserk[inparty[x]] = 1) {
            chacond[inparty[x]] = "B";
            gotoxy(430, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }

        if (charstroke[inparty[x]] = 1) {
            chacond[inparty[x]] = "U";
            gotoxy(440, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
        if (charblind[inparty[x]] = 1) {
            chacond[inparty[x]] = "A";
            gotoxy(450, textplace[x]);
            printstring(font4, chacond[inparty[x]]);
        }
    }
}
void statuscharconditions() {
    gotoxy(200, 10);
    printstring(1, "Condition:");
    if (charpoisoned[inparty[stat]] =
            0 && charpara[inparty[stat]] =
                0 && charcurse[inparty[stat]] =
                    0 && charsleep[inparty[stat]] =
                        0 && charsilence[inparty[stat]] =
                            0 && charskillness[inparty[stat]] =
                                0 && charstroke[inparty[stat]] =
                                    0 && chargrazy[inparty[x]] =
                                        0 && charzombie[inparty[stat]] =
                                            0 && charberserk[inparty[stat]] =
                                                0 && charblind[inparty[stat]] =
                                                    0) {
        chacond[inparty[stat]] = "Fine";
        gotoxy(350, 10);
        printstring(1, chacond[inparty[stat]]);
    }
    if (charpoisoned[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "P";
        gotoxy(350, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (charpara[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "R";
        gotoxy(360, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (charcurse[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "C";
        gotoxy(370, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (charsleep[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "S";
        gotoxy(380, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (charsilence[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "L";
        gotoxy(390, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (charskillness[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "K";
        gotoxy(400, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (chargrazy[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "G";
        gotoxy(410, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (charzombie[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "Z";
        gotoxy(420, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (charberserk[inparty[x]] = 1) {
        chacond[inparty[x]] = "B";
        gotoxy(430, textplace[x]);
        printstring(font4, chacond[inparty[x]]);
    }

    if (charstroke[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "U";
        gotoxy(440, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
    if (charblind[inparty[stat]] = 1) {
        chacond[inparty[stat]] = "A";
        gotoxy(450, 10);
        printstring(font4, chacond[inparty[stat]]);
    }
}

void improvements() {
    improve[1] = 2 + random(4) + chalevel[levelling];
    improve[2] = 1 + random(4) + chalevel[levelling];
    improve[3] = random(100);
    improve[4] = 5 + chalevel[levelling];
    if (improve[3] < improve[4]) {
        improve[5] = 1;
    }
    improve[6] = random(100);
    improve[7] = 10 + chalevel[levelling];
    if (improve[6] < improve[7]) {
        improve[8] = 1;
    }
    chamaxhp[levelling] = chamaxhp[levelling] + improve[1];
    if (levelling = 1) {
        chamaxmp[levelling] = chamaxmp[levelling] + improve[2];
    }
    maxpartyspirit = maxpartyspirit + 10;
    partyspirit = maxpartyspirit;
    chastr[levelling] = chastr[levelling] + improve[5];
    chasta[levelling] = chasta[levelling] + improve[8];
    chahp[levelling] = chamaxhp[levelling];
    champ[levelling] = chamaxmp[levelling];
    charhp[levelling] = str(chahp[levelling]);
    charmp[levelling] = str(champ[levelling]);
}
void attackspelltalk() {
    switch (spelltype[spellused]) {
    case 18:
        printstring(1, "Burn in the flames of hell!!");
    case 19:
        printstring(1, "Back to the dust where you came!!!");
    case 20:
        printstring(1, "Blow these scums away!!!");
    case 21:
        printstring(1, "I hope you'll drown!!Ha!");
    case 22:
        printstring(1, "Welcome to eternal damnation!!");
    case 23:
        printstring(1, "Feeling different are we?!!");
    case 26:
        printstring(1, "Freeze enemy scums!!");
    }
}
void healspelltalk() {
    switch (spelltype[spellused]) {
    case 1:
        printstring(1, "This will help you!!");
    case 2:
        printstring(1, "This will help you!!");
    case 3:
        printstring(1, "This will help you!!");
    case 4:
        printstring(1, "This will heal you!!");
    }
}
void enemyhealall() {
    battleeffect[5] = cachesound("heal1.wav");
    playsound(battleeffect[5], 64, 128);
    For(x = 1; x < nummon2; x++) {
        alterftile(battlemonlocx[x], battlemonlocy[x], 1274, 0);
        if (deadchar[x] = 1) {
            entity.specframe[battlemonster[x]] = 17;
        }
        if (deadchar[x] = 0) {
            entity.specframe[battlemonster[x]] = 18;
        }
    }
    For(x = 1; x < nummon2; x++) {
        temp[8000] = 0;
        temp[8000] = monstermaxhp[x] - monsterhp[x];
        if (temp[8000 + x] > 10) {
            dam = "10";
        }
        if (temp[8000 + x] = 10) {
            dam = "10";
        }
        if (temp[8000 + x] < 10) {
            dam = str(temp[8000 + x]);
        }
        monsterhp[x] = monsterhp[x] + 10;
        if (monsterhp[x] > monstermaxhp[x]) {
            monsterhp[x] = monstermaxhp[x];
        }
        if (monsterhp[x] = monstermaxhp[x]) {
            monsterhp[x] = monstermaxhp[x];
        }
        if (deadmon[x] = 0 && monsterhp[x] > 0) {
            deadmon[x] = 1;
            entity.specframe[battlemonster[x]] = 0;
        }
    }
    temp[8003] = 10 * nummon;
    monsterspirit = monsterspirit + temp[8003];
    if (monsterspirit > monstermaxspirit) {
        monsterspirit = monstermaxspirit;
    }
    monspirit = str(monsterspirit);
    for (x = 1; x < nummon2; x++) {
        if (deadmon[x] = 1) {
            entity.specframe[battlemonster[x]] = 0;
        }
        if (deadmon[x] = 0) {
            entity.specframe[battlemonster[x]] = 7;
        }
        alterftile(battlemonlocx[x], battlemonlocy[x], 0, 0);
    }
    enemyturn = 3;
}
void enemycastspell() {
    if (deadmon[enemyturn] = 1) {
        entity.specframe[battlemonster[enemyturn]] = 2;
        wait(10);
        battleeffect[5] = cachesound("magic2.wav");
        playsound(battleeffect[5], 128, 128);
        entity.specframe[battlemonster[enemyturn]] = 3;
        wait(10);
        entity.specframe[battlemonster[enemyturn]] = 4;
        wait(10);
        entity.specframe[battlemonster[enemyturn]] = 5;
        wait(10);
        entity.specframe[battlemonster[enemyturn]] = 0;
        wait(10);
        wait(50);
        enemyspell();
        enemydamages();
    }
}
void armaspell() {
    if (deadmon[enemyturn] = 1) {
        entity.specframe[battlemonster[enemyturn]] = 2;
        wait(10);
        battleeffect[5] = cachesound("magic2.wav");
        playsound(battleeffect[5], 128, 128);
        entity.specframe[battlemonster[enemyturn]] = 3;
        wait(10);
        entity.specframe[battlemonster[enemyturn]] = 4;
        wait(10);
        entity.specframe[battlemonster[enemyturn]] = 5;
        wait(10);
        entity.specframe[battlemonster[enemyturn]] = 0;
        wait(10);
        wait(50);
    }
}

void enemyspell() {
    switch (mongroup) {
    case 1:
        switch (inbatmon[enemyturn]) {
        case 4:
            if (temp[3000] = 1) {
                spellused = 3;
                ice();
                cast = 1;
            }
            if (temp[3000] = 3) {
                spellused = 2;
                fire();
                cast = 1;
            }
            if (temp[3000] = 6) {
                spellused = 2;
                fire();
                cast = 1;
            }
        }
    }
}
void cure() {
    battleeffect[5] = cachesound("heal1.wav");
    playsound(battleeffect[5], 64, 128);
    alterftile(battlelocx[target], battlelocy[target], 1274, 0);
    entity.specframe[battlechar[target]] = 9;
    champ[inparty[playerturn]] =
        champ[inparty[playerturn]] - spellpointcost[spellused];
    battlemp[playerturn] = str(champ[inparty[playerturn]]);
}
void enemyheal() {
    battleeffect[5] = cachesound("heal1.wav");
    playsound(battleeffect[5], 64, 128);
    alterftile(battlemonlocx[target], battlemonlocy[target], 1274, 0);
    if (deadchar[x] = 1) {
        entity.specframe[battlemonster[target]] = 17;
    }
    if (deadchar[x] = 0) {
        entity.specframe[battlemonster[target]] = 18;
    }
    temp[8000] = monstermaxhp[target] - monsterhp[target];
    if (temp[8000] > 20) {
        monsterspirit = monsterspirit + 20;
        if (monsterspirit > monstermaxspirit) {
            monsterspirit = monstermaxspirit;
        }
        monspirit = str(monsterspirit);
        dam = "20";
    }
    if (temp[8000] = 20) {
        monsterspirit = monsterspirit + 20;
        if (monsterspirit > monstermaxspirit) {
            monsterspirit = monstermaxspirit;
        }

        monspirit = str(monsterspirit);
        dam = "20";
    }
    if (temp[8000] < 20) {
        monsterspirit = monsterspirit + temp[8000];
        if (monsterspirit > monstermaxspirit) {
            monsterspirit = monstermaxspirit;
        }

        monspirit = str(monsterspirit);
        dam = str(temp[8000]);
    }
    monsterhp[target] = monsterhp[target] + 20;
    if (monsterhp[target] > monstermaxhp[target]) {
        monsterhp[target] = monstermaxhp[target];
    }
    if (monsterhp[target] = monstermaxhp[target]) {
        monsterhp[target] = monstermaxhp[target];
    }
    if (deadmon[target] = 0 && monsterhp[target] > 0) {
        deadmon[target] = 1;
        entity.specframe[battlemonster[target]] = 0;
    }
    damagex = battlemonlocx[target] * 16;
    damagex = damagex + 30;
    damagey = battlemonlocy[target] * 16;
    damagey = damagey + 5;
    render();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    alterftile(battlemonlocx[target], battlemonlocy[target], 0, 0);
}

void healing() {
    temp[8000] = chamaxhp[inparty[target]] - chahp[inparty[target]];
    if (temp[8000] > spellhealamount[spellused]) {
        partyspirit = partyspirit + spellhealamount[spellused];
        if (partyspirit > maxpartyspirit) {
            partyspirit = maxpartyspirit;
        }

        partspirit = str(partyspirit);
        dam = str(healamount[spellused]);
    }
    if (temp[8000] = spellhealamount[spellused]) {
        partyspirit = partyspirit + spellhealamount[spellused];
        if (partyspirit > maxpartyspirit) {
            partyspirit = maxpartyspirit;
        }

        partspirit = str(partyspirit);
        dam = str(spellhealamount[spellused]);
    }
    if (temp[8000] < spellhealamount[spellused]) {
        partyspirit = partyspirit + temp[8000];
        if (partyspirit > maxpartyspirit) {
            partyspirit = maxpartyspirit;
        }

        partspirit = str(partyspirit);
        dam = str(temp[8000]);
    }
    chahp[inparty[target]] =
        chahp[inparty[target]] + spellhealamount[spellused];
    if (chahp[inparty[target]] > chamaxhp[inparty[target]]) {
        chahp[inparty[target]] = chamaxhp[inparty[target]];
    }
    if (chahp[inparty[target]] = chamaxhp[inparty[target]]) {
        chahp[inparty[target]] = chamaxhp[inparty[target]];
    }
    battlehp[target] = str(chahp[inparty[target]]);
    if (deadchar[target] = 0 && chahp[inparty[target]] > 0) {
        charstroke[inparty[target]] = 0;
        deadchar[target] = 1;
        entity.specframe[battlechar[target]] = 0;
    }
    damagex = battlelocx[target] * 16;
    damagex = damagex + 30;
    damagey = battlelocy[target] * 16;
    damagey = damagey + 5;
    render();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    alterftile(battlelocx[target], battlelocy[target], 0, 0);
}

void fire() {
    if (playerturn > 0) {
        battleeffect[5] = cachesound("lfire.wav");
        playsound(battleeffect[5], 64, 128);
        alterftile(entity.tx[battlemonster[target]],
            entity.ty[battlemonster[target]], 1266, 0);
        alterftile(entity.tx[battlemonster[target]],
            entity.ty[battlemonster[target]] - 1, 1258, 0);
        alterftile(entity.tx[battlemonster[target]] + 1,
            entity.ty[battlemonster[target]], 1270, 0);
        alterftile(entity.tx[battlemonster[target]] + 1,
            entity.ty[battlemonster[target]] - 1, 1262, 0);
        if (deadmon[target] = 1) {
            entity.specframe[battlemonster[target]] = 8;
        }
        wait(9);
        entity.specframe[battlechar[1]] = 0;
        wait(1);
        if (deadmon[target] = 1) {
            entity.specframe[battlemonster[target]] = 9;
        }
        wait(50);
        alterftile(entity.tx[battlemonster[target]],
            entity.ty[battlemonster[target]], 0, 0);
        alterftile(entity.tx[battlemonster[target]],
            entity.ty[battlemonster[target]] - 1, 0, 0);
        alterftile(entity.tx[battlemonster[target]] + 1,
            entity.ty[battlemonster[target]], 0, 0);
        alterftile(entity.tx[battlemonster[target]] + 1,
            entity.ty[battlemonster[target]] - 1, 0, 0);
        champ[inparty[playerturn]] =
            champ[inparty[playerturn]] - spellpointcost[spellused];
        battlemp[playerturn] = str(champ[inparty[playerturn]]);
        if (humanboss = 1 && mongroup = 3 && inbatmon[1] = 10 && vara[1] = 0) {
            vara[1] = 1;
            unpress(key[28]);
            battle = 90;
            while (battle = 90) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(1, " Troll loses regeneration!!");
                showpage();
                updatecontrols();
                if (key[28]) {
                    battle = 91;
                    vara[1] = 2;
                }
            }
        }
    }
    ELSE {
        battleeffect[5] = cachesound("lfire.wav");
        playsound(battleeffect[5], 64, 128);
        alterftile(entity.tx[battlechar[montarget]],
            entity.ty[battlechar[montarget]], 1266, 0);
        alterftile(entity.tx[battlechar[montarget]],
            entity.ty[battlechar[montarget]] - 1, 1258, 0);
        alterftile(entity.tx[battlechar[montarget]] + 1,
            entity.ty[battlechar[montarget]], 1270, 0);
        alterftile(entity.tx[battlechar[montarget]] + 1,
            entity.ty[battlechar[montarget]] - 1, 1262, 0);
        wait(9);
        entity.specframe[battlemonster[enemyturn]] = 0;
        wait(50);
        alterftile(entity.tx[battlechar[montarget]],
            entity.ty[battlechar[montarget]], 0, 0);
        alterftile(entity.tx[battlechar[montarget]],
            entity.ty[battlechar[montarget]] - 1, 0, 0);
        alterftile(entity.tx[battlechar[montarget]] + 1,
            entity.ty[battlechar[montarget]], 0, 0);
        alterftile(entity.tx[battlechar[montarget]] + 1,
            entity.ty[battlechar[montarget]] - 1, 0, 0);
    }
}
void ice() {
    if (playerturn > 0) {
        battleeffect[5] = cachesound("ice.wav");
        playsound(battleeffect[5], 64, 128);
        alterftile(entity.tx[battlemonster[target]],
            entity.ty[battlemonster[target]], 1292, 0);
        alterftile(entity.tx[battlemonster[target]],
            entity.ty[battlemonster[target]] - 1, 1280, 0);
        alterftile(entity.tx[battlemonster[target]] + 1,
            entity.ty[battlemonster[target]], 1288, 0);
        alterftile(entity.tx[battlemonster[target]] + 1,
            entity.ty[battlemonster[target]] - 1, 1284, 0);
        if (deadmon[target] = 1) {
            entity.specframe[battlemonster[target]] = 8;
        }
        wait(9);
        entity.specframe[battlechar[1]] = 0;
        wait(1);
        if (deadmon[target] = 1) {
            entity.specframe[battlemonster[target]] = 9;
        }
        wait(50);
        alterftile(entity.tx[battlemonster[target]],
            entity.ty[battlemonster[target]], 0, 0);
        alterftile(entity.tx[battlemonster[target]],
            entity.ty[battlemonster[target]] - 1, 0, 0);
        alterftile(entity.tx[battlemonster[target]] + 1,
            entity.ty[battlemonster[target]], 0, 0);
        alterftile(entity.tx[battlemonster[target]] + 1,
            entity.ty[battlemonster[target]] - 1, 0, 0);
        champ[inparty[playerturn]] =
            champ[inparty[playerturn]] - spellpointcost[spellused];
        battlemp[playerturn] = str(champ[inparty[playerturn]]);
    }
    ELSE {
        battleeffect[5] = cachesound("ice.wav");
        playsound(battleeffect[5], 64, 128);
        alterftile(entity.tx[battlechar[montarget]],
            entity.ty[battlechar[montarget]], 1292, 0);
        alterftile(entity.tx[battlechar[montarget]],
            entity.ty[battlechar[montarget]] - 1, 1280, 0);
        alterftile(entity.tx[battlechar[montarget]] + 1,
            entity.ty[battlechar[montarget]], 1288, 0);
        alterftile(entity.tx[battlechar[montarget]] + 1,
            entity.ty[battlechar[montarget]] - 1, 1284, 0);
        wait(9);
        entity.specframe[battlemonster[enemyturn]] = 0;
        wait(50);
        alterftile(entity.tx[battlechar[montarget]],
            entity.ty[battlechar[montarget]], 0, 0);
        alterftile(entity.tx[battlechar[montarget]],
            entity.ty[battlechar[montarget]] - 1, 0, 0);
        alterftile(entity.tx[battlechar[montarget]] + 1,
            entity.ty[battlechar[montarget]], 0, 0);
        alterftile(entity.tx[battlechar[montarget]] + 1,
            entity.ty[battlechar[montarget]] - 1, 0, 0);
    }
}

void hellfire() {
    battleeffect[5] = cachesound("xplosion2.wav");
    playsound(battleeffect[5], 128, 128);
    zburst(
        entity.x[battlechar[montarget]], entity.y[battlechar[montarget]], 50);
    free(soundeffect[5]);
}
void showpartyselections() {
    switch (menupnt[102]) {
    case 1:
        if (deadchar[1] = 1) {
            entity.specframe[battlechar[1]] = 6;
        }
        if (deadchar[1] = 0) {
            entity.specframe[battlechar[1]] = 11;
        }
        if (deadchar[2] = 1) {
            entity.specframe[battlechar[2]] = 0;
        }
        if (deadchar[2] = 0) {
            entity.specframe[battlechar[2]] = 7;
        }
        if (deadchar[3] = 1) {
            entity.specframe[battlechar[3]] = 0;
        }
        if (deadchar[3] = 0) {
            entity.specframe[battlechar[3]] = 7;
        }
        if (deadchar[4] = 1) {
            entity.specframe[battlechar[4]] = 0;
        }
        if (deadchar[4] = 0) {
            entity.specframe[battlechar[4]] = 7;
        }

    case 2:
        if (deadchar[1] = 1) {
            entity.specframe[battlechar[1]] = 0;
        }
        if (deadchar[1] = 0) {
            entity.specframe[battlechar[1]] = 7;
        }
        if (deadchar[2] = 1) {
            entity.specframe[battlechar[2]] = 6;
        }
        if (deadchar[2] = 0) {
            entity.specframe[battlechar[2]] = 11;
        }
        if (deadchar[3] = 1) {
            entity.specframe[battlechar[3]] = 0;
        }
        if (deadchar[3] = 0) {
            entity.specframe[battlechar[3]] = 7;
        }
        if (deadchar[4] = 1) {
            entity.specframe[battlechar[4]] = 0;
        }
        if (deadchar[4] = 0) {
            entity.specframe[battlechar[4]] = 7;
        }

    case 3:
        if (deadchar[1] = 1) {
            entity.specframe[battlechar[1]] = 0;
        }
        if (deadchar[1] = 0) {
            entity.specframe[battlechar[1]] = 7;
        }
        if (deadchar[2] = 1) {
            entity.specframe[battlechar[2]] = 0;
        }
        if (deadchar[2] = 0) {
            entity.specframe[battlechar[2]] = 7;
        }
        if (deadchar[3] = 1) {
            entity.specframe[battlechar[3]] = 6;
        }
        if (deadchar[3] = 0) {
            entity.specframe[battlechar[3]] = 11;
        }
        if (deadchar[4] = 1) {
            entity.specframe[battlechar[4]] = 0;
        }
        if (deadchar[4] = 0) {
            entity.specframe[battlechar[4]] = 7;
        }
    case 4:
        if (deadchar[1] = 1) {
            entity.specframe[battlechar[1]] = 0;
        }
        if (deadchar[1] = 0) {
            entity.specframe[battlechar[1]] = 7;
        }
        if (deadchar[2] = 1) {
            entity.specframe[battlechar[2]] = 0;
        }
        if (deadchar[2] = 0) {
            entity.specframe[battlechar[2]] = 7;
        }
        if (deadchar[3] = 1) {
            entity.specframe[battlechar[3]] = 0;
        }
        if (deadchar[3] = 0) {
            entity.specframe[battlechar[3]] = 7;
        }
        if (deadchar[4] = 1) {
            entity.specframe[battlechar[4]] = 6;
        }
        if (deadchar[4] = 0) {
            entity.specframe[battlechar[4]] = 11;
        }
    }
}
void enemytalk() {
    if (mongroup = 3) {
        switch (inbatmon[enemyturn]) {
        case 8:
            if (temp[2001] < 15) {
                printstring(1, "Bah! Human scum think");
                gotoxy(305, 460);
                printstring(1, "they can fight us!");
            }
            if (temp[2001] = 15) {
                printstring(1, "Tonight we'll party!");
            }
            if (temp[2001] < 30 && temp[2001] > 15) {
                printstring(1, "I be da best of gobbos!");
                gotoxy(305, 460);
                printstring(1, "Yer sooo dead!");
            }
            if (temp[2001] = 30) {
                printstring(1, "So much blood!");
                gotoxy(305, 460);
                printstring(1, "So much FUN!");
            }
            if (temp[2001] = 40) {
                printstring(1, "Come on, kill 'em!");
            }
            if (temp[2001] < 40 && temp[2001] > 30) {
                printstring(1, "Stick 'em down! DOWN!");
            }
            if (temp[2001] > 40) {
                printstring(1, "I'll chop ya!");
            }
        case 10:
            if (temp[2001] < 15) {
                printstring(1, "Hee hee! Oggruck smells ya!");
                gotoxy(305, 460);
                printstring(1, "Clean hhumann, tasty, tasty...");
                temp[3000] = 1;
            }
            if (temp[2001] = 15) {
                printstring(1, "Where areee yooo??");
                temp[3000] = 1;
            }
            if (temp[2001] < 30 && temp[2001] > 15) {
                printstring(1, "Come come...Oggruck won't ");
                gotoxy(305, 460);
                printstring(1, "'urt ya...let 'im taste ya!");
                temp[3000] = 1;
            }
            if (temp[2001] = 30) {
                printstring(1, "Salt'n  pepper hee hee!");
                gotoxy(305, 460);
                printstring(1, "butter'n blood!");
                temp[3000] = 2;
            }
            if (temp[2001] = 40) {
                printstring(1, "Gya hya hya hya!");
                temp[3000] = 3;
            }
            if (temp[2001] < 40 && temp[2001] > 30) {
                printstring(1, "Them goblin taste a'shit!");
                temp[3000] = 2;
            }
            if (temp[2001] > 40) {
                printstring(1, "Dwarf soo HAIRY, humann GOOD!");
                temp[3000] = 3;
            }
        case 12:
            if (temp[2001] < 15) {
                printstring(1, "O spirits of the Netherworld!");
                gotoxy(305, 460);
                printstring(1, "Haunt the living!");
                temp[3000] = 1;
            }
            if (temp[2001] = 15) {
                printstring(1, "Hellfire!!!");
                temp[3000] = 7;
            }
            if (temp[2001] < 30 && temp[2001] > 15) {
                printstring(1, "Join our immortal");
                gotoxy(305, 460);
                printstring(1, "life, serve the Grimson!");
                temp[3000] = 5;
            }
            if (temp[2001] = 30) {
                printstring(1, "Dragmoria is near.");
                gotoxy(305, 460);
                printstring(1, "Bow before the Darkness!");
                temp[3000] = 6;
            }
            if (temp[2001] = 40) {
                printstring(1, "Rise from the dead");
                gotoxy(305, 460);
                printstring(1, "loyal followers!");
                temp[3000] = 4;
            }
            if (temp[2001] < 40 && temp[2001] > 30) {
                printstring(1, "Jester!");
                temp[3000] = 2;
            }
            if (temp[2001] > 40) {
                printstring(1, "Blood for the Grimson!");
                temp[3000] = 3;
            }
        }
    }
    if (mongroup = 1) {
        switch (inbatmon[enemyturn]) {
        case 4:
            if (temp[2001] < 15) {
                printstring(1, "You're good, but not");
                gotoxy(305, 460);
                printstring(1, "good enough!!");
                temp[3000] = 1;
            }
            if (temp[2001] = 15) {
                printstring(1, "Hmmm...perhaps?");
                temp[3000] = 2;
            }
            if (temp[2001] < 30 && temp[2001] > 15) {
                printstring(1, "Hmmm..time to get serious!!");
                temp[3000] = 3;
            }
            if (temp[2001] = 30) {
                printstring(1, "Is this all you got?");
                temp[3000] = 4;
            }
            if (temp[2001] = 40) {
                printstring(1, "So it's rats you want eh?!!");
                temp[3000] = 5;
            }
            if (temp[2001] < 40 && temp[2001] > 30) {
                printstring(1, "Damn you mortal spawns!!");
                temp[3000] = 6;
            }
            if (temp[2001] > 40) {
                printstring(1, "Again tonight we'll be one!!");
                temp[3000] = 7;
            }
        case 5:
            if (temp[2001] < 15) {
                printstring(1, "Hmph! You're nothing!");
            }
            if (temp[2001] = 15) {
                printstring(1, "Heh heh heh did you drop");
                gotoxy(305, 460);
                printstring(1, "your dipers baby?!!");
            }
            if (temp[2001] < 30 && temp[2001] > 15) {
                printstring(1, "Aahhhahahh!!! Taste this");
                gotoxy(305, 460);
                printstring(1, "losers!!");
            }
            if (temp[2001] = 30) {
                printstring(1, "How's this babies?!!");
            }
            if (temp[2001] = 40) {
                printstring(1, "You're gonna get hurt!!!");
            }
            if (temp[2001] < 40 && temp[2001] > 30) {
                printstring(1, "Is it time to go to mama?!!");
            }
            if (temp[2001] > 40) {
                printstring(1, "I'll bash your head in!!!");
            }
        }
    }
}
void attacktalk() {
    switch (inparty[playerturn]) {
    case 1:
        if (temp[2001] < 15) {
            printstring(1, "Take this!!!");
        }
        if (temp[2001] = 15) {
            printstring(1, "If this ain't gonna kill you...");
        }
        if (temp[2001] < 30 && temp[2001] > 15) {
            printstring(1, "Now you're a GONER!! EYAAAGH!!");
        }
        if (temp[2001] = 30) {
            printstring(1, "ANGER!!");
        }
        if (temp[2001] = 40) {
            printstring(1, "Can't you just die!!");
        }
        if (temp[2001] < 40 && temp[2001] > 30) {
            printstring(1, "I'll strike you down!!");
        }
        if (temp[2001] > 40) {
            printstring(1, "Don't toy with me jerk!");
        }
    case 4:
        if (temp[2001] < 15) {
            printstring(1, "Hah! Taste this!");
        }
        if (temp[2001] = 15) {
            printstring(1, "You will die!");
        }
        if (temp[2001] < 30 && temp[2001] > 15) {
            printstring(1, "Say your goodbyes!!");
        }
        if (temp[2001] = 30) {
            printstring(1, "Start praying!!");
        }
        if (temp[2001] = 40) {
            printstring(1, "Hah hah haa!!!");
        }
        if (temp[2001] < 40 && temp[2001] > 30) {
            printstring(1, "Time for a lesson!!");
        }
        if (temp[2001] > 40) {
            printstring(1, "Bite this!!");
        }

    case 6:
        if (temp[2001] < 15) {
            printstring(1, "Put this in your pipe");
            gotoxy(305, 460);
            printstring(1, "and smoke it!!");
        }
        if (temp[2001] = 15) {
            printstring(1, "Here goes....!!");
        }
        if (temp[2001] < 30 && temp[2001] > 15) {
            printstring(1, "Now you're mine!!");
        }
        if (temp[2001] = 30) {
            printstring(1, "RAGE!!");
        }
        if (temp[2001] = 40) {
            printstring(1, "Fire at will!!");
        }
        if (temp[2001] < 40 && temp[2001] > 30) {
            printstring(1, "You're going down mister!!");
        }
        if (temp[2001] > 40) {
            printstring(1, "Don't underestimate me!!");
        }
    case 7:
        if (temp[2001] < 15) {
            printstring(1, "Haa!! Take this!!");
        }
        if (temp[2001] = 15) {
            printstring(1, "I won't hold anything back!!");
        }
        if (temp[2001] < 30 && temp[2001] > 15) {
            printstring(1, "Bite dust fiend!!");
        }
        if (temp[2001] = 30) {
            printstring(1, "You're gonna get hurt!!!");
        }
        if (temp[2001] = 40) {
            printstring(1, "Feel the pain!!");
        }
        if (temp[2001] < 40 && temp[2001] > 30) {
            printstring(1, "Charge!!");
        }
        if (temp[2001] > 40) {
            printstring(1, "Run away now or die!!");
        }
    }
}
void runtalk() {
    switch (inparty[playerturn]) {
    case 1:
        if (temp[2001] < 25) {
            printstring(1, "Were donefor!! Retreat!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "uh oh, time to go guys!!!");
        }
        if (temp[2001] > 25) {
            printstring(1, "Let's get outta here now!!");
        }
    case 4:
        if (temp[2001] < 25) {
            printstring(1, "Hurry!! Let's go now!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "Damn! We must retreat!");
        }
        if (temp[2001] > 25) {
            printstring(1, "Let's go before it's too late!!");
        }

    case 6:
        if (temp[2001] < 25) {
            printstring(1, "Quick!! We must escape!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "They are too strong!!");
        }
        if (temp[2001] > 25) {
            printstring(1, "Come let's go!!");
        }
    case 7:
        if (temp[2001] < 25) {
            printstring(1, "No! This can't be!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "We are losing!! Let's retreat!");
        }
        if (temp[2001] > 25) {
            printstring(1, "Hmph!! Bad luck for us!");
        }
    }
}
void defendtalk() {
    switch (inparty[playerturn]) {
    case 1:
        if (temp[2001] < 25) {
            printstring(1, "Try now stupid!!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "You can't beat me!!!");
        }
        if (temp[2001] > 25) {
            printstring(1, "Must rest awhile..");
        }
    case 4:
        if (temp[2001] < 25) {
            printstring(1, "Hit me now!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "There's no way to beat me!!");
        }
        if (temp[2001] > 25) {
            printstring(1, "I think it's time to rest");
        }

    case 6:
        if (temp[2001] < 25) {
            printstring(1, "Aah!!! Help me!");
        }
        if (temp[2001] = 25) {
            printstring(1, "Take your best shot!!!");
        }
        if (temp[2001] > 25) {
            printstring(1, "Time to rest awhile");
        }
    case 7:
        if (temp[2001] < 25) {
            printstring(1, "You wouldn't dare!");
        }
        if (temp[2001] = 25) {
            printstring(1, "You can't hurt me!!!");
        }
        if (temp[2001] > 25) {
            printstring(1, "Huh? No way!");
        }
    }
}
void victorytalk() {
    switch (inparty[playerturn]) {
    case 1:
        if (temp[2001] < 25) {
            printstring(1, "We won ha ha haa!!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "Did ya see THAT!!!");
        }
        if (temp[2001] > 25) {
            printstring(1, "Alright we did it!!");
        }
    case 4:
        if (temp[2001] < 25) {
            printstring(1, "Yeah!! Nice one!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "Hah hah!! That was easy");
        }
        if (temp[2001] > 25) {
            printstring(1, "They didn't even put up");
            gotoxy(305, 460);
            printstring(1, "a fight!!");
        }

    case 6:
        if (temp[2001] < 25) {
            printstring(1, "Hih hih did you see that!!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "Wow!! What a victory!!");
        }
        if (temp[2001] > 25) {
            printstring(1, "It was an easy victory!!");
        }
    case 7:
        if (temp[2001] < 25) {
            printstring(1, "Hmph!!");
        }
        if (temp[2001] = 25) {
            printstring(1, "Yes!!! That was easy!");
        }
        if (temp[2001] > 25) {
            printstring(1, "We did it! Yeehaa!!");
        }
    }
}
void showselections() {}
void alldead() {
    if (round = 8) {
        del(10, 0, 0, 0);
        im = loadimage("reg.pcx");
        unpress(key[28]);
        battle = 40;
        regroup = 1;
        while (battle = 40) {
            render();
            Tcopysprite(70, 100, 461, 190, im);
            showpage();
            updatecontrols();
            if (key[28]) {
                unpress(key[28]);
                questio = 1;
                question(2, "What will you do?", "", "", "", "Continue",
                    "Surrender", "", "");
                free(textbox);
                textbox = loadimage("textboxi.pcx");
                if (problem = 1) {
                    vara[13] = random(100);
                    if (vara[13] <= 50) {
                        battletype = 2;
                    }
                    if (vara[13] > 50) {
                        battletype = 3;
                    }
                    fadeout(10, 10);
                    del(10, 0, 0, 0);
                    map(batmap);
                    // mapswitch(batmap,0,0,0);
                }
                if (problem = 2) {
                    temp[2001] = 0;
                    temp[2001] = temp[2001] + random(50);
                    unpress(key[28]);
                    if (key[28]) {
                        fadeout(50, 50);
                        musicfade(5);
                        wait(50);
                        frombattle = 1;
                        vara[16] = 0;
                        regroup = 0;
                        vara[30] = 0;
                        forceret = 1;
                        free(im);
                        free(im2);
                        battlegoing = 0;
                        humanboss = 0;
                        for (x = 1; x < nummon2; x++) {
                            dualattack[x] = 0;
                        }
                        for (x = 1; x < numchars2; x++) {
                            strongpoison[inparty[x]] = 0;
                        }
                        playmusic("sil.s3m");
                        del(10, 0, 0, 0);
                        musicfadein(5);
                        mapswitch(mappi, 0, 0, 0);
                    }
                }
            }
        }
    }
    if (round = 10) {
        musicfade(5);
        playmusic("sil.s3m");
        wait(5);
        playmusic("vict3.s3m");
        musicfadein(5);
        battle = 40;
        temp[2001] = 0;
        temp[2001] = temp[2001] + random(50);
        aliveparty = 0;
        For(x = 1; x < numchars2; x++) {
            if (deadchar[x] = 1) {
                aliveparty = aliveparty + 1;
            }
        }
        For(x = 1; x < nummon2; x++) {
            if (deadmon[x] = 0) {
                slums[6] = 3;
                if (inbatmon[x] = 0 && mongroup = 1) {
                    itemamount[24] = itemamount[24] + 1;
                }
                if (inbatmon[x] = 1 && mongroup = 1) {
                    itemamount[23] = itemamount[23] + 1;
                }
                if (inbatmon[x] = 2 && mongroup = 1) {
                    itemamount[25] = itemamount[25] + 1;
                }
                if (inbatmon[x] = 3 && mongroup = 1) {
                    itemamount[22] = itemamount[22] + 1;
                }
                if (inbatmon[x] = 0 && mongroup = 3) {
                    itemamount[26] = itemamount[26] + 1;
                }
                if (inbatmon[x] = 2 && mongroup = 3) {
                    itemamount[27] = itemamount[27] + 1;
                }
                if (inbatmon[x] = 1 && mongroup = 3) {
                    itemamount[28] = itemamount[28] + 1;
                }
                if (inbatmon[x] = 3 && mongroup = 3) {
                    itemamount[29] = itemamount[29] + 1;
                }
                totalexp = totalexp + monexp[inbatmon[x]];
            }
        }

        gainedexp = str(totalexp);
        gainexp = totalexp / aliveparty;
        im = loadimage("vict.pcx");
        im2 = loadimage("exp.pcx");
        while (battle = 40) {
            render();
            TCopySprite(300, screeny - 65, 320, 64, textbox);
            gotoxy(305, 420);
            printstring(1, "The enemy flees in panic!!");
            Tcopysprite(70, 100, 461, 190, im);
            showpage();
            updatecontrols();
            if (key[28]) {
                unpress(key[28]);
                battle = 41;
                while (battle = 41) {
                    render();
                    Tcopysprite(70, 100, 461, 190, im2);
                    gotoxy(200, 250);
                    printstring(
                        1, "Got " + gainedexp + " points of Experience!!");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        unpress(key[28]);
                        battle = 42;
                        while (battle = 42) {
                            For(x = 1; x < numchars2; x++) {
                                if (deadchar[x] = 1) {
                                    charexp[inparty[x]] =
                                        charexp[inparty[x]] + gainexp;
                                    chaexp[inparty[x]] =
                                        str(charexp[inparty[x]]);
                                }
                            }
                            levelup();
                            fadeout(50, 50);
                            musicfade(5);
                            wait(50);
                            frombattle = 1;
                            free(im);
                            forceret = 0;
                            humanboss = 0;
                            dualattack[2] = 0;
                            battle = 0;
                            battlegoing = 0;
                            regroup = 0;
                            for (x = 1; x < nummon2; x++) {
                                dualattack[x] = 0;
                            }
                            for (x = 1; x < numchars2; x++) {
                                strongpoison[inparty[x]] = 0;
                            }
                            playmusic("sil.s3m");
                            mapswitch(mappi, 0, 0, 0);
                        }
                    }
                }
            }
        }
    }
    ELSE {
        musicfade(5);
        playmusic("sil.s3m");
        wait(5);
        battle = 40;
        temp[2001] = 0;
        temp[2001] = temp[2001] + random(50);
        aliveparty = 0;
        For(x = 1; x < numchars2; x++) {
            if (deadchar[x] = 1) {
                aliveparty = aliveparty + 1;
            }
        }
        For(x = 1; x < nummon2; x++) {
            if (deadmon[x] = 0) {
                slums[6] = 3;
                if (inbatmon[x] = 0 && mongroup = 1) {
                    itemamount[24] = itemamount[24] + 1;
                }
                if (inbatmon[x] = 1 && mongroup = 1) {
                    itemamount[23] = itemamount[23] + 1;
                }
                if (inbatmon[x] = 2 && mongroup = 1) {
                    itemamount[25] = itemamount[25] + 1;
                }
                if (inbatmon[x] = 3 && mongroup = 1) {
                    itemamount[22] = itemamount[22] + 1;
                }
                if (inbatmon[x] = 0 && mongroup = 3) {
                    itemamount[26] = itemamount[26] + 1;
                }
                if (inbatmon[x] = 2 && mongroup = 3) {
                    itemamount[27] = itemamount[27] + 1;
                }
                if (inbatmon[x] = 1 && mongroup = 3) {
                    itemamount[28] = itemamount[28] + 1;
                }
                if (inbatmon[x] = 3 && mongroup = 3) {
                    itemamount[29] = itemamount[29] + 1;
                }
                totalexp = totalexp + monexp[inbatmon[x]];
            }
        }
        if (vara[30] = 0) {
            im = loadimage("vict.pcx");
            playmusic("vict3.s3m");
            musicfadein(5);
        }
        if (vara[30] > 0) {
            im = loadimage("mvict.pcx");
            playmusic("vict1.s3m");
            musicfadein(5);
            totalexp = totalexp + monexp[inbatmon[1]];
            if (mongroup = 1 && inbatmon[2] = 4) {
                totalexp = totalexp + monexp[inbatmon[2]];
            }
        }
        gainedexp = str(totalexp);
        gainexp = totalexp / aliveparty;
        im2 = loadimage("exp.pcx");
        if (monsterspirit > 0) {
            while (battle = 40) {
                render();
                if (monsterspirit > 0 && allmondead < nummon) {
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, "The enemy flees in panic!!");
                }
                Tcopysprite(70, 100, 461, 190, im);
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    battle = 41;
                    while (battle = 41) {
                        render();
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        if (vara[30] = 3) {
                            gotoxy(200, 270);
                            printstring(1, "Got 4 Eyedrops!!");
                        }
                        if (vara[30] = 1) {
                            gotoxy(200, 270);
                            printstring(1, "Got 2 medikits!!");
                            gotoxy(200, 290);
                            printstring(1, "Got 50 crowns!!");
                        }
                        if (vara[30] = 2) {
                            gotoxy(200, 270);
                            printstring(1, "Got 2 energydrinks!!");
                            gotoxy(200, 290);
                            printstring(1, "Got 75 crowns!!");
                        }
                        if (vara[30] = 4) {
                            gotoxy(200, 270);
                            printstring(1, "Got 3 medikits!!");
                            gotoxy(200, 290);
                            printstring(1, "Got 1 mp-potion!!");
                            gotoxy(200, 310);
                            printstring(1, "Got 25 crowns!!");
                        }
                        if (vara[30] = 5) {
                            gotoxy(200, 270);
                            printstring(1, "Got 2 prayers!!");
                            gotoxy(200, 290);
                            printstring(1, "Got 2 soulpotions!!");
                        }
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            unpress(key[28]);
                            battle = 42;
                            while (battle = 42) {
                                render();
                                Tcopysprite(200, screeny - 97, 96, 96,
                                    charpic[inparty[playerturn]]);
                                TCopySprite(
                                    300, screeny - 65, 320, 64, textbox);
                                gotoxy(305, 420);
                                printstring(
                                    1, charname[inparty[playerturn]] + ":");
                                gotoxy(305, 440);
                                victorytalk();
                                showpage();
                                updatecontrols();
                                if (key[28]) {
                                    unpress(key[28]);
                                    battle = 43;
                                    while (battle = 43) {
                                        For(x = 1; x < numchars2; x++) {
                                            if (deadchar[x] = 1) {
                                                charexp[inparty[x]] =
                                                    charexp[inparty[x]] +
                                                    gainexp;
                                                chaexp[inparty[x]] =
                                                    str(charexp[inparty[x]]);
                                            }
                                        }
                                        levelup();
                                        if (vara[30] = 3) {
                                            itemamount[30] = itemamount[30] + 4;
                                        }
                                        if (vara[30] = 1) {
                                            crowns = crowns + 50;
                                            itemamount[6] = itemamount[6] + 2;
                                        }
                                        if (vara[30] = 2) {
                                            crowns = crowns + 75;
                                            itemamount[1] = itemamount[1] + 2;
                                        }

                                        if (vara[30] = 4) {
                                            crowns = crowns + 25;
                                            itemamount[6] = itemamount[6] + 3;
                                            itemamount[8] = itemamount[8] + 1;
                                        }
                                        if (vara[30] = 5) {
                                            itemamount[16] = itemamount[16] + 2;
                                            itemamount[17] = itemamount[17] + 2;
                                        }
                                        fadeout(50, 50);
                                        musicfade(5);
                                        wait(50);
                                        frombattle = 1;
                                        free(im);
                                        free(im2);
                                        forceret = 0;
                                        vara[30] = 0;
                                        humanboss = 0;
                                        battlegoing = 0;
                                        regroup = 0;
                                        for (x = 1; x < nummon2; x++) {
                                            dualattack[x] = 0;
                                        }
                                        for (x = 1; x < numchars2; x++) {
                                            strongpoison[inparty[x]] = 0;
                                        }
                                        playmusic("sil.s3m");
                                        mapswitch(mappi, 0, 0, 0);
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
        if (monsterspirit <= 0) {
            while (battle = 40) {
                render();
                Tcopysprite(
                    200, screeny - 97, 96, 96, charpic[inparty[playerturn]]);
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 420);
                printstring(1, charname[inparty[playerturn]] + ":");
                if (vara[30] = 3) {
                    gotoxy(200, 270);
                    printstring(1, "Got 4 Eyedrops!!");
                }
                if (vara[30] = 1) {
                    gotoxy(200, 270);
                    printstring(1, "Got 2 medikits!!");
                    gotoxy(200, 290);
                    printstring(1, "Got 50 crowns!!");
                }
                if (vara[30] = 2) {
                    gotoxy(200, 270);
                    printstring(1, "Got 2 energydrinks!!");
                    gotoxy(200, 290);
                    printstring(1, "Got 75 crowns!!");
                }
                if (vara[30] = 4) {
                    gotoxy(200, 270);
                    printstring(1, "Got 3 medikits!!");
                    gotoxy(200, 290);
                    printstring(1, "Got 1 mp-potion!!");
                    gotoxy(200, 310);
                    printstring(1, "Got 25 crowns!!");
                }
                if (vara[30] = 5) {
                    gotoxy(200, 270);
                    printstring(1, "Got 2 prayers!!");
                    gotoxy(200, 290);
                    printstring(1, "Got 2 soulpotions!!");
                }
                gotoxy(305, 440);
                victorytalk();
                Tcopysprite(70, 100, 461, 190, im);
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    battle = 41;
                    while (battle = 41) {
                        render();
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            unpress(key[28]);
                            battle = 42;
                            while (battle = 42) {
                                For(x = 1; x < numchars2; x++) {
                                    if (deadchar[x] = 1) {
                                        charexp[inparty[x]] =
                                            charexp[inparty[x]] + gainexp;
                                        chaexp[inparty[x]] =
                                            str(charexp[inparty[x]]);
                                    }
                                }
                                levelup();
                                if (vara[30] = 3) {
                                    itemamount[30] = itemamount[30] + 4;
                                }
                                if (vara[30] = 1) {
                                    crowns = crowns + 50;
                                    itemamount[6] = itemamount[6] + 2;
                                }
                                if (vara[30] = 2) {
                                    crowns = crowns + 75;
                                    itemamount[1] = itemamount[1] + 2;
                                }

                                if (vara[30] = 4) {
                                    crowns = crowns + 25;
                                    itemamount[6] = itemamount[6] + 3;
                                    itemamount[8] = itemamount[8] + 1;
                                }
                                if (vara[30] = 4) {
                                    itemamount[16] = itemamount[16] + 2;
                                    itemamount[17] = itemamount[17] + 2;
                                }
                                fadeout(50, 50);
                                musicfade(5);
                                wait(50);
                                frombattle = 1;
                                free(im);
                                free(im2);
                                humanboss = 0;
                                battlegoing = 0;
                                regroup = 0;
                                forceret = 0;
                                for (x = 1; x < nummon2; x++) {
                                    dualattack[x] = 0;
                                }
                                for (x = 1; x < numchars2; x++) {
                                    strongpoison[inparty[x]] = 0;
                                }
                                playmusic("sil.s3m");
                                mapswitch(mappi, 0, 0, 0);
                            }
                        }
                    }
                }
            }
        }
    }
}
void levelup() {
    For(x = 1; x < numchars2; x++) {
        if (inparty[x] > 0) {
            switch (inparty[x]) {
            case 1:
                if (charexp[1] > tonext[1]) {
                    chalevel[1] = chalevel[1] + 1;
                    charexp[1] = 0;
                    levelling = inparty[x];
                    improvements();
                    tonext[1] = tonext[1] + tonext[1];
                    tnext[1] = str(tonext[1]);
                    battle = 50;
                    unpress(key[28]);
                    while (battle = 50) {
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, charname[1] + " gained a level!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 0;
                        }
                    }
                }
                if (charexp[1] > tonext[1]) {
                    chalevel[1] = chalevel[1] + 1;
                    charexp[1] = 0;
                    levelling = inparty[x];
                    improvements();
                    tonext[1] = tonext[1] + tonext[1];
                    tnext[1] = str(tonext[1]);
                    battle = 50;
                    unpress(key[28]);
                    while (battle = 50) {
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, charname[1] + " gained a level!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 0;
                        }
                    }
                }
                charlevel[1] = str(chalevel[1]);
            case 4:
                if (charexp[4] > tonext[4]) {
                    chalevel[4] = chalevel[4] + 1;
                    charexp[4] = 0;
                    levelling = inparty[x];
                    improvements();
                    tonext[4] = tonext[4] + tonext[4];
                    tnext[4] = str(tonext[4]);
                    battle = 50;
                    unpress(key[28]);
                    while (battle = 50) {
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, charname[4] + " gained a level!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 0;
                        }
                    }
                }
                if (charexp[4] > tonext[4]) {
                    chalevel[4] = chalevel[4] + 1;
                    charexp[4] = 0;
                    levelling = inparty[x];
                    improvements();
                    tonext[4] = tonext[4] + tonext[4];
                    tnext[4] = str(tonext[4]);
                    unpress(key[28]);
                    battle = 50;
                    while (battle = 50) {
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(
                            1, charname[inparty[4]] + " gained a level!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 0;
                        }
                    }
                }
                charlevel[4] = str(chalevel[4]);
            case 7:
                if (charexp[7] > tonext[7]) {
                    chalevel[7] = chalevel[7] + 1;
                    charexp[7] = 0;
                    levelling = inparty[x];
                    improvements();
                    tonext[7] = tonext[7] + tonext[7];
                    tnext[7] = str(tonext[7]);
                    battle = 50;
                    unpress(key[28]);
                    while (battle = 50) {
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, charname[7] + " gained a level!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 0;
                        }
                    }
                }
                if (charexp[7] > tonext[7]) {
                    chalevel[7] = chalevel[7] + 1;
                    charexp[7] = 0;
                    levelling = inparty[x];
                    improvements();
                    tonext[7] = tonext[7] + tonext[7];
                    tnext[7] = str(tonext[7]);
                    battle = 50;
                    unpress(key[28]);
                    while (battle = 50) {
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(
                            1, charname[inparty[7]] + " gained a level!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 0;
                        }
                    }
                }
                charlevel[7] = str(chalevel[7]);

            case 6:
                if (charexp[6] > tonext[6]) {
                    chalevel[6] = chalevel[6] + 1;
                    charexp[6] = 0;
                    levelling = inparty[x];
                    improvements();
                    tonext[6] = tonext[6] + tonext[6];
                    tnext[6] = str(tonext[6]);
                    battle = 50;
                    unpress(key[28]);
                    while (battle = 50) {
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, charname[6] + " gained a level!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 0;
                        }
                    }
                }
                if (charexp[6] > tonext[6]) {
                    chalevel[6] = chalevel[6] + 1;
                    charexp[6] = 0;
                    levelling = inparty[x];
                    improvements();
                    tonext[6] = tonext[6] + tonext[6];
                    tnext[6] = str(tonext[6]);
                    battle = 50;
                    unpress(key[28]);
                    while (battle = 50) {
                        Tcopysprite(70, 100, 461, 190, im2);
                        gotoxy(200, 250);
                        printstring(
                            1, "Got " + gainedexp + " points of Experience!!");
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, charname[6] + " gained a level!!");
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 0;
                        }
                    }
                }
                charlevel[6] = str(chalevel[6]);
            }
        }
    }
}
void gameover() {
    if (vara[20] = 2) {
        im = loadimage("def.pcx");
    }
    if (vara[20] = 1) {
        im = loadimage("ret.pcx");
    }
    musicfade(5);
    playmusic("sil.s3m");
    wait(5);
    playmusic("dead.s3m");
    musicfadein(5);
    battle = 40;
    wait(10);
    unpress(key[28]);
    while (battle = 40) {
        render();
        Tcopysprite(70, 100, 461, 190, im);
        showpage();
        updatecontrols();
        if (key[28]) {
            if (vara[20] = 1) {
                fadeout(50, 50);
                musicfade(5);
                wait(50);
                frombattle = 1;
                free(im);
                humanboss = 0;
                vara[30] = 0;
                dualattack[2] = 0;
                forceret = 1;
                battlegoing = 0;
                vara[20] = 0;
                for (x = 1; x < numchars2; x++) {
                    strongpoison[inparty[x]] = 0;
                }
                playmusic("sil.s3m");
                mapswitch(mappi, 0, 0, 0);
            }
            if (vara[20] = 2) {
                fadeout(50, 50);
                musicfade(5);
                wait(50);
                exit("So, early death was your destiny.");
            }
        }
    }
}
void checkdie() {
    For(x = 1; x < nummon2; x++) {
        if (deadmon[x] = 0) {
            entity.specframe[battlemonster[x]] = 7;
        }
    }
}
void checkdie2() {
    For(x = 1; x < numchars2; x++) {
        if (deadchar[x] = 0) {
            entity.specframe[battlechar[x]] = 7;
        }
    }
}
void castspell() {
    entity.y[battlechar[1]] = 1000;
    free(battlechar[1]);
    battlechar[1] = entityspawn(battlelocx[1], battlelocy[1], "ellb.chr");
    battleeffect[5] = cachesound("magic2.wav");
    playsound(battleeffect[5], 128, 128);
    entity.specframe[battlechar[1]] = 12;
    wait(10);
    entity.specframe[battlechar[1]] = 13;
    wait(10);
    entity.specframe[battlechar[1]] = 14;
    wait(10);
    entity.specframe[battlechar[1]] = 15;
    wait(10);
    entity.specframe[battlechar[1]] = 16;
    wait(100);
    entity.y[battlechar[1]] = 1000;
    if (weapontype[equippedweapon[inparty[1]]] =
            1 && equippedweapon[inparty[1]] = 1) {
        battlechar[1] = entityspawn(battlelocx[1], battlelocy[1], "ellb.chr");
    }
    if (weapontype[equippedweapon[inparty[1]]] = 0) {
        battlechar[1] = entityspawn(battlelocx[1], battlelocy[1], "ellb3.chr");
    }
    if (weapontype[equippedweapon[inparty[1]]] = 10) {
        battlechar[1] = entityspawn(battlelocx[1], battlelocy[1], "ellb5.chr");
    }
    if (weapontype[equippedweapon[inparty[1]]] = 11) {
        battlechar[1] = entityspawn(battlelocx[1], battlelocy[1], "ellb4.chr");
    }
    if (weapontype[equippedweapon[inparty[1]]] =
            1 && equippedweapon[inparty[1]] = 3) {
        battlechar[1] = entityspawn(battlelocx[1], battlelocy[1], "ellb6.chr");
    }
    if (weapontype[equippedweapon[inparty[1]]] = 2) {
        battlechar[1] = entityspawn(battlelocx[1], battlelocy[1], "ellb7.chr");
    }
    if (spellbasetype[spellused] = 2) {
        if (spelltype[spellused] = 18) {
            fire();
        }
        if (spelltype[spellused] = 26) {
            ice();
        }
        cast = 1;
        damages();
    }
    if (spellbasetype[spellused] = 1) {
        cure();
        healing();
    }
}
void battleselections() {
    if (deadchar[playerturn] = 0) {
        playerturn = playerturn + 1;
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (playerturn > numchars) {
            if (battletype = 1) {
                playerturn = 0;
                enemyturn = 1;
                render();
                enemyattack();
            }
            if (battletype = 2) {
                playerturn = 0;
                enemyturn = 1;
                render();
                enemyattack();
            }
            if (battletype = 3) {
                if (once = 0) {
                    round = round + 1;
                    rounds = str(round);
                    if (deadchar[1] = 1) {
                        playerturn = 1;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 1) {
                        playerturn = 2;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 0 && deadchar[3] = 1) {
                        playerturn = 3;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 0 && deadchar[3] =
                                                             0 && deadchar[4] =
                                                                 1) {
                        playerturn = 4;
                    }
                    render();
                    once = 1;
                    battleselections();
                }
                if (once = 1) {
                    playerturn = 0;
                    enemyturn = 1;
                    render();
                    enemyattack();
                }
            }
        }

        render();
        battleselections();
    }
    if (charsleep[inparty[playerturn]] = 1) {
        battle = 51;
        while (battle = 51) {
            render();
            TCopySprite(300, screeny - 65, 320, 64, textbox);
            gotoxy(305, 440);
            printstring(
                1, "   " + charname[inparty[playerturn]] + " is sleeping!!");
            showsels();
            showpage();
            updatecontrols();
            if (key[28]) {
                unpress(key[28]);
                battle = 50;
            }
        }
        if (charpoisoned[inparty[playerturn]] = 1) {
            battle = 51;
            while (battle = 51) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(1, "   Poison takes effect!!");
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    poisoned();
                    battle = 50;
                }
            }
        }
        playerturn = playerturn + 1;
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (playerturn > numchars) {
            if (battletype = 1) {
                playerturn = 0;
                enemyturn = 1;
                render();
                enemyattack();
            }
            if (battletype = 2) {
                playerturn = 0;
                enemyturn = 1;
                render();
                enemyattack();
            }
            if (battletype = 3) {
                if (once = 0) {
                    round = round + 1;
                    rounds = str(round);
                    if (deadchar[1] = 1) {
                        playerturn = 1;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 1) {
                        playerturn = 2;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 0 && deadchar[3] = 1) {
                        playerturn = 3;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 0 && deadchar[3] =
                                                             0 && deadchar[4] =
                                                                 1) {
                        playerturn = 4;
                    }
                    render();
                    once = 1;
                    battleselections();
                }
                if (once = 1) {
                    playerturn = 0;
                    enemyturn = 1;
                    render();
                    enemyattack();
                }
            }
        }

        render();
        battleselections();
    }
    if (charpara[inparty[playerturn]] = 1) {
        battle = 51;
        while (battle = 51) {
            render();
            TCopySprite(300, screeny - 65, 320, 64, textbox);
            gotoxy(305, 440);
            printstring(
                1, "   " + charname[inparty[playerturn]] + " is paralyzed!!");
            showsels();
            showpage();
            updatecontrols();
            if (key[28]) {
                unpress(key[28]);
                battle = 50;
            }
        }
        if (charpoisoned[inparty[playerturn]] = 1) {
            battle = 51;
            while (battle = 51) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(1, "   Poison takes effect!!");
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    poisoned();
                    battle = 50;
                }
            }
        }
        playerturn = playerturn + 1;
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (deadchar[playerturn] = 0) {
            playerturn = playerturn + 1;
        }
        if (playerturn > numchars) {
            if (battletype = 1) {
                playerturn = 0;
                enemyturn = 1;
                render();
                enemyattack();
            }
            if (battletype = 2) {
                playerturn = 0;
                enemyturn = 1;
                render();
                enemyattack();
            }
            if (battletype = 3) {
                if (once = 0) {
                    round = round + 1;
                    rounds = str(round);
                    if (deadchar[1] = 1) {
                        playerturn = 1;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 1) {
                        playerturn = 2;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 0 && deadchar[3] = 1) {
                        playerturn = 3;
                    }
                    if (deadchar[1] = 0 && deadchar[2] = 0 && deadchar[3] =
                                                             0 && deadchar[4] =
                                                                 1) {
                        playerturn = 4;
                    }
                    render();
                    once = 1;
                    battleselections();
                }
                if (once = 1) {
                    playerturn = 0;
                    enemyturn = 1;
                    render();
                    enemyattack();
                }
            }
        }

        render();
        battleselections();
    }
    if (chargrazy[inparty[playerturn]] = 1) {
        temp[2001] = 0;
        temp[2003] = 0;
        temp[2001] = random(100);
        if (temp[2001] <= 50) {
            temp[2003] = 1;
        }
        ELSE { temp[2003] = 2; }
        switch (temp[2003]) {
        case 1:
            target = random(nummon);
            if (target = 0) {
                target = 1;
            }
            battle = 50;
            temp[2001] = 0;
            temp[2001] = temp[2001] + random(50);
            while (battle = 50) {
                render();
                Tcopysprite(
                    200, screeny - 97, 96, 96, charpic[inparty[playerturn]]);
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 420);
                printstring(1, charname[inparty[playerturn]] + ":");
                gotoxy(305, 440);
                attacktalk();
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    attack();
                    if (deadmon[target] = 1) {
                        entity.specframe[battlemonster[target]] = 0;
                    }
                    if (deadmon[target] = 0) {
                        entity.specframe[battlemonster[target]] = 7;
                    }
                    if (deadchar[playerturn] = 1) {
                        entity.specframe[battlechar[playerturn]] = 0;
                    }
                    if (deadchar[playerturn] = 0) {
                        entity.specframe[battlechar[playerturn]] = 7;
                    }
                    if (charpoisoned[inparty[playerturn]] = 1) {
                        battle = 51;
                        while (battle = 51) {
                            render();
                            TCopySprite(300, screeny - 65, 320, 64, textbox);
                            gotoxy(305, 440);
                            printstring(1, "   Poison takes effect!!");
                            showsels();
                            showpage();
                            updatecontrols();
                            if (key[28]) {
                                unpress(key[28]);
                                poisoned();
                                battle = 50;
                            }
                        }
                    }
                    playerturn = playerturn + 1;
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (playerturn > numchars) {
                        if (battletype = 1) {
                            playerturn = 0;
                            enemyturn = 1;
                            render();
                            enemyattack();
                        }
                        if (battletype = 2) {
                            playerturn = 0;
                            enemyturn = 1;
                            render();
                            enemyattack();
                        }
                        if (battletype = 3) {
                            if (once = 0) {
                                round = round + 1;
                                rounds = str(round);
                                if (deadchar[1] = 1) {
                                    playerturn = 1;
                                }
                                if (deadchar[1] = 0 && deadchar[2] = 1) {
                                    playerturn = 2;
                                }
                                if (deadchar[1] = 0 && deadchar[2] =
                                                      0 && deadchar[3] = 1) {
                                    playerturn = 3;
                                }
                                if (deadchar[1] = 0 && deadchar[2] =
                                                      0 && deadchar[3] =
                                                          0 && deadchar[4] =
                                                              1) {
                                    playerturn = 4;
                                }
                                render();
                                once = 1;
                                battleselections();
                            }
                            if (once = 1) {
                                playerturn = 0;
                                enemyturn = 1;
                                render();
                                enemyattack();
                            }
                        }
                    }
                    render();
                    battleselections();
                }
            }
        case 2:
            target = random(numchars);
            if (target = 0) {
                target = 1;
            }
            battle = 50;
            temp[2001] = 0;
            temp[2001] = temp[2001] + random(50);
            while (battle = 50) {
                render();
                Tcopysprite(
                    200, screeny - 97, 96, 96, charpic[inparty[playerturn]]);
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 420);
                printstring(1, charname[inparty[playerturn]] + ":");
                gotoxy(305, 440);
                attacktalk();
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    attack();
                    if (deadmon[target] = 1) {
                        entity.specframe[battlemonster[target]] = 0;
                    }
                    if (deadmon[target] = 0) {
                        entity.specframe[battlemonster[target]] = 7;
                    }
                    if (deadchar[playerturn] = 1) {
                        entity.specframe[battlechar[playerturn]] = 0;
                    }
                    if (deadchar[playerturn] = 0) {
                        entity.specframe[battlechar[playerturn]] = 7;
                    }
                    if (charpoisoned[inparty[playerturn]] = 1) {
                        battle = 51;
                        while (battle = 51) {
                            render();
                            TCopySprite(300, screeny - 65, 320, 64, textbox);
                            gotoxy(305, 440);
                            printstring(1, "   Poison takes effect!!");
                            showsels();
                            showpage();
                            updatecontrols();
                            if (key[28]) {
                                unpress(key[28]);
                                poisoned();
                                battle = 50;
                            }
                        }
                    }
                    playerturn = playerturn + 1;
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (deadchar[playerturn] = 0) {
                        playerturn = playerturn + 1;
                    }
                    if (playerturn > numchars) {
                        if (battletype = 1) {
                            playerturn = 0;
                            enemyturn = 1;
                            render();
                            enemyattack();
                        }
                        if (battletype = 2) {
                            playerturn = 0;
                            enemyturn = 1;
                            render();
                            enemyattack();
                        }
                        if (battletype = 3) {
                            if (once = 0) {
                                round = round + 1;
                                rounds = str(round);
                                if (deadchar[1] = 1) {
                                    playerturn = 1;
                                }
                                if (deadchar[1] = 0 && deadchar[2] = 1) {
                                    playerturn = 2;
                                }
                                if (deadchar[1] = 0 && deadchar[2] =
                                                      0 && deadchar[3] = 1) {
                                    playerturn = 3;
                                }
                                if (deadchar[1] = 0 && deadchar[2] =
                                                      0 && deadchar[3] =
                                                          0 && deadchar[4] =
                                                              1) {
                                    playerturn = 4;
                                }
                                render();
                                once = 1;
                                battleselections();
                            }
                            if (once = 1) {
                                playerturn = 0;
                                enemyturn = 1;
                                render();
                                enemyattack();
                            }
                        }
                    }
                    render();
                    battleselections();
                }
            }
        }
    }
    if (charberserk[inparty[playerturn]] = 1) {
        target = random(nummon);
        if (target = 0) {
            target = 1;
        }
        battle = 50;
        temp[2001] = 0;
        temp[2001] = temp[2001] + random(50);
        while (battle = 50) {
            render();
            Tcopysprite(
                200, screeny - 97, 96, 96, charpic[inparty[playerturn]]);
            TCopySprite(300, screeny - 65, 320, 64, textbox);
            gotoxy(305, 420);
            printstring(1, charname[inparty[playerturn]] + ":");
            gotoxy(305, 440);
            attacktalk();
            showsels();
            showpage();
            updatecontrols();
            if (key[28]) {
                attack();
                if (deadmon[target] = 1) {
                    entity.specframe[battlemonster[target]] = 0;
                }
                if (deadmon[target] = 0) {
                    entity.specframe[battlemonster[target]] = 7;
                }
                if (deadchar[playerturn] = 1) {
                    entity.specframe[battlechar[playerturn]] = 0;
                }
                if (deadchar[playerturn] = 0) {
                    entity.specframe[battlechar[playerturn]] = 7;
                }
                if (charpoisoned[inparty[playerturn]] = 1) {
                    battle = 51;
                    while (battle = 51) {
                        render();
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 440);
                        printstring(1, "   Poison takes effect!!");
                        showsels();
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            unpress(key[28]);
                            poisoned();
                            battle = 50;
                        }
                    }
                }
                playerturn = playerturn + 1;
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (playerturn > numchars) {
                    if (battletype = 1) {
                        playerturn = 0;
                        enemyturn = 1;
                        render();
                        enemyattack();
                    }
                    if (battletype = 2) {
                        playerturn = 0;
                        enemyturn = 1;
                        render();
                        enemyattack();
                    }
                    if (battletype = 3) {
                        if (once = 0) {
                            round = round + 1;
                            rounds = str(round);
                            if (deadchar[1] = 1) {
                                playerturn = 1;
                            }
                            if (deadchar[1] = 0 && deadchar[2] = 1) {
                                playerturn = 2;
                            }
                            if (deadchar[1] = 0 && deadchar[2] =
                                                  0 && deadchar[3] = 1) {
                                playerturn = 3;
                            }
                            if (deadchar[1] = 0 && deadchar[2] =
                                                  0 && deadchar[3] =
                                                      0 && deadchar[4] = 1) {
                                playerturn = 4;
                            }
                            render();
                            once = 1;
                            battleselections();
                        }
                        if (once = 1) {
                            playerturn = 0;
                            enemyturn = 1;
                            render();
                            enemyattack();
                        }
                    }
                }

                render();
                battleselections();
            }
        }
    }
    For(x = 1; x < numchars2; x++) {
        if (inparty[x] > 0) {
            battlehp[inparty[x]] = str(chahp[inparty[x]]);
            battlemp[inparty[x]] = str(champ[inparty[x]]);
            if (defend[x] = 1) {
                entity.specframe[battlechar[x]] = 8;
            }
            if (deadchar[x] = 1) {
                entity.specframe[battlechar[x]] = 0;
            }
            if (deadchar[x] = 0) {
                entity.specframe[battlechar[x]] = 7;
            }
        }
    }
    for (x = 1; x < numchars2; x++) {
        if (defend[x] = 1) {
            entity.specframe[battlechar[x]] = 8;
        }
    }
    battle = 1;
    render();
    menupnt[100] = 1;
    while (battle = 1) {
        for (x = 1; x < numchars2; x++) {
            if (defend[x] = 1) {
                entity.specframe[battlechar[x]] = 8;
            }
        }
        showplayerinfo();
        showsels();
        showpage();
        updatecontrols();
        if (key[80]) {
            menupnt[100]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            menupnt[100]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[100] < 1) { menupnt[100] = 7; }
        if (menupnt[100] > 7) {
            menupnt[100] = 1;
        }
        if (key[28]) {
            if (menupnt[100] = 6) {
                unpress(key[28]);
                mmenu = 3;
                stat = playerturn;
                menupnt[9] = stat;
                statusmenu();
            }
            if (menupnt[100] = 3) {
                mmenu = 2;
                itemmenu();
                if (charpoisoned[inparty[playerturn]] = 1) {
                    battle = 51;
                    while (battle = 51) {
                        render();
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 440);
                        printstring(1, "Poison takes effect!!");
                        showsels();
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            unpress(key[28]);
                            poisoned();
                            battle = 50;
                        }
                    }
                }
                playerturn = playerturn + 1;
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (deadchar[playerturn] = 0) {
                    playerturn = playerturn + 1;
                }
                if (playerturn > numchars) {
                    if (battletype = 1) {
                        playerturn = 0;
                        enemyturn = 1;
                        render();
                        enemyattack();
                    }
                    if (battletype = 2) {
                        playerturn = 0;
                        enemyturn = 1;
                        render();
                        enemyattack();
                    }
                    if (battletype = 3) {
                        if (once = 0) {
                            round = round + 1;
                            rounds = str(round);
                            if (deadchar[1] = 1) {
                                playerturn = 1;
                            }
                            if (deadchar[1] = 0 && deadchar[2] = 1) {
                                playerturn = 2;
                            }
                            if (deadchar[1] = 0 && deadchar[2] =
                                                  0 && deadchar[3] = 1) {
                                playerturn = 3;
                            }
                            if (deadchar[1] = 0 && deadchar[2] =
                                                  0 && deadchar[3] =
                                                      0 && deadchar[4] = 1) {
                                playerturn = 4;
                            }
                            render();
                            once = 1;
                            battleselections();
                        }
                        if (once = 1) {
                            playerturn = 0;
                            enemyturn = 1;
                            render();
                            enemyattack();
                        }
                    }
                }

                render();
                battleselections();
            }
            if (menupnt[100] = 5) {
                unpress(key[28]);
                battle = 50;
                temp[2001] = 0;
                temp[2001] = temp[2001] + random(50);
                while (battle = 50) {
                    render();
                    Tcopysprite(200, screeny - 97, 96, 96,
                        charpic[inparty[playerturn]]);
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, charname[inparty[playerturn]] + ":");
                    gotoxy(305, 440);
                    defendtalk();
                    showsels();
                    showpage();
                    updatecontrols();
                    temp[803] = playerturn;
                    entity.specframe[battlechar[temp[803]]] = 8;
                    defend[temp[803]] = 1;
                    if (key[28]) {
                        unpress(key[28]);
                        if (charpoisoned[inparty[playerturn]] = 1) {
                            battle = 51;
                            while (battle = 51) {
                                render();
                                TCopySprite(
                                    300, screeny - 65, 320, 64, textbox);
                                gotoxy(305, 440);
                                printstring(1, "   Poison takes effect!!");
                                showsels();
                                showpage();
                                updatecontrols();
                                if (key[28]) {
                                    unpress(key[28]);
                                    poisoned();
                                    battle = 50;
                                }
                            }
                        }
                        playerturn = playerturn + 1;
                        if (deadchar[playerturn] = 0) {
                            playerturn = playerturn + 1;
                        }
                        if (deadchar[playerturn] = 0) {
                            playerturn = playerturn + 1;
                        }
                        if (deadchar[playerturn] = 0) {
                            playerturn = playerturn + 1;
                        }
                        if (deadchar[playerturn] = 0) {
                            playerturn = playerturn + 1;
                        }
                        if (deadchar[playerturn] = 0) {
                            playerturn = playerturn + 1;
                        }
                        if (deadchar[playerturn] = 0) {
                            playerturn = playerturn + 1;
                        }
                        if (deadchar[playerturn] = 0) {
                            playerturn = playerturn + 1;
                        }
                        if (playerturn > numchars) {
                            if (battletype = 1) {
                                playerturn = 0;
                                enemyturn = 1;
                                render();
                                enemyattack();
                            }
                            if (battletype = 2) {
                                playerturn = 0;
                                enemyturn = 1;
                                render();
                                enemyattack();
                            }
                            if (battletype = 3) {
                                if (once = 0) {
                                    round = round + 1;
                                    rounds = str(round);
                                    if (deadchar[1] = 1) {
                                        playerturn = 1;
                                    }
                                    if (deadchar[1] = 0 && deadchar[2] = 1) {
                                        playerturn = 2;
                                    }
                                    if (deadchar[1] = 0 && deadchar[2] =
                                                          0 && deadchar[3] =
                                                              1) {
                                        playerturn = 3;
                                    }
                                    if (deadchar[1] = 0 && deadchar[2] =
                                                          0 && deadchar[3] =
                                                              0 && deadchar[4] =
                                                                  1) {
                                        playerturn = 4;
                                    }
                                    render();
                                    once = 1;
                                    battleselections();
                                }
                                if (once = 1) {
                                    playerturn = 0;
                                    enemyturn = 1;
                                    render();
                                    enemyattack();
                                }
                            }
                        }
                        entity.specframe[battlechar[temp[803]]] = 8;
                        defend[temp[803]] = 1;
                        render();
                        battleselections();
                    }
                }
            }
            if (menupnt[100] = 2 && champ[inparty[playerturn]] > 0 &&
                               charsilence[inparty[playerturn]] = 0) {
                unpress(key[28]);
                magi = playerturn;
                mmenu = 5;
                menupnt[5] = 1;
                menupnt[30] = 1;
                magicmenu();
                menupnt[102] = 1;
                battle = 70;
                if (vara[17] = 1) {
                    unpress(key[28]);
                    vara[17] = 0;
                    battle = 1;
                }
                while (battle = 70 && vara[17] = 0) {
                    render();
                    showplayerinfo();
                    showsels();
                    if (spellbasetype[spellused] = 2) {
                        showsels2();
                        temp[901] = nummon;
                    }
                    if (spellbasetype[spellused] = 1) {
                        showpartyselections();
                        temp[901] = numchars;
                    }
                    showpage();
                    target = menupnt[102];
                    updatecontrols();
                    if (key[80]) {
                        menupnt[102]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[102]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[77]) {
                        menupnt[102]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[75]) {
                        menupnt[102]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[102] < 1) { menupnt[102] = temp[901]; }
                    if (menupnt[102] > temp[901]) {
                        menupnt[102] = 1;
                    }
                    if (key[28]) {
                        unpress(key[28]);
                        battle = 71;
                        while (battle = 71) {
                            render();
                            Tcopysprite(200, screeny - 97, 96, 96,
                                charpic[inparty[playerturn]]);
                            TCopySprite(300, screeny - 65, 320, 64, textbox);
                            gotoxy(305, 420);
                            printstring(1, charname[inparty[playerturn]] + ":");
                            gotoxy(305, 440);
                            if (spellbasetype[spellused] = 2) {
                                attackspelltalk();
                                if (chargrazy[inparty[playerturn]] = 1) {
                                    target = random(nummon);
                                    if (target = 0) {
                                        target = 1;
                                    }
                                }
                            }
                            if (spellbasetype[spellused] = 1) {
                                healspelltalk();
                                if (chargrazy[inparty[playerturn]] = 1) {
                                    target = random(numchars);
                                    if (target = 0) {
                                        target = 1;
                                    }
                                }
                            }
                            showpage();
                            updatecontrols();
                            if (key[28]) {
                                music_volume = 90;
                                wait(2);
                                music_volume = 80;
                                wait(2);
                                music_volume = 70;
                                wait(2);
                                castspell();
                                music_volume = 80;
                                wait(2);
                                music_volume = 90;
                                wait(2);
                                music_volume = 100;
                                if (spellbasetype[spellused] = 2) {
                                    if (deadmon[target] = 1) {
                                        entity.specframe[battlemonster[target]] =
                                            0;
                                    }
                                    if (deadmon[target] = 0) {
                                        entity.specframe[battlemonster[target]] =
                                            7;
                                    }
                                }
                                if (spellbasetype[spellused] = 1) {
                                    if (deadchar[playerturn] = 1) {
                                        entity.specframe[battlechar[playerturn]] =
                                            0;
                                    }
                                    if (deadchar[playerturn] = 0) {
                                        entity.specframe[battlechar[playerturn]] =
                                            7;
                                    }
                                }
                                if (charpoisoned[inparty[playerturn]] = 1) {
                                    battle = 51;
                                    while (battle = 51) {
                                        render();
                                        TCopySprite(300, screeny - 65, 320, 64,
                                            textbox);
                                        gotoxy(305, 440);
                                        printstring(
                                            1, "   Poison takes effect!!");
                                        showsels();
                                        showpage();
                                        updatecontrols();
                                        if (key[28]) {
                                            unpress(key[28]);
                                            poisoned();
                                            battle = 50;
                                        }
                                    }
                                }
                                playerturn = playerturn + 1;
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (playerturn > numchars) {
                                    if (battletype = 1) {
                                        battle = 0;
                                        playerturn = 0;
                                        enemyturn = 1;
                                        render();
                                        enemyattack();
                                    }
                                    if (battletype = 2) {
                                        playerturn = 0;
                                        enemyturn = 1;
                                        render();
                                        enemyattack();
                                    }
                                    if (battletype = 3) {
                                        if (once = 0) {
                                            round = round + 1;
                                            rounds = str(round);
                                            if (deadchar[1] = 1) {
                                                playerturn = 1;
                                            }
                                            if (deadchar[1] = 0 && deadchar[2] =
                                                                  1) {
                                                playerturn = 2;
                                            }
                                            if (deadchar[1] =
                                                    0 && deadchar[2] =
                                                        0 && deadchar[3] = 1) {
                                                playerturn = 3;
                                            }
                                            if (deadchar[1] =
                                                    0 && deadchar[2] =
                                                        0 && deadchar[3] =
                                                            0 && deadchar[4] =
                                                                1) {
                                                playerturn = 4;
                                            }
                                            render();
                                            once = 1;
                                            battleselections();
                                        }
                                        if (once = 1) {
                                            playerturn = 0;
                                            enemyturn = 1;
                                            render();
                                            enemyattack();
                                        }
                                    }
                                }
                                render();
                                battleselections();
                            }
                        }
                    }
                }
            }
            if (menupnt[100] = 7) {
                if (humanboss = 0) {
                    temp[2001] = 0;
                    temp[2001] = temp[2001] + random(50);
                    if (vara[16] = 0) {
                        temp[2010] = random(100);
                    }
                    if (vara[16] = 1) {
                        temp[2010] = random(90);
                    }
                    if (vara[16] = 2) {
                        temp[2010] = random(80);
                    }
                    if (vara[16] = 3) {
                        temp[2010] = random(70);
                    }
                    if (vara[15] = 1) {
                        temp[2010] = 10;
                        vara[15] = 0;
                    }
                    vara[16] = vara[16] + 1;
                    unpress(key[28]);
                    battle = 20;
                    if (temp[2010] < 70) {
                        while (battle = 20) {
                            render();
                            Tcopysprite(200, screeny - 97, 96, 96,
                                charpic[inparty[playerturn]]);
                            TCopySprite(300, screeny - 65, 320, 64, textbox);
                            gotoxy(305, 420);
                            printstring(1, charname[inparty[playerturn]] + ":");
                            gotoxy(305, 440);
                            runtalk();
                            showsels();
                            showpage();
                            updatecontrols();
                            if (key[28]) {
                                fadeout(50, 50);
                                musicfade(5);
                                wait(50);
                                frombattle = 1;
                                vara[30] = 0;
                                vara[16] = 0;
                                forceret = 1;
                                regroup = 0;
                                for (x = 1; x < numchars2; x++) {
                                    strongpoison[inparty[x]] = 0;
                                }
                                playmusic("sil.s3m");
                                mapswitch(mappi, 0, 0, 0);
                            }
                        }
                    }
                    ELSE {
                        unpress(key[28]);
                        while (battle = 20) {
                            render();
                            TCopySprite(300, screeny - 65, 320, 64, textbox);
                            gotoxy(305, 420);
                            printstring(1, "Couldn't run away!!");
                            showsels();
                            showpage();
                            updatecontrols();
                            if (key[28]) {
                                battle = 0;
                                playerturn = 0;
                                enemyturn = 1;
                                render();
                                enemyattack();
                            }
                        }
                    }
                }
                if (humanboss = 1) {
                    unpress(key[28]);
                    battle = 20;
                    while (battle = 20) {
                        render();
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, "Can't run away!!");
                        showsels();
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            playerturn = playerturn + 1;
                            if (deadchar[playerturn] = 0) {
                                playerturn = playerturn + 1;
                            }
                            if (deadchar[playerturn] = 0) {
                                playerturn = playerturn + 1;
                            }
                            if (deadchar[playerturn] = 0) {
                                playerturn = playerturn + 1;
                            }
                            if (deadchar[playerturn] = 0) {
                                playerturn = playerturn + 1;
                            }
                            if (deadchar[playerturn] = 0) {
                                playerturn = playerturn + 1;
                            }
                            if (deadchar[playerturn] = 0) {
                                playerturn = playerturn + 1;
                            }
                            if (deadchar[playerturn] = 0) {
                                playerturn = playerturn + 1;
                            }
                            if (playerturn > numchars) {
                                if (battletype = 1) {
                                    battle = 0;
                                    playerturn = 0;
                                    enemyturn = 1;
                                    render();
                                    enemyattack();
                                }
                                if (battletype = 2) {
                                    playerturn = 0;
                                    enemyturn = 1;
                                    render();
                                    enemyattack();
                                }
                                if (battletype = 3) {
                                    if (once = 0) {
                                        round = round + 1;
                                        rounds = str(round);
                                        if (deadchar[1] = 1) {
                                            playerturn = 1;
                                        }
                                        if (deadchar[1] = 0 && deadchar[2] =
                                                              1) {
                                            playerturn = 2;
                                        }
                                        if (deadchar[1] = 0 && deadchar[2] =
                                                              0 && deadchar[3] =
                                                                  1) {
                                            playerturn = 3;
                                        }
                                        if (deadchar[1] =
                                                0 && deadchar[2] =
                                                    0 && deadchar[3] =
                                                        0 && deadchar[4] = 1) {
                                            playerturn = 4;
                                        }
                                        render();
                                        once = 1;
                                        battleselections();
                                    }
                                    if (once = 1) {
                                        playerturn = 0;
                                        enemyturn = 1;
                                        render();
                                        enemyattack();
                                    }
                                }
                            }
                            render();
                            battleselections();
                        }
                    }
                }
            }

            if (menupnt[100] = 1) {
                unpress(key[28]);
                battle = 2;
                render();
                menupnt[102] = 1;
                while (battle = 2) {
                    render();
                    showplayerinfo();
                    showsels();
                    showsels2();
                    showpage();
                    target = menupnt[102];
                    updatecontrols();
                    if (key[80]) {
                        menupnt[102]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[102]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[77]) {
                        menupnt[102]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[75]) {
                        menupnt[102]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[102] < 1) { menupnt[102] = nummon; }
                    if (menupnt[102] > nummon) {
                        menupnt[102] = 1;
                    }
                    if (key[28]) {
                        unpress(key[28]);
                        battle = 50;
                        temp[2001] = 0;
                        temp[2001] = temp[2001] + random(50);
                        while (battle = 50) {
                            render();
                            Tcopysprite(200, screeny - 97, 96, 96,
                                charpic[inparty[playerturn]]);
                            TCopySprite(300, screeny - 65, 320, 64, textbox);
                            gotoxy(305, 420);
                            printstring(1, charname[inparty[playerturn]] + ":");
                            gotoxy(305, 440);
                            attacktalk();
                            showsels();
                            showpage();
                            updatecontrols();
                            if (key[28]) {
                                if (chargrazy[inparty[playerturn]] = 1) {
                                    target = random(nummon);
                                    if (target = 0) {
                                        target = 1;
                                    }
                                }
                                attack();
                                if (deadmon[target] = 1) {
                                    entity.specframe[battlemonster[target]] = 0;
                                }
                                if (deadmon[target] = 0) {
                                    entity.specframe[battlemonster[target]] = 7;
                                }
                                if (deadchar[playerturn] = 1) {
                                    entity.specframe[battlechar[playerturn]] =
                                        0;
                                }
                                if (deadchar[playerturn] = 0) {
                                    entity.specframe[battlechar[playerturn]] =
                                        7;
                                }
                                if (charpoisoned[inparty[playerturn]] = 1) {
                                    battle = 51;
                                    while (battle = 51) {
                                        render();
                                        TCopySprite(300, screeny - 65, 320, 64,
                                            textbox);
                                        gotoxy(305, 440);
                                        printstring(
                                            1, "   Poison takes effect!!");
                                        showsels();
                                        showpage();
                                        updatecontrols();
                                        if (key[28]) {
                                            unpress(key[28]);
                                            poisoned();
                                            battle = 50;
                                        }
                                    }
                                }
                                playerturn = playerturn + 1;
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (deadchar[playerturn] = 0) {
                                    playerturn = playerturn + 1;
                                }
                                if (playerturn > numchars) {
                                    if (battletype = 1) {
                                        playerturn = 0;
                                        enemyturn = 1;
                                        render();
                                        enemyattack();
                                    }
                                    if (battletype = 2) {
                                        playerturn = 0;
                                        enemyturn = 1;
                                        render();
                                        enemyattack();
                                    }
                                    if (battletype = 3) {
                                        if (once = 0) {
                                            round = round + 1;
                                            rounds = str(round);
                                            if (deadchar[1] = 1) {
                                                playerturn = 1;
                                            }
                                            if (deadchar[1] = 0 && deadchar[2] =
                                                                  1) {
                                                playerturn = 2;
                                            }
                                            if (deadchar[1] =
                                                    0 && deadchar[2] =
                                                        0 && deadchar[3] = 1) {
                                                playerturn = 3;
                                            }
                                            if (deadchar[1] =
                                                    0 && deadchar[2] =
                                                        0 && deadchar[3] =
                                                            0 && deadchar[4] =
                                                                1) {
                                                playerturn = 4;
                                            }
                                            render();
                                            once = 1;
                                            battleselections();
                                        }
                                        if (once = 1) {
                                            playerturn = 0;
                                            enemyturn = 1;
                                            render();
                                            enemyattack();
                                        }
                                    }
                                }
                                render();
                                battleselections();
                            }
                        }
                    }
                    if (key[29]) {
                        entity.specframe[battlemonster[target]] = 0;
                        battle = 1;
                        render();
                        battleselections();
                    }
                }
            }
        }
    }
}
void showplayerinfo() {
    rounds = str(round);
    gotoxy(250, 10);
    printstring(1, "Round: " + rounds);
    monspirit = str(monsterspirit);
    partspirit = str(partyspirit);
    gotoxy(10, 10);
    printstring(1, "Spirit: " + monspirit);
    gotoxy(500, 10);
    printstring(1, "Spirit: " + partspirit);
    for (x = 1; x < numchars2; x++) {
        if (defend[x] = 1) {
            entity.specframe[battlechar[x]] = 8;
        }
    }
    if (inparty[1] > 0) {
        if (playerturn = 1) {
            gotoxy(200, 400);
            printstring(font2, charname[inparty[1]]);
        }
        ELSE {
            gotoxy(200, 400);
            printstring(font, charname[inparty[1]]);
        }
        gotoxy(200, 410);
        printstring(font,
            "HP: " + battlehp[inparty[1]] + " / " + battlemaxhp[inparty[1]]);
        gotoxy(200, 420);
        printstring(font,
            "MP: " + battlemp[inparty[1]] + " / " + battlemaxmp[inparty[1]]);
    }
    if (inparty[2] > 0) {
        if (playerturn = 2) {
            gotoxy(200, 440);
            printstring(font2, charname[inparty[2]]);
        }
        ELSE {
            gotoxy(200, 440);
            printstring(font, charname[inparty[2]]);
        }
        gotoxy(200, 450);
        printstring(font,
            "HP: " + battlehp[inparty[2]] + " / " + battlemaxhp[inparty[2]]);
        gotoxy(200, 460);
        printstring(font,
            "MP: " + battlemp[inparty[2]] + " / " + battlemaxmp[inparty[2]]);
    }
    if (inparty[3] > 0) {
        if (playerturn = 3) {
            gotoxy(300, 400);
            printstring(font2, charname[inparty[3]]);
        }
        ELSE {
            gotoxy(300, 400);
            printstring(font, charname[inparty[3]]);
        }
        gotoxy(300, 410);
        printstring(font,
            "HP: " + battlehp[inparty[3]] + " / " + battlemaxhp[inparty[3]]);
        gotoxy(300, 420);
        printstring(font,
            "MP: " + battlemp[inparty[3]] + " / " + battlemaxmp[inparty[3]]);
    }
    if (inparty[4] > 0) {
        if (playerturn = 4) {
            gotoxy(300, 440);
            printstring(font2, charname[inparty[4]]);
        }
        ELSE {
            gotoxy(300, 440);
            printstring(font, charname[inparty[4]]);
        }
        gotoxy(300, 450);
        printstring(font,
            "HP: " + battlehp[inparty[4]] + " / " + battlemaxhp[inparty[4]]);
        gotoxy(300, 460);
        printstring(font,
            "MP: " + battlemp[inparty[4]] + " / " + battlemaxmp[inparty[4]]);
    }
    if (inparty[5] > 0) {
        if (playerturn = 5) {
            gotoxy(400, 400);
            printstring(font2, charname[inparty[5]]);
        }
        ELSE {
            gotoxy(400, 400);
            printstring(font, charname[inparty[5]]);
        }
        gotoxy(400, 410);
        printstring(font,
            "HP: " + battlehp[inparty[5]] + " / " + battlemaxhp[inparty[5]]);
        gotoxy(400, 420);
        printstring(font,
            "MP: " + battlemp[inparty[5]] + " / " + battlemaxmp[inparty[5]]);
    }
    if (inparty[6] > 0) {
        if (playerturn = 6) {
            gotoxy(400, 440);
            printstring(font2, charname[inparty[6]]);
        }
        ELSE {
            gotoxy(400, 440);
            printstring(font, charname[inparty[6]]);
        }
        gotoxy(400, 450);
        printstring(font,
            "HP: " + battlehp[inparty[6]] + " / " + battlemaxhp[inparty[6]]);
        gotoxy(400, 460);
        printstring(font,
            "MP: " + battlemp[inparty[6]] + " / " + battlemaxmp[inparty[6]]);
    }
    if (inparty[7] > 0) {
        if (playerturn = 7) {
            gotoxy(500, 400);
            printstring(font2, charname[inparty[7]]);
        }
        ELSE {
            gotoxy(500, 400);
            printstring(font, charname[inparty[7]]);
        }
        gotoxy(500, 410);
        printstring(font,
            "HP: " + battlehp[inparty[7]] + " / " + battlemaxhp[inparty[7]]);
        gotoxy(500, 420);
        printstring(font,
            "MP: " + battlemp[inparty[7]] + " / " + battlemaxmp[inparty[7]]);
    }
    if (inparty[8] > 0) {
        if (playerturn = 8) {
            gotoxy(500, 440);
            printstring(font2, charname[inparty[8]]);
        }
        ELSE {
            gotoxy(500, 440);
            printstring(font, charname[inparty[8]]);
        }
        gotoxy(500, 450);
        printstring(font,
            "HP: " + battlehp[inparty[8]] + " / " + battlemaxhp[inparty[8]]);
        gotoxy(500, 460);
        printstring(font,
            "MP: " + battlemp[inparty[8]] + " / " + battlemaxmp[inparty[8]]);
    }
}
void showsels() {
    switch (menupnt[100]) {
    case 1:
        Gotoxy(10, 400);
        printstring(font2, "Attack");
        Gotoxy(10, 410);
        printstring(font, "Magic");
        Gotoxy(10, 420);
        printstring(font, "Item");
        Gotoxy(10, 430);
        printstring(font, "Skill");
        Gotoxy(10, 440);
        printstring(font, "Defend");
        Gotoxy(10, 450);
        printstring(font, "Status");
        Gotoxy(10, 460);
        printstring(font, "Run");

    case 2:
        Gotoxy(10, 400);
        printstring(font, "Attack");
        Gotoxy(10, 410);
        printstring(font2, "Magic");
        Gotoxy(10, 420);
        printstring(font, "Item");
        Gotoxy(10, 430);
        printstring(font, "Skill");
        Gotoxy(10, 440);
        printstring(font, "Defend");
        Gotoxy(10, 450);
        printstring(font, "Status");
        Gotoxy(10, 460);
        printstring(font, "Run");

    case 3:
        Gotoxy(10, 400);
        printstring(font, "Attack");
        Gotoxy(10, 410);
        printstring(font, "Magic");
        Gotoxy(10, 420);
        printstring(font2, "Item");
        Gotoxy(10, 430);
        printstring(font, "Skill");
        Gotoxy(10, 440);
        printstring(font, "Defend");
        Gotoxy(10, 450);
        printstring(font, "Status");
        Gotoxy(10, 460);
        printstring(font, "Run");

    case 4:
        Gotoxy(10, 400);
        printstring(font, "Attack");
        Gotoxy(10, 410);
        printstring(font, "Magic");
        Gotoxy(10, 420);
        printstring(font, "Item");
        Gotoxy(10, 430);
        printstring(font2, "Skill");
        Gotoxy(10, 440);
        printstring(font, "Defend");
        Gotoxy(10, 450);
        printstring(font, "Status");
        Gotoxy(10, 460);
        printstring(font, "Run");

    case 5:
        Gotoxy(10, 400);
        printstring(font, "Attack");
        Gotoxy(10, 410);
        printstring(font, "Magic");
        Gotoxy(10, 420);
        printstring(font, "Item");
        Gotoxy(10, 430);
        printstring(font, "Skill");
        Gotoxy(10, 440);
        printstring(font2, "Defend");
        Gotoxy(10, 450);
        printstring(font, "Status");
        Gotoxy(10, 460);
        printstring(font, "Run");

    case 6:
        Gotoxy(10, 400);
        printstring(font, "Attack");
        Gotoxy(10, 410);
        printstring(font, "Magic");
        Gotoxy(10, 420);
        printstring(font, "Item");
        Gotoxy(10, 430);
        printstring(font, "Skill");
        Gotoxy(10, 440);
        printstring(font, "Defend");
        Gotoxy(10, 450);
        printstring(font2, "Status");
        Gotoxy(10, 460);
        printstring(font, "Run");
    case 7:
        Gotoxy(10, 400);
        printstring(font, "Attack");
        Gotoxy(10, 410);
        printstring(font, "Magic");
        Gotoxy(10, 420);
        printstring(font, "Item");
        Gotoxy(10, 430);
        printstring(font, "Skill");
        Gotoxy(10, 440);
        printstring(font, "Defend");
        Gotoxy(10, 450);
        printstring(font, "Status");
        Gotoxy(10, 460);
        printstring(font2, "Run");
    }
}
void showsels2() {
    if (nummon = 1) {
        switch (menupnt[102]) {
        case 1:
            Gotoxy(100, 400);
            printstring(font2, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 1;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 6;
            }
        }
    }
    if (nummon = 2) {
        switch (menupnt[102]) {
        case 1:
            Gotoxy(100, 400);
            printstring(font2, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 1;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 6;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
        case 2:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }

            Gotoxy(100, 410);
            printstring(font2, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 1;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 6;
            }
        }
    }
    if (nummon = 3) {
        switch (menupnt[102]) {
        case 1:
            Gotoxy(100, 400);
            printstring(font2, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 1;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 6;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }

        case 2:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }

            Gotoxy(100, 410);
            printstring(font2, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 1;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 6;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }

        case 3:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }

            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font2, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 1;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 6;
            }
        }
    }
    if (nummon = 4) {
        switch (menupnt[102]) {
        case 1:
            Gotoxy(100, 400);
            printstring(font2, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 1;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 6;
            }

            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }

            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

        case 2:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }

            Gotoxy(100, 410);
            printstring(font2, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 1;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 6;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }

            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

        case 3:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }

            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font2, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 1;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 6;
            }

            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

        case 4:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }

            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }

            Gotoxy(100, 430);
            printstring(font2, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 1;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 6;
            }
        }
    }
    if (nummon = 5) {
        switch (menupnt[102]) {
        case 1:
            Gotoxy(100, 400);
            printstring(font2, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 1;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 6;
            }

            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }

        case 2:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font2, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 1;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 6;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
        case 3:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font2, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 1;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 6;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
        case 4:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font2, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 1;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 6;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
        case 5:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font2, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 1;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 6;
            }
        }
    }
    if (nummon = 6) {
        switch (menupnt[102]) {
        case 1:
            Gotoxy(100, 400);
            printstring(font2, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 1;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 6;
            }

            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }

        case 2:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font2, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 1;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 6;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }

        case 3:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font2, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 1;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 6;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }

        case 4:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font2, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 1;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 6;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }

        case 5:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font2, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 1;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 6;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
        case 6:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font2, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 1;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 6;
            }
        }
    }
    if (nummon = 7) {
        switch (menupnt[102]) {
        case 1:
            Gotoxy(100, 400);
            printstring(font2, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 1;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 6;
            }

            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }

            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }

        case 2:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font2, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 1;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 6;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }

        case 3:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font2, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 1;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 6;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }

        case 4:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font2, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 1;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 6;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }

        case 5:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font2, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 1;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 6;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }

        case 6:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font2, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 1;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 6;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }
        case 7:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font2, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 1;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 6;
            }
        }
    }
    if (nummon = 8) {
        switch (menupnt[102]) {
        case 1:
            Gotoxy(100, 400);
            printstring(font2, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 1;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 6;
            }

            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }
            Gotoxy(100, 470);
            printstring(font, monstername[8]);
            if (deadmon[8] = 1) {
                entity.specframe[battlemonster[8]] = 0;
            }
            if (deadmon[8] = 0) {
                entity.specframe[battlemonster[8]] = 7;
            }

        case 2:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font2, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 1;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 6;
            }

            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }
            Gotoxy(100, 470);
            printstring(font, monstername[8]);
            if (deadmon[8] = 1) {
                entity.specframe[battlemonster[8]] = 0;
            }
            if (deadmon[8] = 0) {
                entity.specframe[battlemonster[8]] = 7;
            }
        case 3:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font2, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 1;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 6;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }

            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }
            Gotoxy(100, 470);
            printstring(font, monstername[8]);
            if (deadmon[8] = 1) {
                entity.specframe[battlemonster[8]] = 0;
            }
            if (deadmon[8] = 0) {
                entity.specframe[battlemonster[8]] = 7;
            }
        case 4:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font2, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 1;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 6;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }
            Gotoxy(100, 470);
            printstring(font, monstername[8]);
            if (deadmon[8] = 1) {
                entity.specframe[battlemonster[8]] = 0;
            }
            if (deadmon[8] = 0) {
                entity.specframe[battlemonster[8]] = 7;
            }
        case 5:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font2, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 1;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 6;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }
            Gotoxy(100, 470);
            printstring(font, monstername[8]);
            if (deadmon[8] = 1) {
                entity.specframe[battlemonster[8]] = 0;
            }
            if (deadmon[8] = 0) {
                entity.specframe[battlemonster[8]] = 7;
            }
        case 6:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font2, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 1;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 6;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }
            Gotoxy(100, 470);
            printstring(font, monstername[8]);
            if (deadmon[8] = 1) {
                entity.specframe[battlemonster[8]] = 0;
            }
            if (deadmon[8] = 0) {
                entity.specframe[battlemonster[8]] = 7;
            }
        case 7:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font2, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 1;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 6;
            }
            Gotoxy(100, 470);
            printstring(font, monstername[8]);
            if (deadmon[8] = 1) {
                entity.specframe[battlemonster[8]] = 0;
            }
            if (deadmon[8] = 0) {
                entity.specframe[battlemonster[8]] = 7;
            }
        case 8:
            Gotoxy(100, 400);
            printstring(font, monstername[1]);
            if (deadmon[1] = 1) {
                entity.specframe[battlemonster[1]] = 0;
            }
            if (deadmon[1] = 0) {
                entity.specframe[battlemonster[1]] = 7;
            }
            Gotoxy(100, 410);
            printstring(font, monstername[2]);
            if (deadmon[2] = 1) {
                entity.specframe[battlemonster[2]] = 0;
            }
            if (deadmon[2] = 0) {
                entity.specframe[battlemonster[2]] = 7;
            }
            Gotoxy(100, 420);
            printstring(font, monstername[3]);
            if (deadmon[3] = 1) {
                entity.specframe[battlemonster[3]] = 0;
            }
            if (deadmon[3] = 0) {
                entity.specframe[battlemonster[3]] = 7;
            }
            Gotoxy(100, 430);
            printstring(font, monstername[4]);
            if (deadmon[4] = 1) {
                entity.specframe[battlemonster[4]] = 0;
            }
            if (deadmon[4] = 0) {
                entity.specframe[battlemonster[4]] = 7;
            }
            Gotoxy(100, 440);
            printstring(font, monstername[5]);
            if (deadmon[5] = 1) {
                entity.specframe[battlemonster[5]] = 0;
            }
            if (deadmon[5] = 0) {
                entity.specframe[battlemonster[5]] = 7;
            }
            Gotoxy(100, 450);
            printstring(font, monstername[6]);
            if (deadmon[6] = 1) {
                entity.specframe[battlemonster[6]] = 0;
            }
            if (deadmon[6] = 0) {
                entity.specframe[battlemonster[6]] = 7;
            }
            Gotoxy(100, 460);
            printstring(font, monstername[7]);
            if (deadmon[7] = 1) {
                entity.specframe[battlemonster[7]] = 0;
            }
            if (deadmon[7] = 0) {
                entity.specframe[battlemonster[7]] = 7;
            }
            Gotoxy(100, 470);
            printstring(font2, monstername[8]);
            if (deadmon[8] = 1) {
                entity.specframe[battlemonster[8]] = 1;
            }
            if (deadmon[8] = 0) {
                entity.specframe[battlemonster[8]] = 6;
            }
        }
    }
}

void monsternames() {
    For(x = 1; x < nummon2; x++) {
        if (mongroup = 2) {
            switch (inbatmon[x]) {
            case 0:
                monstername[x] = "Scorpion";
            case 1:
                monstername[x] = "Shell";
            }
        }
        if (mongroup = 1) {
            switch (inbatmon[x]) {
            case 0:
                monstername[x] = "Ooze";
            case 1:
                monstername[x] = "Spider";
            case 2:
                monstername[x] = "Parasite";
            case 3:
                monstername[x] = "Sewer rat";
            case 4:
                monstername[x] = "Skhisnak";
            case 5:
                monstername[x] = "Freuden";
            case 6:
                monstername[x] = "Gangmember";
            }
        }
        if (mongroup = 3) {
            switch (inbatmon[x]) {
            case 0:
                monstername[x] = "Red slime";
            case 1:
                monstername[x] = "Giantspider";
            case 2:
                monstername[x] = "Leech";
            case 3:
                monstername[x] = "Bat";
            case 4:
                monstername[x] = "Goblin leader";
            case 5:
                monstername[x] = "Freuden";
            case 6:
                monstername[x] = "Goblin warrior";
            case 7:
                monstername[x] = "Goblin archer";
            case 8:
                monstername[x] = "Goblin leader";
            case 9:
                monstername[x] = "Octoma";
            case 10:
                monstername[x] = "Oggruck";
            case 11:
                monstername[x] = "Jackalwere";
            case 12:
                monstername[x] = "Arma Gatza";
            }
        }
    }
}
void loadbattlestats() {
    For(x = 1; x < numchars2; x++) {
        if (inparty[x] > 0) {
            battlename[inparty[x]] = charname[inparty[x]];
            battlehp[inparty[x]] = str(chahp[inparty[x]]);
            battlemaxhp[inparty[x]] = str(chamaxhp[inparty[x]]);
            battlemp[inparty[x]] = str(champ[inparty[x]]);
            battlemaxmp[inparty[x]] = str(chamaxmp[inparty[x]]);
        }
    }
    For(x = 1; x < nummon2; x++) {
        if (inbatmon[x] > 0) {
            battlemonstername[x] = monstername[x];
            batmonsterhp[x] = str(monsterhp[x]);
            batmonstermaxhp[x] = str(monstermaxhp[x]);
            batmonstermp[x] = str(monstermp[x]);
            batmonstermaxmp[x] = str(monstermaxmp[x]);
        }
    }
}
void attack() {
    if (playerturn = 1) {
        if (deadchar[1] = 1) {
            if (playerturn = 1 && inparty[1] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[1]] = 1;
            wait(10);
            if (weapontype[equippedweapon[inparty[playerturn]]] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[1]] = 2;
            wait(10);
            entity.specframe[battlechar[1]] = 3;
            if (weapontype[equippedweapon[inparty[playerturn]]] = 1) {
                wait(10);
                entity.specframe[battlechar[1]] = 4;
                wait(10);
                entity.specframe[battlechar[1]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                wait(10);
                entity.specframe[battlechar[1]] = 4;
                wait(10);
                entity.specframe[battlechar[1]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 10) {
                playsound(battleeffect[1], 64, 128);
                wait(10);
                entity.specframe[battlechar[1]] = 4;
                wait(10);
                entity.specframe[battlechar[1]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 11) {
                wait(10);
                entity.specframe[battlechar[1]] = 4;
                wait(50);
                entity.specframe[battlechar[1]] = 5;
                playsound(battleeffect[4], 64, 128);
                wait(15);
                playsound(battleeffect[1], 64, 128);
            }
            wait(1);
            if (deadmon[target] = 1) {
                if (chargrazy[inparty[playerturn]] = 0) {
                    entity.specframe[battlemonster[target]] = 8;
                }
                if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                    entity.specframe[battlemonster[target]] = 8;
                }
            }
            wait(9);
            entity.specframe[battlechar[1]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                if (chargrazy[inparty[playerturn]] = 0) {
                    entity.specframe[battlemonster[target]] = 9;
                }
                if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                    entity.specframe[battlemonster[target]] = 8;
                }
            }
            wait(9);
            if (chargrazy[inparty[playerturn]] = 0) {
                damages();
            }
            if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                damages();
            }
            if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 2) {
                grazydamages();
            }
        }
    }
    if (playerturn = 2) {
        if (deadchar[2] = 1) {
            if (playerturn = 2 && inparty[2] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[2]] = 1;
            wait(10);
            if (weapontype[equippedweapon[inparty[playerturn]]] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[2]] = 2;
            wait(10);
            entity.specframe[battlechar[2]] = 3;
            if (weapontype[equippedweapon[inparty[playerturn]]] = 1) {
                wait(10);
                entity.specframe[battlechar[2]] = 4;
                wait(10);
                entity.specframe[battlechar[2]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                wait(10);
                entity.specframe[battlechar[playerturn]] = 4;
                wait(10);
                entity.specframe[battlechar[playerturn]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 10) {
                playsound(battleeffect[1], 64, 128);
                wait(10);
                entity.specframe[battlechar[2]] = 4;
                wait(10);
                entity.specframe[battlechar[2]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 11) {
                wait(10);
                entity.specframe[battlechar[2]] = 4;
                wait(50);
                entity.specframe[battlechar[2]] = 5;
                playsound(battleeffect[4], 64, 128);
                wait(15);
                playsound(battleeffect[1], 64, 128);
            }
            wait(1);
            if (deadmon[target] = 1) {

                if (chargrazy[inparty[playerturn]] = 0) {
                    entity.specframe[battlemonster[target]] = 8;
                }
                if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                    entity.specframe[battlemonster[target]] = 8;
                }
            }
            wait(9);
            entity.specframe[battlechar[2]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                if (chargrazy[inparty[playerturn]] = 0) {
                    entity.specframe[battlemonster[target]] = 9;
                }
                if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                    entity.specframe[battlemonster[target]] = 9;
                }
            }
            wait(9);
            if (chargrazy[inparty[playerturn]] = 0) {
                damages();
            }
            if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 2) {
                grazydamages();
            }
            if (chargrazy[inparty[playerturn]] = 0 && temp[2003] = 1) {
                damages();
            }
        }
    }
    if (playerturn = 3) {
        if (deadchar[3] = 1) {
            if (playerturn = 3 && inparty[3] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[3]] = 1;
            wait(10);
            if (weapontype[equippedweapon[inparty[playerturn]]] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[3]] = 2;
            wait(10);
            entity.specframe[battlechar[3]] = 3;
            if (weapontype[equippedweapon[inparty[playerturn]]] = 1) {
                wait(10);
                entity.specframe[battlechar[3]] = 4;
                wait(10);
                entity.specframe[battlechar[3]] = 5;
            }

            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                wait(10);
                entity.specframe[battlechar[playerturn]] = 4;
                wait(10);
                entity.specframe[battlechar[playerturn]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 10) {
                playsound(battleeffect[1], 64, 128);
                wait(10);
                entity.specframe[battlechar[3]] = 4;
                wait(10);
                entity.specframe[battlechar[3]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 11) {
                wait(10);
                entity.specframe[battlechar[3]] = 4;
                wait(50);
                entity.specframe[battlechar[3]] = 5;
                playsound(battleeffect[4], 64, 128);
                wait(15);
                playsound(battleeffect[1], 64, 128);
            }
            wait(1);
            if (deadmon[target] = 1) {
                if (chargrazy[inparty[playerturn]] = 0) {
                    entity.specframe[battlemonster[target]] = 8;
                }
                if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                    entity.specframe[battlemonster[target]] = 8;
                }
            }
            wait(9);
            entity.specframe[battlechar[3]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                if (chargrazy[inparty[playerturn]] = 0) {
                    entity.specframe[battlemonster[target]] = 9;
                }
                if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                    entity.specframe[battlemonster[target]] = 9;
                }
            }
            wait(9);

            if (chargrazy[inparty[playerturn]] = 0) {
                damages();
            }
            if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                damages();
            }
            if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 2) {
                grazydamages();
            }
        }
    }
    if (playerturn = 4) {
        if (deadchar[4] = 1) {
            if (playerturn = 4 && inparty[4] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[4]] = 1;
            wait(10);
            if (weapontype[equippedweapon[inparty[playerturn]]] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[4]] = 2;
            wait(10);
            entity.specframe[battlechar[4]] = 3;
            if (weapontype[equippedweapon[inparty[playerturn]]] = 1) {
                wait(10);
                entity.specframe[battlechar[4]] = 4;
                wait(10);
                entity.specframe[battlechar[4]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 10) {
                playsound(battleeffect[1], 64, 128);
                wait(10);
                entity.specframe[battlechar[4]] = 4;
                wait(10);
                entity.specframe[battlechar[4]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                wait(10);
                entity.specframe[battlechar[playerturn]] = 4;
                wait(10);
                entity.specframe[battlechar[playerturn]] = 5;
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 11) {
                wait(10);
                entity.specframe[battlechar[4]] = 4;
                wait(50);
                entity.specframe[battlechar[4]] = 5;
                playsound(battleeffect[4], 64, 128);
                wait(15);
                playsound(battleeffect[1], 64, 128);
            }
            wait(1);
            if (deadmon[target] = 1) {

                if (chargrazy[inparty[playerturn]] = 0) {
                    entity.specframe[battlemonster[target]] = 8;
                }
                if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                    entity.specframe[battlemonster[target]] = 8;
                }
            }
            wait(9);
            entity.specframe[battlechar[4]] = 0;
            wait(1);
            if (deadmon[target] = 1) {

                if (chargrazy[inparty[playerturn]] = 0) {
                    entity.specframe[battlemonster[target]] = 9;
                }
                if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                    entity.specframe[battlemonster[target]] = 9;
                }
            }
            wait(9);
            if (chargrazy[inparty[playerturn]] = 0) {
                damages();
            }
            if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 1) {
                damages();
            }
            if (chargrazy[inparty[playerturn]] = 1 && temp[2003] = 2) {
                grazydamages();
            }
        }
    }

    if (playerturn = 5) {
        if (deadchar[5] = 1) {
            if (playerturn = 5 && inparty[5] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[5]] = 1;
            wait(10);
            if (playerturn = 5 && inparty[5] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[5]] = 2;
            wait(10);
            entity.specframe[battlechar[5]] = 3;
            if (inparty[playerturn] = 4) {
                wait(10);
                entity.specframe[battlechar[5]] = 4;
                wait(50);
                entity.specframe[battlechar[5]] = 5;
                if (playerturn = 5 && inparty[5] = 4) {
                    playsound(battleeffect[4], 64, 128);
                }
                wait(15);
                if (playerturn = 5 && inparty[5] = 4) {
                    playsound(battleeffect[1], 64, 128);
                }
            }

            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 8;
            }
            wait(9);
            entity.specframe[battlechar[5]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 9;
            }
            wait(9);
            damages();
        }
    }
    if (playerturn = 6) {
        if (deadchar[6] = 1) {
            if (playerturn = 6 && inparty[6] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[6]] = 1;
            wait(10);
            if (playerturn = 6 && inparty[6] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[6]] = 2;
            wait(10);
            entity.specframe[battlechar[6]] = 3;
            if (inparty[playerturn] = 6) {
                if (playerturn = 6 && inparty[6] = 6) {
                    playsound(battleeffect[1], 64, 128);
                }
                wait(10);
                entity.specframe[battlechar[6]] = 4;
                wait(10);
                entity.specframe[battlechar[6]] = 5;
            }
            if (inparty[playerturn] = 4) {
                wait(10);
                entity.specframe[battlechar[6]] = 4;
                wait(50);
                entity.specframe[battlechar[6]] = 5;
                if (playerturn = 6 && inparty[6] = 4) {
                    playsound(battleeffect[4], 64, 128);
                }
                wait(15);
                if (playerturn = 6 && inparty[6] = 4) {
                    playsound(battleeffect[1], 64, 128);
                }
            }

            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 8;
            }
            wait(9);
            entity.specframe[battlechar[6]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 9;
            }
            wait(9);
            damages();
        }
    }
    if (playerturn = 7) {
        if (deadchar[7] = 1) {
            if (playerturn = 7 && inparty[7] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[7]] = 1;
            wait(10);
            if (playerturn = 7 && inparty[7] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[7]] = 2;
            wait(10);
            entity.specframe[battlechar[7]] = 3;
            if (inparty[playerturn] = 6) {
                if (playerturn = 7 && inparty[7] = 6) {
                    playsound(battleeffect[1], 64, 128);
                }
                wait(10);
                entity.specframe[battlechar[7]] = 4;
                wait(10);
                entity.specframe[battlechar[7]] = 5;
            }
            if (inparty[playerturn] = 4) {
                wait(10);
                entity.specframe[battlechar[7]] = 4;
                wait(50);
                entity.specframe[battlechar[7]] = 5;
                if (playerturn = 7 && inparty[7] = 4) {
                    playsound(battleeffect[4], 64, 128);
                }
                wait(15);
                if (playerturn = 7 && inparty[7] = 4) {
                    playsound(battleeffect[1], 64, 128);
                }
            }

            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 8;
            }
            wait(9);
            entity.specframe[battlechar[7]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 9;
            }
            wait(9);
            damages();
        }
    }
    if (playerturn = 8) {
        if (deadchar[8] = 1) {
            if (playerturn = 8 && inparty[8] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[8]] = 1;
            wait(10);
            if (playerturn = 8 && inparty[8] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[8]] = 2;
            wait(10);
            entity.specframe[battlechar[8]] = 3;
            if (inparty[playerturn] = 6) {
                if (playerturn = 8 && inparty[2] = 8) {
                    playsound(battleeffect[1], 64, 128);
                }
                wait(10);
                entity.specframe[battlechar[8]] = 4;
                wait(10);
                entity.specframe[battlechar[8]] = 5;
            }
            if (inparty[playerturn] = 4) {
                wait(10);
                entity.specframe[battlechar[8]] = 4;
                wait(50);
                entity.specframe[battlechar[8]] = 5;
                if (playerturn = 8 && inparty[8] = 4) {
                    playsound(battleeffect[4], 64, 128);
                }
                wait(15);
                if (playerturn = 8 && inparty[8] = 4) {
                    playsound(battleeffect[1], 64, 128);
                }
            }

            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 8;
            }
            wait(9);
            entity.specframe[battlechar[8]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 9;
            }
            wait(9);
            damages();
        }
    }
    if (playerturn = 9) {
        if (deadchar[9] = 1) {
            if (playerturn = 9 && inparty[9] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[9]] = 1;
            wait(10);
            if (playerturn = 9 && inparty[9] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[9]] = 2;
            wait(10);
            entity.specframe[battlechar[9]] = 3;
            if (inparty[playerturn] = 6) {
                if (playerturn = 9 && inparty[9] = 6) {
                    playsound(battleeffect[1], 64, 128);
                }
                if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                    playsound(battleeffect[1], 64, 128);
                }
                wait(10);
                entity.specframe[battlechar[9]] = 4;
                wait(10);
                entity.specframe[battlechar[9]] = 5;
            }
            if (inparty[playerturn] = 4) {
                wait(10);
                entity.specframe[battlechar[9]] = 4;
                wait(50);
                entity.specframe[battlechar[9]] = 5;
                if (playerturn = 9 && inparty[9] = 4) {
                    playsound(battleeffect[4], 64, 128);
                }
                wait(15);
                if (playerturn = 9 && inparty[9] = 4) {
                    playsound(battleeffect[1], 64, 128);
                }
            }

            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 8;
            }
            wait(9);
            entity.specframe[battlechar[9]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 9;
            }
            wait(9);
            damages();
        }
    }
    if (playerturn = 10) {
        if (deadchar[10] = 1) {
            if (playerturn = 10 && inparty[10] = 2) {
                playsound(battleeffect[2], 64, 128);
            }
            entity.specframe[battlechar[10]] = 1;
            wait(10);
            if (playerturn = 10 && inparty[10] = 1) {
                playsound(battleeffect[1], 64, 128);
            }
            if (weapontype[equippedweapon[inparty[playerturn]]] = 2) {
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlechar[10]] = 2;
            wait(10);
            entity.specframe[battlechar[10]] = 3;
            if (inparty[playerturn] = 6) {
                if (playerturn = 10 && inparty[10] = 6) {
                    playsound(battleeffect[1], 64, 128);
                }
                wait(10);
                entity.specframe[battlechar[10]] = 4;
                wait(10);
                entity.specframe[battlechar[10]] = 5;
            }
            if (inparty[playerturn] = 4) {
                wait(10);
                entity.specframe[battlechar[10]] = 4;
                wait(50);
                entity.specframe[battlechar[10]] = 5;
                if (playerturn = 10 && inparty[10] = 4) {
                    playsound(battleeffect[4], 64, 128);
                }
                wait(15);
                if (playerturn = 10 && inparty[10] = 4) {
                    playsound(battleeffect[1], 64, 128);
                }
            }

            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 8;
            }
            wait(9);
            entity.specframe[battlechar[10]] = 0;
            wait(1);
            if (deadmon[target] = 1) {
                entity.specframe[battlemonster[target]] = 9;
            }
            wait(9);
            damages();
        }
    }
}
void spelldamages() {
    spelldamage[2] = 15 + random(10);
    spelldamage[8] = 15 + random(10);
}
void enemydamages() {
    miss = 0;
    if (load = 3 && inbatmon[enemyturn] = 10) {
        vara[18] = random(100);
        enemdamages();
        enemydamage = 0;
        enemydamage = monstr[inbatmon[enemyturn]] - chasta[inparty[montarget]];
        enemydamage = enemydamage + ebasedamage[inbatmon[enemyturn]] -
                      chrac[inparty[montarget]];
        if (vara[18] < 10) {
            whiteout(2);
            whitein(2);
            enemydamage = enemydamage + enemydamage;
            vara[18] = 0;
        }
        dam = str(enemydamage);
        chahp[inparty[montarget]] = chahp[inparty[montarget]] - enemydamage;
        battlehp[montarget] = str(chahp[inparty[montarget]]);
        if (charzombie[inparty[montarget]] = 0) {
            partyspirit = partyspirit - enemydamage;
            if (partyspirit > maxpartyspirit) {
                partyspirit = maxpartyspirit;
            }
            partspirit = str(partyspirit);
        }
        if (chahp[inparty[montarget]] < 0) {
            deadchar[montarget] = 0;
            charstroke[inparty[montarget]] = 1;
            checkdie2();
        }
        if (chahp[inparty[montarget]] = 0) {
            deadchar[montarget] = 0;
            charstroke[inparty[montarget]] = 1;
            checkdie2();
        }
        damagex = battlelocx[montarget] * 16;
        damagex = damagex + 30;
        damagey = battlelocy[montarget] * 16;
        damagey = damagey + 5;
        render();
        gotoxy(damagex, damagey);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey);
        printstring(font4, dam);
        showpage();
        render();
        gotoxy(damagex, damagey + 1);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 1);
        printstring(font4, dam);
        showpage();
        render();
        gotoxy(damagex, damagey + 2);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 2);
        printstring(font4, dam);
        showpage();
        render();
        gotoxy(damagex, damagey + 3);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 3);
        printstring(font4, dam);
        showpage();
        render();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        allchardead = 0;
        for (x = 1; x < numchars2; x++) {
            if (deadchar[x] = 0) {
                allchardead = allchardead + 1;
            }
        }
        if (partyspirit <= 0 && allchardead = numchars) {
            vara[20] = 2;
            gameover();
        }
        if (partyspirit <= 0) {
            vara[20] = 1;
            gameover();
        }
        allchardead = 0;
        for (x = 1; x < numchars2; x++) {
            if (deadchar[x] = 0) {
                allchardead = allchardead + 1;
            }
        }
        if (allchardead = numchars) {
            vara[20] = 2;
            gameover();
        }
    }
    ELSE {
        temp[708] = random(100);
        temp[710] = random(100);
        vara[18] = random(100);
        if (temp[708] < monws[inbatmon[enemyturn]]) {
            if (charsleep[inparty[target]] = 1 && temp[710] < 50) {
                battle = 51;
                while (battle = 51) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1,
                        "   " + charname[inparty[playerturn]] + " woke up!!");
                    showsels();
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        unpress(key[28]);
                        charsleep[inparty[montarget]] = 0;
                        battle = 50;
                    }
                }
            }
            spelldamages();
            enemdamages();
            enemydamage = 0;
            enemydamage =
                monstr[inbatmon[enemyturn]] - chasta[inparty[montarget]];
            enemydamage = enemydamage + ebasedamage[inbatmon[enemyturn]] -
                          chrac[inparty[montarget]];
            if (vara[18] < 10) {
                whiteout(2);
                whitein(2);
                enemydamage = enemydamage + enemydamage;
                vara[18] = 0;
            }
            if (charzombie[inparty[montarget]] = 1) {
                enemydamage = enemydamage * 2;
            }
            if (defend[montarget] = 1) {
                enemydamage = enemydamage / 2;
            }
            if (enemydamage < 0) {
                enemydamage = 0;
            }
            dam = str(enemydamage);
            chahp[inparty[montarget]] = chahp[inparty[montarget]] - enemydamage;
            battlehp[montarget] = str(chahp[inparty[montarget]]);
            enemyattackcond();
        }
        ELSE {
            miss = 1;
            enemydamage = 0;
            dam = "Miss";
        }
        if (cast = 1) {
            enemydamage = spelldamage[spellused];
            cast = 0;
        }
        if (charzombie[inparty[montarget]] = 0) {
            partyspirit = partyspirit - enemydamage;
            if (partyspirit > maxpartyspirit) {
                partyspirit = maxpartyspirit;
            }
            partspirit = str(partyspirit);
        }
        if (charberserk[inparty[montarget]] = 1) {
            temp[506] = enemydamage / 2;
            partyspirit = partyspirit - temp[506];
            if (partyspirit > maxpartyspirit) {
                partyspirit = maxpartyspirit;
            }
            partspirit = str(partyspirit);
        }

        if (chahp[inparty[montarget]] < 0) {
            deadchar[montarget] = 0;
            checkdie2();
            charstroke[inparty[montarget]] = 1;
        }
        if (chahp[inparty[montarget]] = 0) {
            deadchar[montarget] = 0;
            checkdie2();
            charstroke[inparty[montarget]] = 1;
        }
        damagex = battlelocx[montarget] * 16;
        damagex = damagex + 30;
        damagey = battlelocy[montarget] * 16;
        damagey = damagey + 5;
        render();
        gotoxy(damagex, damagey);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey);
        printstring(font4, dam);
        showpage();
        render();
        gotoxy(damagex, damagey + 1);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 1);
        printstring(font4, dam);
        showpage();
        render();
        gotoxy(damagex, damagey + 2);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 2);
        printstring(font4, dam);
        showpage();
        render();
        gotoxy(damagex, damagey + 3);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 3);
        printstring(font4, dam);
        showpage();
        render();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        gotoxy(damagex, damagey + 4);
        printstring(font4, dam);
        showpage();
        allchardead = 0;
        for (x = 1; x < numchars2; x++) {
            if (deadchar[x] = 0) {
                allchardead = allchardead + 1;
            }
        }
        if (partyspirit <= 0 && allchardead = numchars) {
            vara[20] = 2;
            gameover();
        }
        if (partyspirit <= 0) {
            vara[20] = 1;
            gameover();
        }
        allchardead = 0;
        for (x = 1; x < numchars2; x++) {
            if (deadchar[x] = 0) {
                allchardead = allchardead + 1;
            }
        }
        if (allchardead = numchars) {
            vara[20] = 2;
            gameover();
        }
    }
}
void weapondamages() {
    weapondamage[1] = 15 + random(10);
    weapondamage[23] = 5 + random(15);
    weapondamage[22] = 10 + random(10);
    weapondamage[21] = 10 + random(10);
}
void damages() {
    miss = 0;
    temp[707] = random(100);
    vara[18] = random(100);
    if (temp[707] < chaws[inparty[playerturn]]) {
        spelldamages();
        weapondamages();
        damage = 0;
        damage = chastr[inparty[playerturn]] - monsta[inbatmon[target]];
        damage = damage + weapondamage[equippedweapon[inparty[playerturn]]] -
                 monac[inbatmon[target]];
        if (weapontype[equippedweapon[inparty[playerturn]]] =
                1 && weakmonster[target] = 1) {
            damage = damage + 10;
        }
        if (weapontype[equippedweapon[inparty[playerturn]]] =
                11 && weakmonster[target] = 2) {
            damage = damage + 10;
        }
        if (weapontype[equippedweapon[inparty[playerturn]]] =
                1 && weakmonster[target] = 2) {
            damage = damage - 10;
        }
        if (vara[18] < 10) {
            whiteout(2);
            whitein(2);
            damage = damage + damage;
            vara[18] = 0;
        }
        if (weapontype[equippedweapon[inparty[playerturn]]] =
                11 && weakmonster[target] = 1) {
            damage = 0;
            battle = 60;
            dam = str(damage);
            if (deadmon[target] = 1) {
                while (battle = 60) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, "The bolt was eaten by the slime.");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 61;
                        missed = 1;
                    }
                }
            }
            ELSE { missed = 1; }
        }
        if (charcurse[inparty[playerturn]] = 1) {
            damage = damage / 2;
        }
        if (charberserk[inparty[playerturn]] = 1) {
            damage = damage * 2;
        }
        if (damage > 0) {
            missed = 1;
        }
        if (damage < 0) {
            damage = 0;
        }
    }
    ELSE {
        miss = 1;
        damage = 0;
        dam = "Miss";
    }
    if (cast = 1) {
        if (spelltype[spellused] = 18) {
            damage = spelldamage[spellused] + fireweakness[inbatmon[target]];
        }
        if (spelltype[spellused] = 26) {
            damage = spelldamage[spellused] + iceweakness[inbatmon[target]];
        }
        cast = 0;
    }
    monsterspirit = monsterspirit - damage;
    if (monsterspirit > monstermaxspirit) {
        monsterspirit = monstermaxspirit;
    }
    monspirit = str(monsterspirit);
    if (damage > 0) {
        dam = str(damage);
        monsterhp[target] = monsterhp[target] - damage;
    }
    if (monsterhp[target] < 0) {
        deadmon[target] = 0;
        checkdie();
    }
    if (monsterhp[target] = 0) {
        deadmon[target] = 0;
        checkdie();
    }
    if (monsterspirit <= 50 && mongroup = 3 && inbatmon[target] = 10) {
        deadmon[target] = 0;
        checkdie();
        allmondead = 1;
        alldead();
    }
    damagex = battlemonlocx[target] * 16;
    damagex = damagex + 30;
    damagey = battlemonlocy[target] * 16;
    damagey = damagey + 5;
    render();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    allmondead = 0;
    for (x = 1; x < nummon2; x++) {
        if (deadmon[x] = 0) {
            allmondead = allmondead + 1;
        }
    }
    if (monsterspirit <= 0 && allmondead = nummon) {
        alldead();
    }
    if (monsterspirit <= 0) {
        alldead();
    }
    allmondead = 0;
    for (x = 1; x < nummon2; x++) {
        if (deadmon[x] = 0) {
            allmondead = allmondead + 1;
        }
    }
    if (allmondead = nummon) {
        alldead();
    }
}
void grazydamages() {
    miss = 0;
    temp[707] = random(100);
    vara[18] = random(100);
    if (temp[707] < chaws[inparty[playerturn]]) {
        spelldamages();
        weapondamages();
        damage = 0;
        damage = chastr[inparty[playerturn]] - chasta[inparty[target]];
        damage = damage + weapondamage[equippedweapon[inparty[playerturn]]] -
                 chrac[inparty[target]];
        if (vara[18] < 10) {
            whiteout(2);
            whitein(2);
            damage = damage + damage;
            vara[18] = 0;
        }
        if (charcurse[inparty[playerturn]] = 1) {
            damage = damage / 2;
        }
        if (charberserk[inparty[playerturn]] = 1) {
            damage = damage * 2;
        }
        if (damage > 0) {
            missed = 1;
        }
        if (damage < 0) {
            damage = 0;
        }
    }
    ELSE {
        miss = 1;
        damage = 0;
        dam = "Miss";
    }
    partyspirit = partyspirit - damage;
    if (partyspirit > maxpartyspirit) {
        partyspirit = maxpartyspirit;
    }
    partspirit = str(partyspirit);
    if (damage > 0) {
        dam = str(damage);
        chahp[inparty[target]] = chahp[inparty[target]] - damage;
        battlehp[target] = str(chahp[inparty[target]]);
    }
    if (chahp[inparty[target]] < 0) {
        deadmon[target] = 0;
        charstroke[inparty[target]] = 1;
        checkdie2();
    }
    if (chahp[inparty[target]] = 0) {
        deadmon[target] = 0;
        charstroke[inparty[target]] = 1;
        checkdie2();
    }
    damagex = battlelocx[target] * 16;
    damagex = damagex + 30;
    damagey = battlelocy[target] * 16;
    damagey = damagey + 5;
    render();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    allchardead = 0;
    for (x = 1; x = numchars; x++) {
        if (deadchar[x] = 0) {
            allchardead = allchardead + 1;
        }
    }
    if (partyspirit <= 0 && allchardead = numchars) {
        vara[20] = 2;
        gameover();
    }
    if (partyspirit <= 0) {
        vara[20] = 1;
        gameover();
    }
    allchardead = 0;
    for (x = 1; x = numchars; x++) {
        if (deadchar[x] = 0) {
            allchardead = allchardead + 1;
        }
    }
    if (allchardead = numchars) {
        vara[20] = 2;
        gameover();
    }
}
void suck() {
    battleeffect[5] = cachesound("heal1.wav");
    playsound(battleeffect[5], 64, 128);
    alterftile(battlemonlocx[enemyturn], battlemonlocy[enemyturn], 1274, 0);
    temp[8000] = monstermaxhp[enemyturn] - monsterhp[enemyturn];
    monsterhp[enemyturn] = monsterhp[enemyturn] + damage;
    if (monsterhp[enemyturn] > monstermaxhp[enemyturn]) {
        monsterhp[enemyturn] = monstermaxhp[enemyturn];
    }
    monsterspirit = monsterspirit + damage;
    if (monsterspirit > monstermaxspirit) {
        monsterspirit = monstermaxspirit;
    }
    monspirit = str(monsterspirit);
    dam = str(damage);
    monspirit = str(monsterspirit);
    damagex = battlemonlocx[enemyturn] * 16;
    damagex = damagex + 30;
    damagey = battlemonlocy[enemyturn] * 16;
    damagey = damagey + 5;
    render();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    alterftile(battlemonlocx[enemyturn], battlemonlocy[enemyturn], 0, 0);
}
void regenerate() {
    battleeffect[5] = cachesound("heal1.wav");
    playsound(battleeffect[5], 64, 128);
    alterftile(
        battlemonlocx[enemyturn] + 50, battlemonlocy[enemyturn] + 50, 1274, 0);
    temp[8000] = monstermaxhp[enemyturn] - monsterhp[enemyturn];
    monsterhp[enemyturn] = monsterhp[enemyturn] + 20;
    if (monsterhp[enemyturn] > monstermaxhp[enemyturn]) {
        monsterhp[enemyturn] = monstermaxhp[enemyturn];
    }
    monsterspirit = monsterspirit + 20;
    if (monsterspirit > monstermaxspirit) {
        monsterspirit = monstermaxspirit;
    }
    monspirit = str(monsterspirit);
    dam = "20";
    monspirit = str(monsterspirit);
    damagex = battlemonlocx[enemyturn] * 16;
    damagex = damagex + 80;
    damagey = battlemonlocy[enemyturn] * 16;
    damagey = damagey + 55;
    render();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 1);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 2);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 3);
    printstring(font4, dam);
    showpage();
    render();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    gotoxy(damagex, damagey + 4);
    printstring(font4, dam);
    showpage();
    alterftile(
        battlemonlocx[enemyturn] + 50, battlemonlocy[enemyturn] + 50, 0, 0);
}

void enemyattackcond() {
    temp[670] = random(100);
    switch (monattcond[inbatmon[enemyturn]]) {
    case 1:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            if (cancausepoison[inparty[montarget]] = 0) {
                if (mongroup = 3 && inbatmon[enemyturn] = 1) {
                    strongpoison[inparty[montarget]] = 1;
                }
                charpoisoned[inparty[montarget]] = 1;
                battle = 51;
                while (battle = 51) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "   " + charname[inparty[montarget]] +
                                       " is poisoned!!");
                    showsels();
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        unpress(key[28]);
                        battle = 50;
                    }
                }
            }
        }
    case 2:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            if (cancausepara[inparty[montarget]] = 0) {
                charpara[inparty[montarget]] = 1;
                battle = 51;
                while (battle = 51) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "   " + charname[inparty[montarget]] +
                                       " is paralyzed!!");
                    showsels();
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        unpress(key[28]);
                        battle = 50;
                    }
                }
            }
        }
    case 3:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            charsleep[inparty[montarget]] = 1;
            battle = 51;
            while (battle = 51) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(
                    1, "   " + charname[inparty[montarget]] + " fell asleep!!");
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    battle = 50;
                }
            }
        }
    case 4:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            charzombie[inparty[montarget]] = 1;
            battle = 51;
            while (battle = 51) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(1, "   " + charname[inparty[montarget]] +
                                   " became a zombie!!");
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    battle = 50;
                }
            }
        }
    case 5:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            if (cancausecurse[inparty[montarget]] = 0) {
                charcurse[inparty[montarget]] = 1;
                battle = 51;
                while (battle = 51) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1,
                        "   " + charname[inparty[montarget]] + " is cursed!!");
                    showsels();
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        unpress(key[28]);
                        battle = 50;
                    }
                }
            }
        }
    case 6:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            if (cancausegrazy[inparty[montarget]] = 0) {
                chargrazy[inparty[montarget]] = 1;
                battle = 51;
                while (battle = 51) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "   " + charname[inparty[montarget]] +
                                       " lost sanity!!");
                    showsels();
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        unpress(key[28]);
                        battle = 50;
                    }
                }
            }
        }
    case 7:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            charskillness[inparty[montarget]] = 1;
            battle = 51;
            while (battle = 51) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(1, "   " + charname[inparty[montarget]] +
                                   " has butterfingers!!");
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    battle = 50;
                }
            }
        }
    case 8:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            charsilence[inparty[montarget]] = 1;
            battle = 51;
            while (battle = 51) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(
                    1, "   " + charname[inparty[montarget]] + " is muted!!");
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    battle = 50;
                }
            }
        }
    case 9:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            charberserk[inparty[montarget]] = 1;
            battle = 51;
            while (battle = 51) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(1,
                    "   " + charname[inparty[montarget]] + " is berserked!!");
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    battle = 50;
                }
            }
        }
    case 11:
        if (temp[670] < mattcondperc[inbatmon[enemyturn]]) {
            charblind[inparty[montarget]] = 1;
            chaws[inparty[montarget]] = chaws[inparty[montarget]] / 2;
            battle = 51;
            while (battle = 51) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(
                    1, "   " + charname[inparty[montarget]] + " can't see!!");
                showsels();
                showpage();
                updatecontrols();
                if (key[28]) {
                    unpress(key[28]);
                    battle = 50;
                }
            }
        }
    }
}
void enemyhit() {
    temp[621] = random(100);
    if (mongroup = 3 && inbatmon[enemyturn] = 2) {
        if (temp[621] > 80) {
            temp[622] = 1;
        }
        ELSE { temp[622] = 0; }
    }
    if (mongroup = 3 && inbatmon[enemyturn] = 10) {
        if (temp[621] > 70) {
            temp[622] = 1;
        }
        ELSE { temp[622] = 0; }
        if (temp[621] > 90) {
            temp[622] = 2;
        }
    }
    montarget = 0;
    montarget = 10 * numchars;
    montarget = random(montarget);
    if (numchars = 1) {
        montarget = 1;
    }
    if (numchars = 2) {
        if (montarget <= 10) {
            montarget = 1;
        }
        if (montarget > 10) {
            montarget = 2;
        }
    }
    if (numchars = 3) {
        if (montarget <= 10) {
            montarget = 1;
        }
        if (montarget > 10 && montarget <= 20) {
            montarget = 2;
        }
        if (montarget > 20) {
            montarget = 3;
        }
    }
    if (numchars = 4) {
        if (montarget <= 10) {
            montarget = 1;
        }
        if (montarget > 10 && montarget <= 20) {
            montarget = 2;
        }
        if (montarget > 20 && montarget <= 30) {
            montarget = 3;
        }
        if (montarget > 30) {
            montarget = 4;
        }
    }
}
void enemyattack() {
    if (enemyturn = 1) {
        enemyhit();
        if (humanboss = 1 && mongroup > 1) {
            if (deadmon[enemyturn] = 1) {
                battle = 90;
                temp[2001] = random(50);
                while (battle = 90 && load = 0) {
                    render();
                    Tcopysprite(200, screeny - 97, 96, 96,
                        enemypic[inbatmon[enemyturn]]);
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, monstername[enemyturn] + ":");
                    gotoxy(305, 440);
                    enemytalk();
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
            }
        }
        if (dualattack[enemyturn] = 1) {
            if (humanboss = 0 && inbatmon[1] = 9 && mongroup = 3) {
                temp[2001] = 0;
                temp[2001] = temp[2001] + random(50);
                if (temp[2001] <= 25) {
                    temp[3000] = 1;
                }
                ELSE { temp[3000] = 2; }
            }
            if (temp[3000] = 1 && mongroup = 3 && inbatmon[1] = 9) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                    playsound(battleeffect[3], 64, 128);
                }
                entity.specframe[battlemonster[1]] = 3;
                wait(10);
                entity.specframe[battlemonster[1]] = 4;
                wait(10);
                entity.specframe[battlemonster[1]] = 5;
                wait(10);
                entity.specframe[battlemonster[1]] = 0;
                wait(10);
                enemydamages();
                enemyhit();
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                    playsound(battleeffect[3], 64, 128);
                }
                entity.specframe[battlemonster[1]] = 3;
                wait(10);
                entity.specframe[battlemonster[1]] = 4;
                wait(10);
                entity.specframe[battlemonster[1]] = 5;
                wait(10);
                entity.specframe[battlemonster[1]] = 0;
                wait(10);
                enemydamages();
            }
            if (temp[3000] = 2 && mongroup = 3 && inbatmon[1] = 9) {
                unpress(key[28]);
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "     Darkness!");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                whiteout(5);
                whitein(5);
                monattcond[inbatmon[enemyturn]] = 11;
                mattcondperc[inbatmon[enemyturn]] = 100;
                enemyattackcond();
                monattcond[inbatmon[enemyturn]] = 10;
                mattcondperc[inbatmon[enemyturn]] = 0;
            }
            if (load > 0) {
                temp[3000] = 3;
            }
            if (temp[3000] = 1 && mongroup = 3 && inbatmon[1] = 12) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "     Curse!");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                armaspell();
                monattcond[inbatmon[enemyturn]] = 5;
                mattcondperc[inbatmon[enemyturn]] = 100;
                enemyattackcond();
                monattcond[inbatmon[enemyturn]] = 10;
                mattcondperc[inbatmon[enemyturn]] = 0;
            }
            if (temp[3000] = 6 && mongroup = 3 && inbatmon[1] = 12) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "     Paralyze!");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                armaspell();
                monattcond[inbatmon[enemyturn]] = 2;
                mattcondperc[inbatmon[enemyturn]] = 100;
                enemyattackcond();
                monattcond[inbatmon[enemyturn]] = 10;
                mattcondperc[inbatmon[enemyturn]] = 0;
            }
            if (temp[3000] = 7 && mongroup = 3 && inbatmon[1] = 12) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                armaspell();
                hellfire();
                enemydamages();
            }

            if (temp[3000] = 5 && mongroup = 3 && inbatmon[1] = 12) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "    Berserk!");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                armaspell();
                monattcond[inbatmon[enemyturn]] = 9;
                mattcondperc[inbatmon[enemyturn]] = 100;
                enemyattackcond();
                monattcond[inbatmon[enemyturn]] = 10;
                mattcondperc[inbatmon[enemyturn]] = 100;
            }
            if (temp[3000] = 4 && mongroup = 3 && inbatmon[1] = 12) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "    Zombie!");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                armaspell();
                monattcond[inbatmon[enemyturn]] = 4;
                mattcondperc[inbatmon[enemyturn]] = 100;
                enemyattackcond();
                monattcond[inbatmon[enemyturn]] = 10;
                mattcondperc[inbatmon[enemyturn]] = 0;
            }
            if (temp[3000] = 2 && mongroup = 3 && inbatmon[1] = 12) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "    Confusion!");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                armaspell();
                monattcond[inbatmon[enemyturn]] = 6;
                mattcondperc[inbatmon[enemyturn]] = 100;
                enemyattackcond();
                monattcond[inbatmon[enemyturn]] = 10;
                mattcondperc[inbatmon[enemyturn]] = 0;
            }
            if (temp[3000] = 3 && mongroup = 3 && inbatmon[1] = 12) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 440);
                    printstring(1, "    Bloodsuck!");
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                armaspell();
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 1296, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 1,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 2,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 1, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 3,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 2, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 4,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 3, 0, 0);
                wait(5);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 4, 0, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 1297, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 0, 0);
                enemydamages();
                suck();
            }
            if (temp[3000] = 1 && mongroup = 3 && inbatmon[1] = 10) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                playsound(battleeffect[3], 64, 128);
                entity.specframe[battlemonster[1]] = 3;
                wait(10);
                entity.specframe[battlemonster[1]] = 4;
                wait(10);
                entity.specframe[battlemonster[1]] = 5;
                wait(10);
                entity.specframe[battlemonster[1]] = 0;
                wait(10);
                enemydamages();
            }
            if (temp[3000] = 2 && mongroup = 3 && inbatmon[1] = 10) {
                entity.specframe[battlemonster[1]] = 10;
                wait(10);
                battleeffect[6] = cachesound("barf.wav");
                playsound(battleeffect[6], 128, 128);
                entity.specframe[battlemonster[1]] = 11;
                wait(15);
                entity.specframe[battlemonster[1]] = 12;
                wait(15);
                entity.specframe[battlemonster[1]] = 13;
                wait(15);
                entity.specframe[battlemonster[1]] = 14;
                wait(15);
                entity.specframe[battlemonster[1]] = 10;
                free(battleeffect[6]);
                monattcond[inbatmon[enemyturn]] = 1;
                enemyattackcond();
                monattcond[inbatmon[enemyturn]] = 10;
                enemydamages();
            }
            if (temp[3000] = 3 && mongroup = 3 && inbatmon[1] = 10) {
                entity.specframe[battlemonster[1]] = 10;
                wait(10);
                entity.specframe[battlemonster[1]] = 16;
                wait(15);
                if (load < 3) {
                    unpress(key[28]);
                    battle = 90;
                    while (battle = 90 && mongroup = 3) {
                        render();
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        if (load = 0) {
                            printstring(1, "Charging arsecannon...");
                        }
                        if (load = 1) {
                            printstring(1, "Charging arsecannon...");
                        }
                        if (load = 2) {
                            printstring(1, "Arsecannon charged...");
                        }
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 91;
                            load = load + 1;
                        }
                    }
                }
                if (load = 3) {
                    unpress(key[28]);
                    temp[2001] = 40;
                    battle = 90;
                    while (battle = 90 && mongroup = 3 && load = 0) {
                        render();
                        Tcopysprite(200, screeny - 97, 96, 96,
                            enemypic[inbatmon[enemyturn]]);
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, monstername[enemyturn] + ":");
                        gotoxy(305, 440);
                        enemytalk();
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 91;
                        }
                    }
                    music_volume = 100;
                    wait(2);
                    music_volume = 90;
                    wait(2);
                    music_volume = 80;
                    wait(2);
                    music_volume = 70;
                    wait(2);
                    music_volume = 60;
                    wait(10);
                    battleeffect[6] = cachesound("cannon.wav");
                    playsound(battleeffect[6], 128, 128);
                    entity.specframe[battlemonster[1]] = 17;
                    wait(15);
                    entity.specframe[battlemonster[1]] = 18;
                    wait(15);
                    entity.specframe[battlemonster[1]] = 19;
                    wait(15);
                    entity.specframe[battlemonster[1]] = 20;
                    wait(30);
                    entity.specframe[battlemonster[1]] = 10;
                    free(battleeffect[6]);
                    music_volume = 70;
                    wait(2);
                    music_volume = 80;
                    wait(2);
                    music_volume = 90;
                    wait(2);
                    music_volume = 100;
                    enemydamages();
                    load = 0;
                }
            }
        }
        if (dualattack[enemyturn] = 0) {
            if (deadmon[enemyturn] = 1) {
                entity.specframe[battlemonster[1]] = 2;
                wait(10);
                if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                    playsound(battleeffect[3], 64, 128);
                }
                entity.specframe[battlemonster[1]] = 3;
                wait(10);
                entity.specframe[battlemonster[1]] = 4;
                wait(10);
                entity.specframe[battlemonster[1]] = 5;
                wait(10);
                if (mongroup = 3 && inbatmon[1] = 3) {
                    entity.specframe[battlemonster[1]] = 10;
                    wait(10);
                    entity.specframe[battlemonster[1]] = 11;
                    wait(10);
                    entity.specframe[battlemonster[1]] = 12;
                    wait(10);
                }
                entity.specframe[battlemonster[1]] = 0;
                wait(10);
                if (temp[622] = 1 && mongroup =
                        3 && inbatmon[enemyturn] = 2 && miss =
                            0 && deadmon[enemyturn] = 1) {
                    battle = 90;
                    while (battle = 90) {
                        render();
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, "Bloodsuck!!");
                        gotoxy(305, 440);
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 91;
                        }
                    }
                    alterftile(battlelocx[montarget] + 1, battlelocy[montarget],
                        1296, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 1, 1296, 0);
                    alterftile(
                        battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 2, 1296, 0);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 1, 0, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 3, 1296, 0);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 2, 0, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 4, 1296, 0);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 3, 0, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 4, 0, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 4, 1297, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 3, 1297, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 4, 0, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 2, 1297, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 3, 0, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 1, 1297, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 2, 0, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn], 1297, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 1, 0, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn], 0, 0);
                }
                enemydamages();
            }
            if (temp[622] = 1 && mongroup =
                    3 && inbatmon[enemyturn] = 2 && miss =
                        0 && deadmon[enemyturn] = 1) {
                suck();
                temp[622] = 0;
            }
        }
        if (humanboss = 1 && mongroup = 3 && inbatmon[enemyturn] =
                                            10 && vara[1] = 0) {
            unpress(key[28]);
            battle = 90;
            while (battle = 90) {
                render();
                TCopySprite(300, screeny - 65, 320, 64, textbox);
                gotoxy(305, 440);
                printstring(1, "    Regeneration!!");
                showpage();
                updatecontrols();
                if (key[28]) {
                    battle = 91;
                }
            }
            target = 1;
            regenerate();
        }
        enemyturn = 2;
        if (enemyturn > nummon) {
            round = round + 1;
            rounds = str(round);
            if (round = 8) {
                alldead();
                if (monsterspirit > partyspirit) {
                    gameover();
                }
                if (monsterspirit = partyspirit) {
                    gameover();
                }
                if (monsterspirit < partyspirit) {
                    alldead();
                }
            }
            music_volume = 80;
            wait(5);
            music_volume = 100;
            enemyturn = 0;
            playerturn = 1;
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            render();
            For(x = 1; x < numchars2; x++) {
                defend[x] = 0;
                entity.specframe[battlechar[x]] = 0;
            }

            battleselections();
        }
        ELSE { render(); }
    }
    if (enemyturn = 2) {
        if (humanboss = 1) {
            if (deadmon[enemyturn] = 1) {
                enemyhit();
                battle = 90;
                temp[2001] = 0;
                temp[2001] = temp[2001] + random(50);
                while (battle = 90 && mongroup = 1) {
                    render();
                    Tcopysprite(200, screeny - 97, 96, 96,
                        enemypic[inbatmon[enemyturn]]);
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, monstername[enemyturn] + ":");
                    gotoxy(305, 440);
                    enemytalk();
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
            }
        }
        if (dualattack[enemyturn] = 1) {
            if (deadmon[enemyturn] = 1) {
                if (temp[3000] = 1) {
                    enemycastspell();
                }
                if (temp[3000] = 2) {
                    entity.specframe[battlemonster[2]] = 2;
                    wait(10);
                    playsound(battleeffect[3], 64, 128);
                    entity.specframe[battlemonster[2]] = 3;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 4;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 5;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 0;
                    wait(10);
                    monattcond[inbatmon[enemyturn]] = 5;
                    enemyattackcond();
                    monattcond[inbatmon[enemyturn]] = 10;
                    enemydamages();
                }
                if (temp[3000] = 4) {
                    entity.specframe[battlemonster[2]] = 2;
                    wait(10);
                    playsound(battleeffect[3], 64, 128);
                    entity.specframe[battlemonster[2]] = 3;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 4;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 5;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 0;
                    wait(10);
                    monattcond[inbatmon[enemyturn]] = 3;
                    enemyattackcond();
                    monattcond[inbatmon[enemyturn]] = 10;
                    enemydamages();
                }
                if (temp[3000] = 6) {
                    enemycastspell();
                }
                if (temp[3000] = 3) {
                    enemycastspell();
                }
                if (temp[3000] = 5) {
                    target = random(nummon);
                    if (target = 0) {
                        target = 1;
                    }
                    entity.specframe[battlemonster[2]] = 10;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 11;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 12;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 13;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 14;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 15;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 16;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 0;
                    wait(50);
                    enemyheal();
                }
                if (temp[3000] = 7) {
                    entity.specframe[battlemonster[2]] = 10;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 11;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 12;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 13;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 14;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 15;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 16;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 0;
                    wait(10);
                    enemyhealall();
                }
            }
        }
        if (dualattack[enemyturn] = 0) {
            if (deadmon[enemyturn] = 1) {
                enemyhit();
                entity.specframe[battlemonster[2]] = 2;
                wait(10);
                if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                    playsound(battleeffect[3], 64, 128);
                }
                entity.specframe[battlemonster[2]] = 3;
                wait(10);
                entity.specframe[battlemonster[2]] = 4;
                wait(10);
                entity.specframe[battlemonster[2]] = 5;
                wait(10);
                if (mongroup = 3 && inbatmon[2] = 3) {
                    entity.specframe[battlemonster[2]] = 10;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 11;
                    wait(10);
                    entity.specframe[battlemonster[2]] = 12;
                    wait(10);
                }
                entity.specframe[battlemonster[2]] = 0;
                wait(10);
                if (temp[622] = 1 && mongroup =
                        3 && inbatmon[enemyturn] = 2 && miss =
                            0 && deadmon[enemyturn] = 1) {
                    battle = 90;
                    while (battle = 90) {
                        render();
                        TCopySprite(300, screeny - 65, 320, 64, textbox);
                        gotoxy(305, 420);
                        printstring(1, "Bloodsuck!!");
                        gotoxy(305, 440);
                        showpage();
                        updatecontrols();
                        if (key[28]) {
                            battle = 91;
                        }
                    }
                    alterftile(battlelocx[montarget] + 1, battlelocy[montarget],
                        1296, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 1, 1296, 0);
                    alterftile(
                        battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 2, 1296, 0);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 1, 0, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 3, 1296, 0);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 2, 0, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 4, 1296, 0);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 3, 0, 0);
                    wait(5);
                    alterftile(battlelocx[montarget] + 1,
                        battlelocy[montarget] - 4, 0, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 4, 1297, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 3, 1297, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 4, 0, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 2, 1297, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 3, 0, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 1, 1297, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 2, 0, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn], 1297, 0);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn] - 1, 0, 0);
                    wait(5);
                    alterftile(battlemonlocx[enemyturn] + 1,
                        battlemonlocy[enemyturn], 0, 0);
                }
                enemydamages();
            }
            if (temp[622] = 1 && mongroup =
                    3 && inbatmon[enemyturn] = 2 && miss =
                        0 && deadmon[enemyturn] = 1) {
                suck();
                temp[622] = 0;
            }
            /*if(humanboss=1 && mongroup=3 && temp[899]=0)
           {
            temp[899]=1;
            enemyattack();
           }*/
        }
        enemyturn = 3;
        temp[899] = 0;
        if (enemyturn > nummon) {
            round = round + 1;
            rounds = str(round);
            if (round = 8) {
                alldead();
                if (monsterspirit > partyspirit) {
                    gameover();
                }
                if (monsterspirit = partyspirit) {
                    gameover();
                }
                if (monsterspirit < partyspirit) {
                    alldead();
                }
            }
            music_volume = 80;
            wait(5);
            music_volume = 100;
            enemyturn = 0;
            playerturn = 1;
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            render();
            For(x = 1; x < numchars2; x++) {
                defend[x] = 0;
                entity.specframe[battlechar[x]] = 0;
            }
            battleselections();
        }
        ELSE { render(); }
    }
    if (enemyturn = 3) {
        if (deadmon[enemyturn] = 1) {
            enemyhit();
            entity.specframe[battlemonster[3]] = 2;
            wait(10);
            if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                playsound(battleeffect[3], 64, 128);
            }
            entity.specframe[battlemonster[3]] = 3;
            wait(10);
            entity.specframe[battlemonster[3]] = 4;
            wait(10);
            entity.specframe[battlemonster[3]] = 5;
            wait(10);
            if (mongroup = 3 && inbatmon[3] = 3) {
                entity.specframe[battlemonster[3]] = 10;
                wait(10);
                entity.specframe[battlemonster[3]] = 11;
                wait(10);
                entity.specframe[battlemonster[3]] = 12;
                wait(10);
            }
            entity.specframe[battlemonster[3]] = 0;
            wait(10);
            if (temp[622] = 1 && mongroup =
                    3 && inbatmon[enemyturn] = 2 && miss =
                        0 && deadmon[enemyturn] = 1) {
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, "Bloodsuck!!");
                    gotoxy(305, 440);
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 1296, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 1,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 2,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 1, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 3,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 2, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 4,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 3, 0, 0);
                wait(5);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 4, 0, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 1297, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 0, 0);
            }
            enemydamages();
        }
        if (temp[622] = 1 && mongroup = 3 && inbatmon[enemyturn] = 2 && miss =
                                            0 && deadmon[enemyturn] = 1) {
            suck();
            temp[622] = 0;
        }
        enemyturn = 4;
        if (enemyturn > nummon) {
            round = round + 1;
            rounds = str(round);
            if (round = 8) {
                alldead();
                if (monsterspirit > partyspirit) {
                    gameover();
                }
                if (monsterspirit = partyspirit) {
                    gameover();
                }
                if (monsterspirit < partyspirit) {
                    alldead();
                }
            }
            music_volume = 80;
            wait(5);
            music_volume = 100;
            enemyturn = 0;
            playerturn = 1;
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            render();
            For(x = 1; x < numchars2; x++) {
                defend[x] = 0;
                entity.specframe[battlechar[x]] = 0;
            }

            battleselections();
        }
        ELSE { render(); }
    }
    if (enemyturn = 4) {
        if (deadmon[enemyturn] = 1) {
            enemyhit();
            entity.specframe[battlemonster[4]] = 2;
            wait(10);
            if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                playsound(battleeffect[3], 64, 128);
            }
            entity.specframe[battlemonster[4]] = 3;
            wait(10);
            entity.specframe[battlemonster[4]] = 4;
            wait(10);
            if (mongroup = 3 && inbatmon[enemyturn] = 7) {
                wait(50);
                playsound(battleeffect[4], 64, 128);
                wait(15);
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlemonster[4]] = 5;
            wait(10);
            if (mongroup = 3 && inbatmon[4] = 3) {
                entity.specframe[battlemonster[4]] = 10;
                wait(10);
                entity.specframe[battlemonster[4]] = 11;
                wait(10);
                entity.specframe[battlemonster[4]] = 12;
                wait(10);
            }
            entity.specframe[battlemonster[4]] = 0;
            wait(10);
            if (temp[622] = 1 && mongroup =
                    3 && inbatmon[enemyturn] = 2 && miss =
                        0 && deadmon[enemyturn] = 1) {
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, "Bloodsuck!!");
                    gotoxy(305, 440);
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 1296, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 1,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 2,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 1, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 3,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 2, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 4,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 3, 0, 0);
                wait(5);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 4, 0, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 1297, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 0, 0);
            }
            enemydamages();
        }
        if (temp[622] = 1 && mongroup = 3 && inbatmon[enemyturn] = 2 && miss =
                                            0 && deadmon[enemyturn] = 1) {
            suck();
            temp[622] = 0;
        }
        enemyturn = 5;
        if (enemyturn > nummon) {
            round = round + 1;
            rounds = str(round);
            if (round = 8) {
                alldead();
                if (monsterspirit > partyspirit) {
                    gameover();
                }
                if (monsterspirit = partyspirit) {
                    gameover();
                }
                if (monsterspirit < partyspirit) {
                    alldead();
                }
            }
            music_volume = 80;
            wait(5);
            music_volume = 100;
            enemyturn = 0;
            playerturn = 1;
            render();
            For(x = 1; x < numchars2; x++) {
                defend[x] = 0;
                entity.specframe[battlechar[x]] = 0;
            }

            battleselections();
        }
        ELSE { render(); }
    }
    if (enemyturn = 5) {
        if (deadmon[enemyturn] = 1) {
            enemyhit();
            entity.specframe[battlemonster[5]] = 2;
            wait(10);
            if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                playsound(battleeffect[3], 64, 128);
            }
            entity.specframe[battlemonster[5]] = 3;
            wait(10);
            entity.specframe[battlemonster[5]] = 4;
            wait(10);
            if (mongroup = 3 && inbatmon[enemyturn] = 7) {
                wait(50);
                playsound(battleeffect[4], 64, 128);
                wait(15);
                playsound(battleeffect[1], 64, 128);
            }
            entity.specframe[battlemonster[5]] = 5;
            wait(10);
            if (mongroup = 3 && inbatmon[5] = 3) {
                entity.specframe[battlemonster[5]] = 10;
                wait(10);
                entity.specframe[battlemonster[5]] = 11;
                wait(10);
                entity.specframe[battlemonster[5]] = 12;
                wait(10);
            }
            entity.specframe[battlemonster[5]] = 0;
            wait(10);
            if (temp[622] = 1 && mongroup =
                    3 && inbatmon[enemyturn] = 2 && miss =
                        0 && deadmon[enemyturn] = 1) {
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, "Bloodsuck!!");
                    gotoxy(305, 440);
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 1296, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 1,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 2,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 1, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 3,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 2, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 4,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 3, 0, 0);
                wait(5);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 4, 0, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 1297, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 0, 0);
            }
            enemydamages();
        }
        if (temp[622] = 1 && mongroup = 3 && inbatmon[enemyturn] = 2 && miss =
                                            0 && deadmon[enemyturn] = 1) {
            suck();
            temp[622] = 0;
        }
        enemyturn = 6;
        if (enemyturn > nummon) {
            round = round + 1;
            rounds = str(round);
            if (round = 8) {
                alldead();
                if (monsterspirit > partyspirit) {
                    gameover();
                }
                if (monsterspirit = partyspirit) {
                    gameover();
                }
                if (monsterspirit < partyspirit) {
                    alldead();
                }
            }
            music_volume = 80;
            wait(5);
            music_volume = 100;
            enemyturn = 0;
            playerturn = 1;
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            render();
            For(x = 1; x < numchars2; x++) {
                defend[x] = 0;
                entity.specframe[battlechar[x]] = 0;
            }

            battleselections();
        }
        ELSE { render(); }
    }
    if (enemyturn = 6) {
        if (deadmon[enemyturn] = 1) {
            enemyhit();
            entity.specframe[battlemonster[6]] = 2;
            wait(10);
            if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                playsound(battleeffect[3], 64, 128);
            }
            entity.specframe[battlemonster[6]] = 3;
            wait(10);
            entity.specframe[battlemonster[6]] = 4;
            wait(10);
            entity.specframe[battlemonster[6]] = 5;
            wait(10);
            if (mongroup = 3 && inbatmon[6] = 3) {
                entity.specframe[battlemonster[6]] = 10;
                wait(10);
                entity.specframe[battlemonster[6]] = 11;
                wait(10);
                entity.specframe[battlemonster[6]] = 12;
                wait(10);
            }
            entity.specframe[battlemonster[6]] = 0;
            wait(10);
            if (temp[622] = 1 && mongroup =
                    3 && inbatmon[enemyturn] = 2 && miss =
                        0 && deadmon[enemyturn] = 1) {
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, "Bloodsuck!!");
                    gotoxy(305, 440);
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 1296, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 1,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 2,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 1, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 3,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 2, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 4,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 3, 0, 0);
                wait(5);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 4, 0, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 1297, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 0, 0);
            }
            enemydamages();
        }
        if (temp[622] = 1 && mongroup = 3 && inbatmon[enemyturn] = 2 && miss =
                                            0 && deadmon[enemyturn] = 1) {
            suck();
            temp[622] = 0;
        }
        enemyturn = 7;
        if (enemyturn > nummon) {
            round = round + 1;
            rounds = str(round);
            if (round = 8) {
                alldead();
                if (monsterspirit > partyspirit) {
                    gameover();
                }
                if (monsterspirit = partyspirit) {
                    gameover();
                }
                if (monsterspirit < partyspirit) {
                    alldead();
                }
            }
            music_volume = 80;
            wait(5);
            music_volume = 100;
            enemyturn = 0;
            playerturn = 1;
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            render();
            For(x = 1; x < numchars2; x++) {
                defend[x] = 0;
                entity.specframe[battlechar[x]] = 0;
            }

            battleselections();
        }
        ELSE { render(); }
    }
    if (enemyturn = 7) {
        if (deadmon[enemyturn] = 1) {
            enemyhit();
            entity.specframe[battlemonster[7]] = 2;
            wait(10);
            if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                playsound(battleeffect[3], 64, 128);
            }
            entity.specframe[battlemonster[7]] = 3;
            wait(10);
            entity.specframe[battlemonster[7]] = 4;
            wait(10);
            entity.specframe[battlemonster[7]] = 5;
            wait(10);
            if (mongroup = 3 && inbatmon[7] = 3) {
                entity.specframe[battlemonster[7]] = 10;
                wait(10);
                entity.specframe[battlemonster[7]] = 11;
                wait(10);
                entity.specframe[battlemonster[7]] = 12;
                wait(10);
            }
            entity.specframe[battlemonster[7]] = 0;
            wait(10);
            if (temp[622] = 1 && mongroup =
                    3 && inbatmon[enemyturn] = 2 && miss =
                        0 && deadmon[enemyturn] = 1) {
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, "Bloodsuck!!");
                    gotoxy(305, 440);
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 1296, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 1,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 2,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 1, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 3,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 2, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 4,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 3, 0, 0);
                wait(5);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 4, 0, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 1297, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 0, 0);
            }
            enemydamages();
        }
        if (temp[622] = 1 && mongroup = 3 && inbatmon[enemyturn] = 2 && miss =
                                            0 && deadmon[enemyturn] = 1) {
            suck();
            temp[622] = 0;
        }
        enemyturn = 8;
        if (enemyturn > nummon) {
            round = round + 1;
            rounds = str(round);
            if (round = 8) {
                alldead();
                if (monsterspirit > partyspirit) {
                    gameover();
                }
                if (monsterspirit = partyspirit) {
                    gameover();
                }
                if (monsterspirit < partyspirit) {
                    alldead();
                }
            }
            music_volume = 80;
            wait(5);
            music_volume = 100;
            enemyturn = 0;
            playerturn = 1;
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            render();
            For(x = 1; x < numchars2; x++) {
                defend[x] = 0;
                entity.specframe[battlechar[x]] = 0;
            }

            battleselections();
        }
        ELSE { render(); }
    }
    if (enemyturn = 8) {
        if (deadmon[enemyturn] = 1) {
            enemyhit();
            entity.specframe[battlemonster[8]] = 2;
            wait(10);
            if (enemyturn > 0 && monstertype[enemyturn] = 0) {
                playsound(battleeffect[3], 64, 128);
            }
            entity.specframe[battlemonster[8]] = 3;
            wait(10);
            entity.specframe[battlemonster[8]] = 4;
            wait(10);
            entity.specframe[battlemonster[8]] = 5;
            wait(10);
            if (mongroup = 3 && inbatmon[8] = 3) {
                entity.specframe[battlemonster[8]] = 10;
                wait(10);
                entity.specframe[battlemonster[8]] = 11;
                wait(10);
                entity.specframe[battlemonster[8]] = 12;
                wait(10);
            }
            entity.specframe[battlemonster[8]] = 0;
            wait(10);
            if (temp[622] = 1 && mongroup =
                    3 && inbatmon[enemyturn] = 2 && miss =
                        0 && deadmon[enemyturn] = 1) {
                battle = 90;
                while (battle = 90) {
                    render();
                    TCopySprite(300, screeny - 65, 320, 64, textbox);
                    gotoxy(305, 420);
                    printstring(1, "Bloodsuck!!");
                    gotoxy(305, 440);
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        battle = 91;
                    }
                }
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 1296, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 1,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget], 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 2,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 1, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 3,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 2, 0, 0);
                wait(5);
                alterftile(battlelocx[montarget] + 1, battlelocy[montarget] - 4,
                    1296, 0);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 3, 0, 0);
                wait(5);
                alterftile(
                    battlelocx[montarget] + 1, battlelocy[montarget] - 4, 0, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 1297, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 4, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 3, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 2, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 1297, 0);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn] - 1, 0, 0);
                wait(5);
                alterftile(battlemonlocx[enemyturn] + 1,
                    battlemonlocy[enemyturn], 0, 0);
            }
            enemydamages();
        }
        if (temp[622] = 1 && mongroup = 3 && inbatmon[enemyturn] = 2 && miss =
                                            0 && deadmon[enemyturn] = 1) {
            suck();
            temp[622] = 0;
        }
        enemyturn = 9;
        if (enemyturn > nummon) {
            round = round + 1;
            rounds = str(round);
            if (round = 8) {
                alldead();
                if (monsterspirit > partyspirit) {
                    gameover();
                }
                if (monsterspirit = partyspirit) {
                    gameover();
                }
                if (monsterspirit < partyspirit) {
                    alldead();
                }
            }
            music_volume = 80;
            wait(5);
            music_volume = 100;
            enemyturn = 0;
            playerturn = 1;
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            if (deadchar[playerturn] = 0) {
                playerturn = playerturn + 1;
            }
            render();
            For(x = 1; x < numchars2; x++) {
                defend[x] = 0;
                entity.specframe[battlechar[x]] = 0;
            }
            battleselections();
        }
    }
}

void enemdamages() {
    For(x = 1; x < nummon2; x++) {
        if (mongroup = 2) {
            switch (inbatmon[x]) {
            case 0:
                ebasedamage[x] = 10 + random(5);
            case 1:
                ebasedamage[x] = 10 + random(10);
            }
        }
        if (mongroup = 1) {
            switch (inbatmon[x]) {
            case 0:
                ebasedamage[x] = 5 + random(5);
            case 1:
                ebasedamage[x] = 10 + random(5);
            case 2:
                ebasedamage[x] = 10 + random(15);
            case 3:
                ebasedamage[x] = 7 + random(5);
            case 4:
                ebasedamage[x] = 10 + random(10);
            case 5:
                ebasedamage[x] = 15 + random(5);
            case 6:
                ebasedamage[x] = 10 + random(5);
            }
        }
        if (mongroup = 3) {
            switch (inbatmon[x]) {
            case 0:
                ebasedamage[x] = 10 + random(5);
            case 1:
                ebasedamage[x] = 10 + random(10);
            case 2:
                ebasedamage[x] = 10 + random(10);
            case 3:
                ebasedamage[x] = 16 + random(5);
            case 4:
                ebasedamage[x] = 10 + random(10);
            case 5:
                ebasedamage[x] = 15 + random(5);
            case 6:
                ebasedamage[x] = 10 + random(5);
            case 7:
                ebasedamage[x] = 10 + random(5);
            case 8:
                ebasedamage[x] = 10 + random(5);
            case 9:
                ebasedamage[x] = 25 + random(10);
            case 10:
                ebasedamage[x] = 50 + random(15);
            case 11:
                ebasedamage[x] = 20 + random(15);
            case 12:
                ebasedamage[x] = 20 + random(15);
            }
        }
    }
}
void battlemonsters() {
    For(x = 1; x < nummon2; x++) {

        if (mongroup = 2) {
            switch (inbatmon[x]) {
            case 0:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "sco.chr");
                monsta[inbatmon[x]] = 3;
                monstr[inbatmon[x]] = 4;
                monac[inbatmon[x]] = 7;
                monexp[inbatmon[x]] = 6;
                monattcond[inbatmon[x]] = 1;
                mattcondperc[inbatmon[x]] = 20;
                monws[inbatmon[x]] = 85;
                monsterhp[x] = 20;
                monstermaxhp[x] = 20;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 5;
                ebasedamage[inbatmon[x]] = 10 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 1:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "she.chr");
                monsta[inbatmon[x]] = 5;
                monstr[inbatmon[x]] = 6;
                monac[inbatmon[x]] = 10;
                monexp[inbatmon[x]] = 20;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 2;
                mattcondperc[inbatmon[x]] = 20;
                monsterhp[x] = 45;
                monstermaxhp[x] = 45;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 10;
                ebasedamage[inbatmon[x]] = 10 + random(10);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            }
        }
        if (mongroup = 1) {
            switch (inbatmon[x]) {
            case 0:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "ooze.chr");
                monsta[inbatmon[x]] = 2;
                monstr[inbatmon[x]] = 2;
                monac[inbatmon[x]] = 5;
                monws[inbatmon[x]] = 100;
                if (regroup = 0) {
                    monsterhp[x] = 10;
                }
                monattcond[inbatmon[x]] = 1;
                mattcondperc[inbatmon[x]] = 10;
                monexp[inbatmon[x]] = 3;
                monstermaxhp[x] = 10;
                fireweakness[inbatmon[x]] = 10;
                iceweakness[inbatmon[x]] = 2;
                ebasedamage[inbatmon[x]] = 5 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 1;
            case 1:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "spi.chr");
                monsta[inbatmon[x]] = 3;
                monstr[inbatmon[x]] = 4;
                monac[inbatmon[x]] = 7;
                monexp[inbatmon[x]] = 6;
                monattcond[inbatmon[x]] = 1;
                mattcondperc[inbatmon[x]] = 20;
                monws[inbatmon[x]] = 85;
                if (regroup = 0) {
                    monsterhp[x] = 20;
                }
                monstermaxhp[x] = 20;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 5;
                ebasedamage[inbatmon[x]] = 10 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 2:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "para.chr");
                monsta[inbatmon[x]] = 5;
                monstr[inbatmon[x]] = 6;
                monac[inbatmon[x]] = 10;
                monexp[inbatmon[x]] = 20;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 2;
                mattcondperc[inbatmon[x]] = 20;
                if (regroup = 0) {
                    monsterhp[x] = 45;
                }
                monstermaxhp[x] = 45;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 10;
                ebasedamage[inbatmon[x]] = 10 + random(10);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 3:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "rat.chr");
                monsta[inbatmon[x]] = 1;
                monstr[inbatmon[x]] = 3;
                monac[inbatmon[x]] = 6;
                monexp[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 1;
                mattcondperc[inbatmon[x]] = 10;
                if (regroup = 0) {
                    monsterhp[x] = 15;
                }
                monstermaxhp[x] = 15;
                fireweakness[inbatmon[x]] = 10;
                iceweakness[inbatmon[x]] = 2;
                ebasedamage[inbatmon[x]] = 7 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 2;
            case 4:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "rshab.chr");
                monsta[inbatmon[x]] = 5;
                monstr[inbatmon[x]] = 5;
                monac[inbatmon[x]] = 7;
                monexp[inbatmon[x]] = 25;
                monattcond[inbatmon[x]] = 10;
                mattcondperc[inbatmon[x]] = 15;
                monws[inbatmon[x]] = 85;
                if (regroup = 0) {
                    monsterhp[x] = 70;
                }
                monstermaxhp[x] = 70;
                fireweakness[inbatmon[x]] = 9;
                iceweakness[inbatmon[x]] = 0;
                ebasedamage[inbatmon[x]] = 10 + random(10);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 5:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "fgilb.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 5;
                monac[inbatmon[x]] = 8;
                monws[inbatmon[x]] = 85;
                monexp[inbatmon[x]] = 20;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                if (regroup = 0) {
                    monsterhp[x] = 80;
                }
                monstermaxhp[x] = 80;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 5;
                ebasedamage[inbatmon[x]] = 15 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 6:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "gmemb.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 5;
                monac[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                monexp[inbatmon[x]] = 15;
                if (regroup = 0) {
                    monsterhp[x] = 60;
                }
                monstermaxhp[x] = 60;
                fireweakness[inbatmon[x]] = 6;
                iceweakness[inbatmon[x]] = 6;
                ebasedamage[inbatmon[x]] = 10 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            }
        }
        if (mongroup = 3) {
            switch (inbatmon[x]) {
            case 0:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "rslime.chr");
                monsta[inbatmon[x]] = 2;
                monstr[inbatmon[x]] = 4;
                monac[inbatmon[x]] = 5;
                monws[inbatmon[x]] = 100;
                if (regroup = 0) {
                    monsterhp[x] = 20;
                }
                monattcond[inbatmon[x]] = 9;
                mattcondperc[inbatmon[x]] = 10;
                monexp[inbatmon[x]] = 7;
                monstermaxhp[x] = 20;
                fireweakness[inbatmon[x]] = 10;
                iceweakness[inbatmon[x]] = 2;
                ebasedamage[inbatmon[x]] = 10 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 1;
            case 1:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "gspi.chr");
                monsta[inbatmon[x]] = 3;
                monstr[inbatmon[x]] = 4;
                monac[inbatmon[x]] = 8;
                monexp[inbatmon[x]] = 20;
                monattcond[inbatmon[x]] = 1;
                mattcondperc[inbatmon[x]] = 20;
                monws[inbatmon[x]] = 85;
                if (regroup = 0) {
                    monsterhp[x] = 50;
                }
                monstermaxhp[x] = 50;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 5;
                ebasedamage[inbatmon[x]] = 10 + random(10);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 2:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "leech.chr");
                monsta[inbatmon[x]] = 5;
                monstr[inbatmon[x]] = 6;
                monac[inbatmon[x]] = 10;
                monexp[inbatmon[x]] = 10;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                if (regroup = 0) {
                    monsterhp[x] = 25;
                }
                monstermaxhp[x] = 25;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 10;
                ebasedamage[inbatmon[x]] = 10 + random(10);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 3:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "batb.chr");
                monsta[inbatmon[x]] = 2;
                monstr[inbatmon[x]] = 4;
                monac[inbatmon[x]] = 5;
                monexp[inbatmon[x]] = 14;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 1;
                mattcondperc[inbatmon[x]] = 20;
                if (regroup = 0) {
                    monsterhp[x] = 25;
                }
                monstermaxhp[x] = 25;
                fireweakness[inbatmon[x]] = 10;
                iceweakness[inbatmon[x]] = 2;
                ebasedamage[inbatmon[x]] = 16 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 2;
            case 4:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "gob.chr");
                monsta[inbatmon[x]] = 5;
                monstr[inbatmon[x]] = 5;
                monac[inbatmon[x]] = 7;
                monexp[inbatmon[x]] = 25;
                monattcond[inbatmon[x]] = 10;
                mattcondperc[inbatmon[x]] = 15;
                monws[inbatmon[x]] = 85;
                if (regroup = 0) {
                    monsterhp[x] = 70;
                }
                monstermaxhp[x] = 70;
                fireweakness[inbatmon[x]] = 9;
                iceweakness[inbatmon[x]] = 0;
                ebasedamage[inbatmon[x]] = 10 + random(10);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 5:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "fgilb.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 5;
                monac[inbatmon[x]] = 8;
                monws[inbatmon[x]] = 85;
                monexp[inbatmon[x]] = 20;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                monsterhp[x] = 80;
                monstermaxhp[x] = 80;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 5;
                ebasedamage[inbatmon[x]] = 15 + random(5);
                weakmonster[x] = 0;
            case 6:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "gob.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 5;
                monac[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                monexp[inbatmon[x]] = 15;
                if (regroup = 0) {
                    monsterhp[x] = 60;
                }
                monstermaxhp[x] = 60;
                fireweakness[inbatmon[x]] = 6;
                iceweakness[inbatmon[x]] = 6;
                ebasedamage[inbatmon[x]] = 10 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 7:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "gob2.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 5;
                monac[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                monexp[inbatmon[x]] = 25;
                if (regroup = 0) {
                    monsterhp[x] = 60;
                }
                monstermaxhp[x] = 60;
                fireweakness[inbatmon[x]] = 6;
                iceweakness[inbatmon[x]] = 6;
                ebasedamage[inbatmon[x]] = 10 + random(5);
                monstertype[x] = 1;
                weakmonster[x] = 0;
            case 8:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "gob.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 5;
                monac[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                monexp[inbatmon[x]] = 25;
                if (regroup = 0) {
                    monsterhp[x] = 60;
                }
                monstermaxhp[x] = 60;
                fireweakness[inbatmon[x]] = 6;
                iceweakness[inbatmon[x]] = 6;
                ebasedamage[inbatmon[x]] = 10 + random(5);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 9:
                battlemonster[x] =
                    entityspawn(battlemonlocx[x], battlemonlocy[x], "octo.chr");
                monsta[inbatmon[x]] = 5;
                monstr[inbatmon[x]] = 6;
                monac[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 85;
                monattcond[inbatmon[x]] = 11;
                mattcondperc[inbatmon[x]] = 0;
                monexp[inbatmon[x]] = 150;
                if (regroup = 0) {
                    monsterhp[x] = 500;
                }
                monstermaxhp[x] = 500;
                fireweakness[inbatmon[x]] = 10;
                iceweakness[inbatmon[x]] = 0;
                ebasedamage[inbatmon[x]] = 25 + random(10);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 10:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "trollb.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 6;
                monac[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 25;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                monexp[inbatmon[x]] = 160;
                if (regroup = 0) {
                    monsterhp[x] = 600;
                }
                monstermaxhp[x] = 600;
                fireweakness[inbatmon[x]] = 10;
                iceweakness[inbatmon[x]] = 0;
                ebasedamage[inbatmon[x]] = 50 + random(15);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 11:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "jacal.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 6;
                monac[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 75;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 0;
                monexp[inbatmon[x]] = 50;
                if (regroup = 0) {
                    monsterhp[x] = 100;
                }
                monstermaxhp[x] = 100;
                fireweakness[inbatmon[x]] = 8;
                iceweakness[inbatmon[x]] = 8;
                ebasedamage[inbatmon[x]] = 20 + random(15);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            case 12:
                battlemonster[x] = entityspawn(
                    battlemonlocx[x], battlemonlocy[x], "armab.chr");
                monsta[inbatmon[x]] = 6;
                monstr[inbatmon[x]] = 6;
                monac[inbatmon[x]] = 7;
                monws[inbatmon[x]] = 95;
                monattcond[inbatmon[x]] = 0;
                mattcondperc[inbatmon[x]] = 100;
                monexp[inbatmon[x]] = 200;
                if (regroup = 0) {
                    monsterhp[x] = 300;
                }
                monstermaxhp[x] = 300;
                fireweakness[inbatmon[x]] = 5;
                iceweakness[inbatmon[x]] = 5;
                ebasedamage[inbatmon[x]] = 20 + random(15);
                monstertype[x] = 0;
                weakmonster[x] = 0;
            }
        }
    }
}
void battlechars() {
    For(x = 1; x < 11; x++) {
        switch (inparty[x]) {
        case 1:
            if (weapontype[equippedweapon[inparty[x]]] =
                    1 && equippedweapon[inparty[x]] = 1) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ellb.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 0) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ellb3.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 10) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ellb5.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 11) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ellb4.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] =
                    1 && equippedweapon[inparty[x]] = 3) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ellb6.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 2) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ellb7.chr");
            }
        case 2:
            battlechar[x] =
                entityspawn(battlelocx[x], battlelocy[x], "pgg.chr");
        case 4:
            if (weapontype[equippedweapon[inparty[x]]] = 0) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ljackb4.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 11) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ljackb.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] =
                    1 && equippedweapon[inparty[x]] = 1) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ljackb2.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 10) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ljackb3.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] =
                    1 && equippedweapon[inparty[x]] = 3) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ljackb4.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 2) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ljackb5.chr");
            }
        case 6:
            if (weapontype[equippedweapon[inparty[x]]] = 0) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ltanb4.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 10) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ltanb.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] =
                    1 && equippedweapon[inparty[x]] = 1) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ltanb2.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 11) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ltanb3.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] =
                    1 && equippedweapon[inparty[x]] = 3) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ltanb4.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 2) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "ltanb5.chr");
            }
        case 7:
            if (weapontype[equippedweapon[inparty[x]]] = 0) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "lfreub7.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 2) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "lfreub6.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 11) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "lfreub4.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] =
                    1 && equippedweapon[inparty[x]] = 1) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "lfreub2.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] = 10) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "lfreub5.chr");
            }
            if (weapontype[equippedweapon[inparty[x]]] =
                    1 && equippedweapon[inparty[x]] = 3) {
                battlechar[x] =
                    entityspawn(battlelocx[x], battlelocy[x], "lfreub3.chr");
            }
        }
    }
}

void foundmoney(int x, int y, int z, int a) {
    found = "Found ";
    crow = " Crowns!";
    gainedmoney = found + str(a) + crow;
    wait(5);
    settile(x, y, 2, z);
    wait(5);
    settile(x, y, 2, z + 1);
    wait(5);
    settile(x, y, 2, z + 2);
    wait(5);
    settile(x, y, 2, z + 1);
    wait(5);
    settile(x, y, 2, z);
    wait(5);
    settile(x, y, 2, 0);
    wait(5);
    stext(0, gainedmoney, "", "");
    crowns = crowns + a;
}

void door(int x, int y) {
    soundeffect[2] = cachesound("open1.wav");
    playsound(soundeffect[2], 128, 128);
    warp(x, y);
    soundeffect[3] = cachesound("close17.wav");
    playsound(soundeffect[3], 128, 128);
    wait(30);
    freeallsounds();
}

void stairs(int x, int y) {
    soundeffect[4] = cachesound("walk.wav");
    playsound(soundeffect[4], 128, 128);
    wait(100);
    warp(x, y);
    freeallsounds();
}

void entrance(int x, int y) {
    warp(x, y);
    freeallsounds();
}

void nothing() {
    soundeffect[2] = cachesound("open1.wav");
    playsound(soundeffect[2], 64, 128);
    stext(0, "Nothing useful.", "", "");
}

void hammeri(int x, int y, int a) {
    entlocx = entity.tx[ent1];
    entlocy = entity.ty[ent1];
    if (hammer[1] = 1) {
        soundeffect[1] = cachesound("Whip.wav");
        playsound(soundeffect[1], 64, 128);
        alterftile(x, y, a, 0);
        alterftile(x, y, a + 1, 0);
        vara[22] = random(100);
        vara[23] = random(20) + 1;
        if (vara[22] < 50) {
            foundmoney(x, y, 239, vara[23]);
        }
    }
}

void nailedshut() { stext(0, "The box is nailed shut.", "", ""); }

void lock() {
    soundeffect[5] = cachesound("lock1.wav");
    playsound(soundeffect[5], 128, 128);
    stext(0, "It's locked.", "", "");
    freeallsounds();
}

void point(int x, int y) {
    soundeffect[6] = cachesound("point1.wav");
    playsound(soundeffect[6], 64, 128);
    alterftile(x, y, 0, 0);
    runpoints = runpoints + 10;
    rupoints = str(runpoints);
}

void point2(int x, int y) {
    soundeffect[6] = cachesound("point1.wav");
    playsound(soundeffect[6], 64, 128);
    alterftile(x, y, 0, 0);
    runpoints = runpoints + 20;
    rupoints = str(runpoints);
}

void point3(int x, int y) {
    soundeffect[6] = cachesound("point1.wav");
    playsound(soundeffect[6], 64, 128);
    alterftile(x, y, 0, 0);
    runpoints = runpoints + 50;
    rupoints = str(runpoints);
}

void door2(int x, int y) {
    soundeffect[6] = cachesound("hinge1.wav");
    playsound(soundeffect[6], 128, 128);
    warp(x, y);
    soundeffect[7] = cachesound("hinge2.wav");
    playsound(soundeffect[7], 128, 128);
    wait(10);
    freeallsounds();
}

void door3(int x, int y) {
    soundeffect[9] = cachesound("mopen.wav");
    playsound(soundeffect[9], 128, 128);
    warp(x, y);
    soundeffect[8] = cachesound("mclose.wav");
    playsound(soundeffect[8], 128, 128);
    wait(20);
    freeallsounds();
}

void door4(int x, int y, int a, int b) {
    soundeffect[2] = cachesound("open1.wav");
    playsound(soundeffect[2], 128, 128);
    fadeout(0, 0);
    cameratracking = 0;
    xwin = a;
    ywin = b;
    wait(10);
    warp(x, y);
    fadein(0, 0);
    palettemorph(100, 0, 0, 67, 63);
    soundeffect[3] = cachesound("close17.wav");
    playsound(soundeffect[3], 128, 128);
    cameratracking = 1;
    wait(10);
    freeallsounds();
}

void entrance2(int x, int y, int a, int b) {
    fadeout(0, 0);
    cameratracking = 0;
    xwin = a;
    ywin = b;
    wait(10);
    warp(x, y);
    fadein(0, 0);
    palettemorph(100, 0, 0, 67, 63);
    cameratracking = 1;
    wait(10);
    freeallsounds();
}

void stairs2(int x, int y, int a, int b) {
    soundeffect[4] = cachesound("walk.wav");
    playsound(soundeffect[4], 64, 128);
    fadeout(0, 0);
    cameratracking = 0;
    xwin = a;
    ywin = b;
    wait(100);
    warp(x, y);
    fadein(0, 0);
    palettemorph(100, 0, 0, 67, 63);
    freeallsounds();
    cameratracking = 1;
}

void chest(int x, int y) {
    soundeffect[1] = cachesound("open2.wav");
    playsound(soundeffect[1], 128, 128);
    alterftile(x, y - 1, 0, 0);
    alterbtile(x, y, 1185, 1);
    alterftile(x, y - 1, 775, 0);
    wait(20);
    freeallsounds();
}

void chest4(int x, int y) {
    soundeffect[1] = cachesound("open2.wav");
    playsound(soundeffect[1], 128, 128);
    alterftile(x, y, 2592, 1);
    alterftile(x, y + 1, 2591, 0);
    wait(20);
    freeallsounds();
}

void stue(int a, int x, int y) {
    soundeffect[3] = cachesound("stat.wav");
    if (entlocx < x) {
        entitymove(a, "R1");
        playsound(soundeffect[3], 128, 128);
    }
    if (entlocx > x) {
        entitymove(a, "L1");
        playsound(soundeffect[3], 128, 128);
    }
    if (entlocx = x && entlocy < y) {
        entitymove(a, "D1");
        playsound(soundeffect[3], 128, 128);
    }
    if (entlocx = x && entlocy > y) {
        entitymove(a, "U1");
        playsound(soundeffect[3], 128, 128);
    }
}

void splash() {
    soundeffect[2] = cachesound("splash.wav");
    playsound(soundeffect[2], 128, 128);
}

void chest2(int x, int y) {
    soundeffect[1] = cachesound("open2.wav");
    playsound(soundeffect[1], 128, 128);
    alterftile(x, y - 1, 1184, 1);
    freeallsounds();
}

void chest3(int x, int y, int a, int b) {
    soundeffect[1] = cachesound("open2.wav");
    playsound(soundeffect[1], 128, 128);
    alterftile(x, y, a, 0);
    alterftile(x, y - 1, b, 1);
    freeallsounds();
}

void juoksu() {
    entity.speed[ent1] = 5;
    unpress(key[42]);
}

void juoksu2() {
    entity.speed[ent1] = 4;
    unpress(key[29]);
}

void musicfadein(int x) {
    music_volume = 10;
    wait(x);
    music_volume = 20;
    wait(x);
    music_volume = 30;
    wait(x);
    music_volume = 40;
    wait(x);
    music_volume = 50;
    wait(x);
    music_volume = 60;
    wait(x);
    music_volume = 70;
    wait(x);
    music_volume = 80;
    wait(x);
    music_volume = 90;
    wait(x);
    music_volume = 100;
}

void musicfade(int x) {
    music_volume = 90;
    wait(x);
    music_volume = 80;
    wait(x);
    music_volume = 70;
    wait(x);
    music_volume = 60;
    wait(x);
    music_volume = 50;
    wait(x);
    music_volume = 40;
    wait(x);
    music_volume = 30;
    wait(x);
    music_volume = 20;
    wait(x);
    music_volume = 10;
    wait(x);
    music_volume = 0;
}

void wchest(int x, int y, int a) {
    soundeffect[6] = cachesound("hinge1.wav");
    playsound(soundeffect[6], 128, 128);
    alterftile(x, y, a, 1);
    wait(30);
    freeallsounds();
}

void SystemStartup() {
    if (system_initialized)
        return;
    if (LoadFont("text.fnt") != 1) {
        Exit("Could not get TEXT.FNT in appropriate slot.");
    }
    textbox = LoadImage("textboxi.pcx");
    font = loadfont("text2.fnt");
    font2 = loadfont("text3.fnt");
    font3 = loadfont("text4.fnt");
    font4 = loadfont("text5.fnt");
    textfont = loadfont("text.fnt");
    speechpic = LoadRaw("speech.spc");
    Cachemainsounds();
    system_initialized = 1;
    allowconsole(0);
    freemenupics();
}

void CacheMainSounds() {
    snd_null = CacheSound("null.wav");
    nullSound = cacheSound("null.wav");
}

void Text(int picidx, string a, string b, string c) {
    int i, j;
    Unpress(1);
    dodo = 0;
    i = screenx / 2 - 160;
    j = screeny - 65;

    while (!b1) {
        while (timer) {
            ProcessEntities();
            timer--;
        }
        Render();
        i = screenx / 2 - 160;
        j = screeny - 65;
        if (screenx != 256) {
            TCopySprite(i + 1, j - 51, 32, 32, speechpic + (picidx * 1024) + 1);
            if (boxes = 0) {
                TCopySprite(i, j, 320, 64, textbox);
            }
            GotoXY(i + 6, j + 5);
            PrintString(textfont, a);
            GotoXY(i + 6, j + 24);
            PrintString(textfont, b);
            GotoXY(i + 6, j + 43);
            PrintString(textfont, c);
        }
        if (screenx == 256) {
            TCopySprite(1, j - 51, 32, 32, speechpic + (picidx * 1024) + 1);
            if (boxes = 0) {
                ScaleSprite(1, j, 320, 64, 256 - 2, 64, textbox);
            }
            GotoXY(1 + 6, j + 5);
            PrintString(textfont, a);
            GotoXY(1 + 6, j + 24);
            PrintString(textfont, b);
            GotoXY(1 + 6, j + 43);
            PrintString(textfont, c);
        }
        ShowPage();
        UpdateControls();
        i++;
    }
    Unpress(1);
    timer = 0;
}

void null() { unpress(key[57]); }

void entfacing(int a) {
    entlocx = entity.tx[ent1];
    entlocy = entity.ty[ent1];
    entlocx2 = entity.tx[a];
    entlocy2 = entity.ty[a];
    if (entlocx < entlocx2&& entlocy = entlocy2) {
        entity.specframe[a] = 15;
    }
    if (entlocx > entlocx2&& entlocy = entlocy2) {
        entity.specframe[a] = 10;
    }
    if (entlocy < entlocy2&& entlocx = entlocx2) {
        entity.specframe[a] = 5;
    }
    if (entlocy > entlocy2&& entlocx = entlocx2) {
        entity.specframe[a] = 20;
    }
}

void Zquake(int dur, int in) /*by Zingoshi*/
{
    int a, ox, oy;
    ox = xwin;
    oy = ywin;
    cameratracking = 0;
    for (a = 0; a < dur; a++) {
        processentities();
        render();
        xwin = ox + (random(2 * in) - in);
        ywin = oy + (random(2 * in) - in);
        showpage();
        wait(2);
    }
    xwin = ox;
    ywin = oy;
    cameratracking = 1;
}

void Zzoom() /*by Zingoshi*/
{
    int zoomr, zt, zm;
    zoomr = malloc(screenx * screeny);
    zm = screenx / 64;
    for (zt = 0; zt < zm; zt++) {
        grabregion(0, 0, screenx - 1, screeny - 1, zoomr);
        tscalesprite(0 - 32, 0 - 32, screenx - 1, screeny - 1, screenx + 64,
            screeny + 64, zoomr);
        showpage();
    }
    free(zoomr);
}

void Zlantern() /*by Zingoshi*/
{
    int px, py, a, r, r2, Zlantern_flag;
    if (Zlantern_flag != 0) {
        r = Zlantern_flag;
        px = entity.x[player] - xwin; // gets the screen location of the player
        py = entity.y[player] - ywin;
        rectfill(0, 0, screenx, py - r, 0);           // top rect
        rectfill(0, py + r, screenx, screeny, 0);     // bot rect
        rectfill(0, py - r, px - r, py + r, 0);       // left rect
        rectfill(px + r, py - r, screenx, py + r, 0); // right rect

        r2 = r / 2;
        for (a = 0; a < r2; a++) {
            // circle(px,py,r+a,0);
            circle(px + 1, py + 1, r + a, 0);
            circle(px - 1, py + 1, r + a, 0);
            circle(px - 1, py - 1, r + a, 0);
            circle(px + 1, py - 1, r + a, 0);
        }
    }
}

void Zburst(int x, int y, int maxsize) /*by Zingoshi*/
{
    int r, a, m2, m3;
    m2 = maxsize / 2;
    m3 = m2 / 2;
    setlucent(1);
    for (a = 0; a < 40; a++) {
        render();
        circlefill(x, y, m2 + random(m3), 223 + random(15));
        for (r = 0; r < 15; r++) {
            // the 223 is the start colour reference
            circlefill(x + (m2 - random(maxsize)), y + (m2 - random(maxsize)),
                random(m3), 223 + random(15));
            line(x, y, x + (m2 - random(maxsize)), y + (m2 - random(maxsize)),
                223 + random(15));
        }
        circlefill(x, y, 2 + random(m3), 223 + random(15));
        showpage();
    }
    setlucent(0);
}

void SText(int p, string a, string b, string c) { Text(p, a, b, c); }

void AlterBTile(int x, int y, int value, int obs) {
    SetTile(x, y, 0, value);
    SetTile(x, y, 6, obs);
}

void AlterFTile(int x, int y, int value, int obs) {
    SetTile(x, y, 1, value);
    SetTile(x, y, 6, obs);
}

void ChangeZone(int x, int y, int newzone) { SetTile(x, y, 7, newzone); }

void MapSwitch(string mapname, int x, int y, int fade) {
    current_map = mapname;
    gotox = x;
    gotoy = y;
    Map(mapname);
}

void InitializeMap() {
    SystemStartup();
    SetPlayer(EntitySpawn(gotox, gotoy, "edrake.chr"));
}

void Warp(int x, int y) {
    FadeOut(25, 1);
    entity.x[player] = x * 16;
    entity.y[player] = y * 16;
    entity.tx[player] = x;
    entity.ty[player] = y;
    Render();
    ShowPage();
    FadeIn(25, 1);
}

void Wait(int delay) {
    int i;

    timer = 0;
    i = 0;
    while (i < delay) {
        while (timer) {
            timer--;
            i++;
            ProcessEntities();
        }
        UpdateControls();
        Render();
        ShowPage();
    }
    timer = 0;
}

void FadeOut(int span, int upd) {
    int n, k;

    timer = 0;
    n = 0;
    k = span;
    while (k > 0) {
        while (timer) {
            if (upd)
                ProcessEntities();
            k--;
            timer--;
            n++;
        }
        if (upd) {
            Render();
            ShowPage();
        }
        if (n > span)
            n = span;
        PaletteMorph(0, 0, 0, 0, 63 - (n * 63 / span));
    }
    timer = 0;
}

void FadeIn(int span, int upd) {
    int n, k;

    timer = 0;
    n = 0;
    k = span;
    while (k > 0) {
        while (timer) {
            if (upd)
                ProcessEntities();
            k--;
            timer--;
            n++;
        }
        if (upd) {
            Render();
            ShowPage();
        }
        if (n > span)
            n = span;
        PaletteMorph(0, 0, 0, 0, n * 63 / span);
    }
    timer = 0;
}

void none() { unpress(key[57]); }

void WhiteOut(int span) {
    int n, k;

    timer = 0;
    n = 0;
    k = span;
    while (k > 0) {
        while (timer) {
            k--;
            timer--;
            n++;
        }
        if (n > span)
            n = span;
        PaletteMorph(63, 63, 63, n * 100 / span, 63);
    }
    timer = 0;
}

void WhiteIn(int span) {
    int n, k;

    timer = 0;
    n = 0;
    k = span;
    while (k > 0) {
        while (timer) {
            k--;
            timer--;
            n++;
        }
        if (n > span)
            n = span;
        PaletteMorph(63, 63, 63, 100 - (n * 63 / span), 63);
    }
    PaletteMorph(0, 0, 0, 0, 63);
    timer = 0;
}

void del(int dy, int ren, int sho, int ents) {
    timer = 0;
    i = 0;
    while (i < dy) {
        while (timer) {
            timer--;
            i++;
            If(ents) { ProcessEntities(); }
        }
        UpdateControls();
        If(ren) { Render(); }
        If(sho) { ShowPage(); }
    }
    timer = 0;
}

void PauseSpecEnt(int SpecEnt) /*by Earsoft*/
{
    Spd[SpecEnt] =
        Entity.Speed[SpecEnt]; // This stores the specified entity's speed in
                               // a temporary array.
    Entity.Speed[SpecEnt] = 9; // This stops the specified entity from moving.
}

void UnpauseSpecEnt(int SpecEnt) /*by Earsoft*/
{
    Entity.Speed[SpecEnt] = Spd[SpecEnt]; // This restores the entity's speed.
}

void PauseEnt() // by Earsoft
{
    For(e = 0; e <= 12; e++) {
        If(Entity.Ty[e] = Entity.Ty[Player] + 1 && Entity.Tx[e] =
                              Entity.Tx[Player]) Ent[0] = e;
        If(Entity.Ty[e] = Entity.Ty[Player] - 1 && Entity.Tx[e] =
                              Entity.Tx[Player]) Ent[1] = e;
        If(Entity.Tx[e] = Entity.Tx[Player] - 1 && Entity.Ty[e] =
                              Entity.Ty[Player]) Ent[2] = e;
        If(Entity.Tx[e] = Entity.Tx[Player] + 1 && Entity.Ty[e] =
                              Entity.Ty[Player]) Ent[3] = e;
    }
    Speed = Entity.Speed[Ent[Entity.Facing[Player]]];
    Entity.Speed[Ent[Entity.Facing[Player]]] = 9;
}

void UnpauseEnt() {
    Entity.Speed[Ent[Entity.Facing[Player]]] = Speed; // by Earsoft
}

void showtime() {
    // gotoXY(480,295);
    // printstring(1,"Time: ");
    // printstring(1,time);
    gotoXY(480, 295);
    printstring(1, "Money: ");
    printstring(1, crownamount);
    printstring(1, " Cr");
    if (shop = 0) {
        gotoXY(20, 460);
        printstring(1, "Location: ");
        printstring(1, location);
    }
}

void switchpics() {
    switch (menupnt[9]) {
    case 1:
        switch (inparty[1]) {
        case 1:
            charpics[1] = charpic[2];
            h = 50;
            j = 64;
        case 2:
            charpics[1] = charpic[4];
            h = 50;
            j = 64;
        case 3:
            charpics[1] = charpic[6];
            h = 60;
            j = 64;
        case 4:
            charpics[1] = charpic[4];
            h = 50;
            j = 64;
        case 5:
            charpics[1] = charpic[8];
            h = 50;
            j = 64;
        case 6:
            charpics[1] = charpic[6];
            h = 50;
            j = 64;
        case 7:
            charpics[1] = charpic[7];
            h = 50;
            j = 64;
        }
    case 2:
        switch (inparty[2]) {
        case 1:
            charpics[2] = charpic[2];
            h = 50;
            j = 64;
        case 2:
            charpics[2] = charpic[4];
            h = 50;
            j = 64;
        case 3:
            charpics[2] = charpic[6];
            h = 60;
            j = 64;
        case 4:
            charpics[2] = charpic[4];
            h = 50;
            j = 64;
        case 5:
            charpics[2] = charpic[8];
            h = 50;
            j = 64;
        case 6:
            charpics[2] = charpic[6];
            h = 50;
            j = 64;
        case 7:
            charpics[2] = charpic[7];
            h = 50;
            j = 64;
        }
    case 3:
        switch (inparty[3]) {
        case 1:
            charpics[3] = charpic[2];
            h = 50;
            j = 64;
        case 2:
            charpics[3] = charpic[4];
            h = 50;
            j = 64;
        case 3:
            charpics[3] = charpic[6];
            h = 60;
            j = 64;
        case 4:
            charpics[3] = charpic[4];
            h = 50;
            j = 64;
        case 5:
            charpics[3] = charpic[8];
            h = 50;
            j = 64;
        case 6:
            charpics[3] = charpic[6];
            h = 50;
            j = 64;
        case 7:
            charpics[3] = charpic[7];
            h = 50;
            j = 64;
        }
    case 4:
        switch (inparty[4]) {
        case 1:
            charpics[4] = charpic[2];
            h = 50;
            j = 64;
        case 2:
            charpics[4] = charpic[4];
            h = 50;
            j = 64;
        case 3:
            charpics[4] = charpic[6];
            h = 60;
            j = 64;
        case 4:
            charpics[4] = charpic[4];
            h = 50;
            j = 64;
        case 5:
            charpics[4] = charpic[8];
            h = 50;
            j = 64;
        case 6:
            charpics[4] = charpic[6];
            h = 50;
            j = 64;
        case 7:
            charpics[4] = charpic[7];
            h = 50;
            j = 64;
        }
    }
}
void picplaces() {
    switch (x) {
    case 1:
        picplacey[1] = 30;
        picplace2y[1] = 60;
        textplace[1] = 40;
    case 2:
        picplacey[2] = 130;
        picplace2y[2] = 160;
        textplace[2] = 140;
    case 3:
        picplacey[3] = 230;
        picplace2y[3] = 260;
        textplace[3] = 240;
    case 4:
        picplacey[4] = 330;
        picplace2y[4] = 360;
        textplace[4] = 340;
    }
}
void shownames() {
    if (inparty[k] = 1) {
        printstring(1, charname[1] + " " + "Drake");
    }
    if (inparty[k] = 2) {
        printstring(1, "Pegleg Peter");
    }
    if (inparty[k] = 3) {
        printstring(1, charname[3] + " " + "Crawler");
    }
    if (inparty[k] = 4) {
        printstring(1, charname[4] + " " + "Morgan");
    }
    if (inparty[k] = 5) {
        printstring(1, charname[5] + " " + "Thunderhammer");
    }
    if (inparty[k] = 6) {
        printstring(1, charname[6] + " " + "van Shryder");
    }
    if (inparty[k] = 7) {
        printstring(1, charname[7] + " " + "Gilron");
    }
}
void showstats() {
    charlevel[k] = str(chalevel[k]);
    chaexp[k] = str(charexp[k]);
    charhp[k] = str(chahp[k]);
    charmaxhp[k] = str(chamaxhp[k]);
    printstring(1, "Hp: ");
    printstring(1, charhp[k]);
    printstring(1, "/");
    printstring(1, charmaxhp[k]);
    gotoxy(20, m + 20);
    charmp[k] = str(champ[k]);
    charmaxmp[k] = str(chamaxmp[k]);
    printstring(1, "Mp: ");
    printstring(1, charMp[k]);
    printstring(1, "/");
    printstring(1, charmaxMp[k]);
    gotoxy(20, m + 40);
    printstring(1, "Level: ");
    printstring(1, charlevel[k]);
    gotoxy(20, m + 60);
    printstring(1, "Exp: ");
    printstring(1, chaexp[k]);
}
void showstatus() {
    switch (menupnt[9]) {
    case 1:
        switch (inparty[1]) {
        case 1:
            k = 1;
            m = 90;
            Tcopysprite(250, 40, 156, 385, charpotr[1]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[1] + " " + "Drake");
            gotoxy(20, m);
            showstats();
        case 2:
            k = 2;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[3]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, "Pegleg Peter");
            gotoxy(20, m);
            showstats();
        case 3:
            k = 3;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[5]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[3] + " " + "Crawler");
            gotoxy(20, m);
            showstats();
        case 4:
            k = 4;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[4]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[4] + " " + "Morgan");
            gotoxy(20, m);
            showstats();
        case 5:
            k = 5;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[7]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[5] + " " + "Thunderhammer");
            gotoxy(20, m);
            showstats();
        case 6:
            k = 6;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[6]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[6] + " " + "van Shryder");
            gotoxy(20, m);
            showstats();
        case 7:
            k = 7;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[7]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[7] + " " + "Gilron");
            gotoxy(20, m);
            showstats();
        }
    case 2:
        switch (inparty[2]) {
        case 1:
            k = 1;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[1]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[1] + " " + "Drake");
            gotoxy(20, m);
            showstats();
        case 2:
            k = 2;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[3]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, "Pegleg Peter");
            gotoxy(20, m);
            showstats();
        case 3:
            k = 3;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[5]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[3] + " " + "Crawler");
            gotoxy(20, m);
            showstats();
        case 4:
            k = 4;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[4]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[4] + " " + "Morgan");
            gotoxy(20, m);
            showstats();
        case 5:
            k = 5;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[7]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[5] + " " + "Thunderhammer");
            gotoxy(20, m);
            showstats();
        case 6:
            k = 6;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[6]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[6] + " " + "van Shryder");
            gotoxy(20, m);
            showstats();
        case 7:
            k = 7;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[7]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[7] + " " + "Gilron");
            gotoxy(20, m);
            showstats();
        }
    case 3:
        switch (inparty[3]) {
        case 1:
            k = 1;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[1]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[1] + " " + "Drake");
            gotoxy(20, m);
            showstats();
        case 2:
            k = 2;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[3]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, "Pegleg Peter");
            gotoxy(20, m);
            showstats();
        case 3:
            k = 3;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[5]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[3] + " " + "Crawler");
            gotoxy(20, m);
            showstats();
        case 4:
            k = 4;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[4]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[4] + " " + "Morgan");
            gotoxy(20, m);
            showstats();
        case 5:
            k = 5;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[7]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[5] + " " + "Thunderhammer");
            gotoxy(20, m);
            showstats();
        case 6:
            k = 6;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[6]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[6] + " " + "van Shryder");
            gotoxy(20, m);
            showstats();
        case 7:
            k = 7;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[7]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[7] + " " + "Gilron");
            gotoxy(20, m);
            showstats();
        }
    case 4:
        switch (inparty[4]) {
        case 1:
            k = 1;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[1]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[1] + " " + "Drake");
            gotoxy(20, m);
            showstats();
        case 2:
            k = 2;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[3]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, "Pegleg Peter");
            gotoxy(20, m);
            showstats();
        case 3:
            k = 3;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[5]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[3] + " " + "Crawler");
            gotoxy(20, m);
            showstats();
        case 4:
            k = 4;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[4]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[4] + " " + "Morgan");
            gotoxy(20, m);
            showstats();
        case 5:
            k = 5;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[7]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[5] + " " + "Thunderhammer");
            gotoxy(20, m);
            showstats();
        case 6:
            k = 6;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[6]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[6] + " " + "van Shryder");
            gotoxy(20, m);
            showstats();
        case 7:
            k = 7;
            m = 90;
            Tcopysprite(280, 70, 96, 96, charpic[7]);
            Gotoxy(20, 50);
            printstring(1, "Name: ");
            printstring(1, charname[7] + " " + "Gilron");
            gotoxy(20, m);
            showstats();
        }
    }
}
void showcharinfo() {
    For(x = 1; x < 5; x++) {
        picplaces();
        if (inparty[x] = 1) {
            charhp[1] = str(chahp[1]);
            charmaxhp[1] = str(chamaxhp[1]);
            charlevel[1] = str(chalevel[1]);
            chaexp[1] = str(charexp[1]);
            Tcopysprite(30, picplacey[x], 96, 96, charpic[1]);
            gotoXY(160, textplace[x]);
            printstring(1, charname[1] + " " + "Drake");
            gotoXY(160, textplace[x] + 20);
            printstring(1, "Hp: ");
            printstring(1, charhp[1]);
            printstring(1, "/");
            printstring(1, charmaxhp[1]);
            gotoXY(160, textplace[x] + 40);
            charmp[1] = str(champ[1]);
            charmaxmp[1] = str(chamaxmp[1]);
            printstring(1, "Mp: ");
            printstring(1, charMp[1]);
            printstring(1, "/");
            printstring(1, charmaxMp[1]);
            gotoxy(300, textplace[x] + 60);
            printstring(1, "L: ");
            printstring(1, charlevel[1]);
            gotoXY(160, textplace[x] + 60);
            printstring(1, "Exp: ");
            printstring(1, chaexp[1]);
            printstring(1, " / " + tnext[1]);
        }
        if (inparty[x] = 2) {
            charhp[2] = str(chahp[2]);
            charmaxhp[2] = str(chamaxhp[2]);
            charlevel[2] = str(chalevel[2]);
            chaexp[2] = str(charexp[2]);
            Tcopysprite(30, picplacey[x], 96, 96, charpic[3]);
            gotoXY(160, textplace[x]);
            printstring(1, "Pegleg Peter");
            gotoXY(160, textplace[x] + 20);
            printstring(1, "Hp: ");
            printstring(1, charhp[2]);
            printstring(1, "/");
            printstring(1, charmaxhp[2]);
            gotoXY(160, textplace[x] + 40);
            charmp[2] = str(champ[2]);
            charmaxmp[2] = str(chamaxmp[2]);
            printstring(1, "Mp: ");
            printstring(1, charMp[2]);
            printstring(1, "/");
            printstring(1, charmaxMp[2]);
            gotoxy(300, textplace[x] + 60);
            printstring(1, "L: ");
            printstring(1, charlevel[2]);
            gotoXY(160, textplace[x] + 60);
            printstring(1, "Exp: ");
            printstring(1, chaexp[2]);
            printstring(1, " / " + tnext[2]);
        }
        if (inparty[x] = 3) {
            charhp[3] = str(chahp[3]);
            charmaxhp[3] = str(chamaxhp[3]);
            charlevel[3] = str(chalevel[3]);
            chaexp[3] = str(charexp[3]);
            Tcopysprite(30, picplacey[x], 96, 96, charpic[5]);
            gotoXY(160, textplace[x]);
            printstring(1, charname[3] + " " + "Crawler");
            gotoXY(160, textplace[x] + 20);
            printstring(1, "Hp: ");
            printstring(1, charhp[3]);
            printstring(1, "/");
            printstring(1, charmaxhp[3]);
            gotoXY(160, textplace[x] + 40);
            charmp[3] = str(champ[3]);
            charmaxmp[3] = str(chamaxmp[3]);
            printstring(1, "Mp: ");
            printstring(1, charMp[3]);
            printstring(1, "/");
            printstring(1, charmaxMp[3]);
            gotoxy(300, textplace[x] + 60);
            printstring(1, "L: ");
            printstring(1, charlevel[3]);
            gotoXY(160, textplace[x] + 60);
            printstring(1, "Exp: ");
            printstring(1, chaexp[3]);
            printstring(1, " / " + tnext[3]);
        }
        if (inparty[x] = 4) {
            charhp[4] = str(chahp[4]);
            charmaxhp[4] = str(chamaxhp[4]);
            charlevel[4] = str(chalevel[4]);
            chaexp[4] = str(charexp[4]);
            Tcopysprite(30, picplacey[x], 96, 96, charpic[4]);
            gotoXY(160, textplace[x]);
            printstring(1, charname[4] + " " + "Morgan");
            gotoXY(160, textplace[x] + 20);
            printstring(1, "Hp: ");
            printstring(1, charhp[4]);
            printstring(1, "/");
            printstring(1, charmaxhp[4]);
            gotoXY(160, textplace[x] + 40);
            charmp[4] = str(champ[4]);
            charmaxmp[4] = str(chamaxmp[4]);
            printstring(1, "Mp: ");
            printstring(1, charMp[4]);
            printstring(1, "/");
            printstring(1, charmaxMp[4]);
            gotoxy(300, textplace[x] + 60);
            printstring(1, "L: ");
            printstring(1, charlevel[4]);
            gotoXY(160, textplace[x] + 60);
            printstring(1, "Exp: ");
            printstring(1, chaexp[4]);
            printstring(1, " / " + tnext[4]);
        }
        if (inparty[x] = 5) {
            charhp[5] = str(chahp[5]);
            charmaxhp[5] = str(chamaxhp[5]);
            charlevel[5] = str(chalevel[5]);
            chaexp[5] = str(charexp[5]);
            Tcopysprite(30, picplacey[x], 96, 96, charpic[7]);
            gotoXY(160, textplace[x]);
            printstring(1, charname[5] + " " + "Thunderhammer");
            gotoXY(160, textplace[x] + 20);
            printstring(1, "Hp: ");
            printstring(1, charhp[5]);
            printstring(1, "/");
            printstring(1, charmaxhp[5]);
            gotoXY(160, textplace[x] + 40);
            charmp[3] = str(champ[5]);
            charmaxmp[3] = str(chamaxmp[5]);
            printstring(1, "Mp: ");
            printstring(1, charMp[5]);
            printstring(1, "/");
            printstring(1, charmaxMp[5]);
            gotoxy(300, textplace[x] + 60);
            printstring(1, "L: ");
            printstring(1, charlevel[5]);
            gotoXY(160, textplace[x] + 60);
            printstring(1, "Exp: ");
            printstring(1, chaexp[5]);
            printstring(1, " / " + tnext[5]);
        }
        if (inparty[x] = 6) {
            charhp[6] = str(chahp[6]);
            charmaxhp[6] = str(chamaxhp[6]);
            charlevel[6] = str(chalevel[6]);
            chaexp[6] = str(charexp[6]);
            Tcopysprite(30, picplacey[x], 96, 96, charpic[6]);
            gotoXY(160, textplace[x]);
            printstring(1, charname[6] + " " + "van Shryder");
            gotoXY(160, textplace[x] + 20);
            printstring(1, "Hp: ");
            printstring(1, charhp[6]);
            printstring(1, "/");
            printstring(1, charmaxhp[6]);
            gotoXY(160, textplace[x] + 40);
            charmp[6] = str(champ[6]);
            charmaxmp[6] = str(chamaxmp[6]);
            printstring(1, "Mp: ");
            printstring(1, charMp[6]);
            printstring(1, "/");
            printstring(1, charmaxMp[6]);
            gotoxy(300, textplace[x] + 60);
            printstring(1, "L: ");
            printstring(1, charlevel[6]);
            gotoXY(160, textplace[x] + 60);
            printstring(1, "Exp: ");
            printstring(1, chaexp[6]);
            printstring(1, " / " + tnext[6]);
        }
        if (inparty[x] = 7) {
            charhp[7] = str(chahp[7]);
            charmaxhp[7] = str(chamaxhp[7]);
            charlevel[7] = str(chalevel[7]);
            chaexp[7] = str(charexp[7]);
            Tcopysprite(30, picplacey[x], 96, 96, charpic[7]);
            gotoXY(160, textplace[x]);
            printstring(1, charname[7] + " " + "Gilron");
            gotoXY(160, textplace[x] + 20);
            printstring(1, "Hp: ");
            printstring(1, charhp[7]);
            printstring(1, "/");
            printstring(1, charmaxhp[7]);
            gotoXY(160, textplace[x] + 40);
            charmp[7] = str(champ[7]);
            charmaxmp[7] = str(chamaxmp[7]);
            printstring(1, "Mp: ");
            printstring(1, charMp[7]);
            printstring(1, "/");
            printstring(1, charmaxMp[7]);
            gotoxy(300, textplace[x] + 60);
            printstring(1, "L: ");
            printstring(1, charlevel[7]);
            gotoXY(160, textplace[x] + 60);
            printstring(1, "Exp: ");
            printstring(1, chaexp[7]);
            printstring(1, " / " + tnext[7]);
        }
    }
}
void statmenu() {
    nullSound = cacheSound("null.wav");
    openMenuSound = cacheSound("menuopen.wav");
    clicksound = cachesound("click.wav");
    menuItemSound = cacheSound("menumove.wav");
    loadmenupics();
    setresolution(640, 480);
    playsound(menuitemsound, 64, 128);
    mmenu = 1;
    entlocx = entity.tx[ent1];
    entlocy = entity.ty[ent1];
    cameratracking = 0;
    menupnt[1] = 1;
    menupnt[2] = 1;
    menupnt[3] = 1;
    menupnt[4] = 1;
    menupnt[5] = 1;
    menupnt[9] = 1;
    crownamount = str(crowns);
    if (crowns > 9999) {
        crowns = 9999;
    }
    unpress(key[57]);
    while (mmenu = 1) {
        palettemorph(0, 0, 0, 0, 63);
        Tcopysprite(0, 0, 640, 480, mpic1);
        showtime();
        showcharinfo();
        charconditions();
        gotoXY(510, 55);
        printstring(1, "Exit");
        gotoXY(510, 75);
        printstring(1, "Status");
        gotoXY(510, 95);
        printstring(1, "Item");
        gotoXY(510, 115);
        printstring(1, "Skills");
        gotoXY(510, 135);
        printstring(1, "Magic");
        gotoXY(510, 155);
        printstring(1, "Equip");
        gotoXY(510, 175);
        printstring(1, "Info");
        gotoXY(510, 195);
        printstring(1, "Positions");
        gotoXY(510, 215);
        printstring(1, "Options");
        gotoXY(510, 235);
        printstring(1, "Walkman");
        gotoxy(510, 255);
        printstring(1, "Quit game");
        TscaleSprite(500, 35 + (20 * menupnt[1]), 7, 9, 7, 9, pointer1);
        showpage();
        updatecontrols();
        if (key[80]) {
            menupnt[1]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            menupnt[1]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[1] < 1) { menupnt[1] = 11; }
        if (menupnt[1] > 11) {
            menupnt[1] = 1;
        }
        if (key[29]) {
            c = 0;
            mmenu = 1;
        }
        if (key[56]) {
            unpress(key[56]);
            mmenu = 0;
            render();
            setresolution(360, 240);
            if (vara[2] = 1) {
                palettemorph(100, 0, 0, 67, 63);
            }
            if (vara[2] = 0) {
                palettemorph(0, 0, 0, 0, 63);
            }
            unpress(key[28]);
            freemenupics();
            cameratracking = 1;
        }

        if (key[28]) {
            switch (menupnt[1]) {
            case 1:
                unpress(key[28]);
                mmenu = 0;
                render();
                setresolution(360, 240);
                if (vara[2] = 1) {
                    palettemorph(100, 0, 0, 67, 63);
                }
                if (vara[2] = 0) {
                    palettemorph(0, 0, 0, 0, 63);
                }
                unpress(key[28]);
                freemenupics();
                cameratracking = 1;
            case 7:
                unpress(key[28]);
                mmenu = 7;
                info();
            case 11:
                fadeout(1, 1);
                unpress(key[28]);
                musicfade(10);
                exit("Thanks for playing TCoD.");
            case 3:
                mmenu = 2;
                itemnames();
                itempage = 1;
                itemmenu();
            case 6:
                mmenu = 6;
                equipmenu();

            case 9:
                mmenu = 8;
                optionmenu();
            case 10:
                if (songstoneamount > 0) {
                    mmenu = 10;
                    jukeboxmenu();
                }
            case 2:
                unpress(key[28]);
                mmenu = 18;
                while (mmenu = 18) {
                    Tcopysprite(0, 0, 640, 480, mpic1);
                    showtime();
                    showcharinfo();
                    gotoXY(510, 55);
                    printstring(1, "Exit");
                    gotoXY(510, 75);
                    printstring(1, "Status");
                    gotoXY(510, 95);
                    printstring(1, "Item");
                    gotoXY(510, 115);
                    printstring(1, "Skills");
                    gotoXY(510, 135);
                    printstring(1, "Magic");
                    gotoXY(510, 155);
                    printstring(1, "Equip");
                    gotoXY(510, 175);
                    printstring(1, "Info");
                    gotoXY(510, 195);
                    printstring(1, "Positions");
                    gotoXY(510, 215);
                    printstring(1, "Options");
                    gotoXY(510, 235);
                    printstring(1, "Walkman");
                    gotoxy(510, 255);
                    printstring(1, "Quit game");
                    charconditions();
                    TscaleSprite(
                        500, 35 + (20 * menupnt[1]), 7, 9, 7, 9, pointer1);
                    TscaleSprite(
                        10, 0 + (100 * menupnt[9]), 7, 9, 7, 9, pointer1);
                    showpage();
                    updatecontrols();
                    if (key[80]) {
                        menupnt[9]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[9]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[9] < 1) { menupnt[9] = 4; }
                    if (menupnt[9] > 4) {
                        menupnt[9] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        mmenu = 1;
                    }
                    if (key[28]) {
                        mmenu = 3;
                        weaponnames();
                        armornames();
                        equipmentnames();
                        relicnames();
                        stat = menupnt[9];
                        statusmenu();
                    }
                }
            case 4:
                mmenu = 4;
                skillsmenu();
            case 5:
                unpress(key[28]);
                mmenu = 18;
                while (mmenu = 18) {
                    Tcopysprite(0, 0, 640, 480, mpic1);
                    showtime();
                    showcharinfo();
                    gotoXY(510, 55);
                    printstring(1, "Exit");
                    gotoXY(510, 75);
                    printstring(1, "Status");
                    gotoXY(510, 95);
                    printstring(1, "Item");
                    gotoXY(510, 115);
                    printstring(1, "Skills");
                    gotoXY(510, 135);
                    printstring(1, "Magic");
                    gotoXY(510, 155);
                    printstring(1, "Equip");
                    gotoXY(510, 175);
                    printstring(1, "Info");
                    gotoXY(510, 195);
                    printstring(1, "Positions");
                    gotoXY(510, 215);
                    printstring(1, "Options");
                    gotoXY(510, 235);
                    printstring(1, "Walkman");
                    gotoxy(510, 255);
                    printstring(1, "Quit game");
                    charconditions();
                    TscaleSprite(
                        500, 35 + (20 * menupnt[1]), 7, 9, 7, 9, pointer1);
                    TscaleSprite(
                        10, 0 + (100 * menupnt[9]), 7, 9, 7, 9, pointer1);
                    showpage();
                    updatecontrols();
                    if (key[80]) {
                        menupnt[9]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[9]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[9] < 1) { menupnt[9] = 4; }
                    if (menupnt[9] > 4) {
                        menupnt[9] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        mmenu = 1;
                    }
                    if (key[28] && inparty[menupnt[9]] = 1) {
                        mmenu = 5;
                        magi = menupnt[9];
                        magicmenu();
                    }
                }
            case 8:
            }
        }
    }
}

void equipmenu() {
    loadmenupics();
    equipmentnames();
    weaponnames();
    armornames();
    relicnames();
    menupnt[20] = 1;
    menupnt[4] = 1;
    menupnt[45] = 1;
    unpress(key[28]);
    while (mmenu = 6) {
        render();
        equipmenuparts();
        TscaleSprite(0, 90 + (10 * menupnt[4]), 7, 9, 7, 9, pointer1);
        GotoXY(500, 340);
        printstring(1, "WEAPONS");
        GotoXY(500, 360);
        printstring(1, "ARMORS");
        GotoXY(500, 380);
        printstring(1, "EQUIPMENTS");
        GotoXY(500, 400);
        printstring(1, "RELICS");
        GotoXY(500, 420);
        printstring(1, "SPEC.EQUIPM.");
        GotoXY(500, 440);
        printstring(1, "UNEQUIP");
        switch (menupnt[20]) {
        case 1:
            TscaleSprite(490, 340, 7, 9, 7, 9, pointer1);
            shweapons();
            gotoxy(10, 80);
            printstring(font, "Weapon name:");
            gotoxy(120, 80);
            printstring(font, "Weapon type:");
            gotoxy(220, 80);
            printstring(font, "Weapon description:");
            gotoxy(360, 80);
            printstring(font, "Amount:");
        case 2:
            TscaleSprite(490, 360, 7, 9, 7, 9, pointer1);
            sharmors();
            gotoxy(10, 80);
            printstring(font, "Armor name:");
            gotoxy(120, 80);
            printstring(font, "Armor type:");
            gotoxy(220, 80);
            printstring(font, "Armor description:");
            gotoxy(360, 80);
            printstring(font, "Amount:");
        case 3:
            TscaleSprite(490, 380, 7, 9, 7, 9, pointer1);
            shequs();
            gotoxy(10, 80);
            printstring(font, "Equipm. name:");
            gotoxy(120, 80);
            printstring(font, "Equipm. desc.:");
            gotoxy(360, 80);
            printstring(font, "Amount:");
        case 4:
            TscaleSprite(490, 400, 7, 9, 7, 9, pointer1);
            shrelics();
            gotoxy(10, 80);
            printstring(font, "Relic name:");
            gotoxy(120, 80);
            printstring(font, "Relic description:");
            gotoxy(360, 80);
            printstring(font, "Amount:");
        case 5:
            TscaleSprite(490, 420, 7, 9, 7, 9, pointer1);
            gotoxy(10, 80);
            printstring(font, "S.equipm.name:");
            gotoxy(120, 80);
            printstring(font, "S.equipm.desc.:");
            gotoxy(360, 80);
            printstring(font, "Amount:");
        case 6:
            TscaleSprite(490, 440, 7, 9, 7, 9, pointer1);
        }
        showtime();
        showpage();
        updatecontrols();
        If(key[80]) {
            menupnt[20]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            menupnt[20]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[20] < 1) { menupnt[20] = 6; }
        if (menupnt[20] > 6) {
            menupnt[20] = 1;
        }
        if (key[28] && menupnt[20] = 6) {
            unpress(key[28]);
            menupnt[39] = 1;
            mmenu = 60;
            while (mmenu = 60) {
                render();
                equipmenuparts();
                GotoXY(500, 340);
                printstring(1, "WEAPONS");
                GotoXY(500, 360);
                printstring(1, "ARMORS");
                GotoXY(500, 380);
                printstring(1, "EQUIPMENTS");
                GotoXY(500, 400);
                printstring(1, "RELICS");
                GotoXY(500, 420);
                printstring(1, "SPEC.EQUIPM.");
                switch (menupnt[20]) {
                case 1:
                    TscaleSprite(490, 340, 7, 9, 7, 9, pointer1);
                    shweapons();
                    gotoxy(10, 80);
                    printstring(font, "Weapon name:");
                    gotoxy(120, 80);
                    printstring(font, "Weapon type:");
                    gotoxy(220, 80);
                    printstring(font, "Weapon description:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                case 2:
                    TscaleSprite(490, 360, 7, 9, 7, 9, pointer1);
                    sharmors();
                    gotoxy(10, 80);
                    printstring(font, "Armor name:");
                    gotoxy(120, 80);
                    printstring(font, "Armor type:");
                    gotoxy(220, 80);
                    printstring(font, "Armor description:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                case 3:
                    TscaleSprite(490, 380, 7, 9, 7, 9, pointer1);
                    shequs();
                    gotoxy(10, 80);
                    printstring(font, "Equipm. name:");
                    gotoxy(120, 80);
                    printstring(font, "Equipm. desc.:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                case 4:
                    TscaleSprite(490, 400, 7, 9, 7, 9, pointer1);
                    shrelics();
                    gotoxy(10, 80);
                    printstring(font, "Relic name:");
                    gotoxy(120, 80);
                    printstring(font, "Relic description:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                case 5:
                    TscaleSprite(490, 420, 7, 9, 7, 9, pointer1);
                    gotoxy(10, 80);
                    printstring(font, "S.equipm.name:");
                    gotoxy(120, 80);
                    printstring(font, "S.equipm.desc.:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                }
                Tcopysprite(465, 450, 179, 29, mpic3);
                gotoxy(490, 455);
                printstring(font, "Unequip who?");
                switch (menupnt[39]) {
                case 1:
                    TscaleSprite(480, 70, 7, 9, 7, 9, pointer1);
                case 2:
                    TscaleSprite(540, 70, 7, 9, 7, 9, pointer1);
                case 3:
                    TscaleSprite(480, 130, 7, 9, 7, 9, pointer1);
                case 4:
                    TscaleSprite(540, 130, 7, 9, 7, 9, pointer1);
                case 5:
                    TscaleSprite(480, 190, 7, 9, 7, 9, pointer1);
                case 6:
                    TscaleSprite(540, 190, 7, 9, 7, 9, pointer1);
                case 7:
                    TscaleSprite(480, 250, 7, 9, 7, 9, pointer1);
                case 8:
                    TscaleSprite(540, 250, 7, 9, 7, 9, pointer1);
                }
                showtime();
                showpage();
                updatecontrols();
                If(key[77]) {
                    menupnt[39]++;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(key[75]) {
                    menupnt[39]--;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(menupnt[39] < 1) { menupnt[39] = numchars; }
                If(menupnt[39] > numchars) { menupnt[39] = 1; }
                If(key[80]) {
                    menupnt[39]++;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(key[72]) {
                    menupnt[39]--;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(menupnt[39] < 1) { menupnt[39] = numchars; }
                if (menupnt[39] > numchars) {
                    menupnt[39] = 1;
                }
                if (key[28]) {
                    unpress(key[28]);
                    mmenu = 63;
                    charhp[inparty[menupnt[39]]] =
                        str(chahp[inparty[menupnt[39]]]);
                    charmaxhp[inparty[menupnt[39]]] =
                        str(chamaxhp[inparty[menupnt[39]]]);
                    charmp[inparty[menupnt[39]]] =
                        str(champ[inparty[menupnt[39]]]);
                    charmaxmp[inparty[menupnt[39]]] =
                        str(chamaxmp[inparty[menupnt[39]]]);
                    charstr[inparty[menupnt[39]]] =
                        str(chastr[inparty[menupnt[39]]]);
                    charsta[inparty[menupnt[39]]] =
                        str(chasta[inparty[menupnt[39]]]);
                    charagi[inparty[menupnt[39]]] =
                        str(chaagi[inparty[menupnt[39]]]);
                    chara[inparty[menupnt[39]]] =
                        str(chaa[inparty[menupnt[39]]]);
                    charint[inparty[menupnt[39]]] =
                        str(chaint[inparty[menupnt[39]]]);
                    charac[inparty[menupnt[39]]] =
                        str(chrac[inparty[menupnt[39]]]);
                    charws[inparty[menupnt[39]]] =
                        str(chaws[inparty[menupnt[39]]]);
                    menupnt[20] = 1;
                    while (mmenu = 63) {
                        render();
                        equipmenuparts();
                        GotoXY(500, 340);
                        printstring(1, "WEAPONS");
                        GotoXY(500, 360);
                        printstring(1, "ARMORS");
                        GotoXY(500, 380);
                        printstring(1, "EQUIPMENTS");
                        GotoXY(500, 400);
                        printstring(1, "RELICS");
                        GotoXY(500, 420);
                        printstring(1, "SPEC.EQUIPM.");
                        Tcopysprite(465, 450, 179, 29, mpic3);
                        gotoxy(490, 455);
                        printstring(font, "Unequip what?");
                        tcopysprite(10, 160, 178, 318, mpic6);
                        Tcopysprite(
                            15, 165, 96, 96, charpic[inparty[menupnt[39]]]);
                        gotoxy(15, 265);
                        printstring(font, charname[inparty[menupnt[39]]]);
                        gotoxy(15, 285);
                        printstring(
                            font, "Hp: " + charhp[inparty[menupnt[39]]] +
                                      " / " + charmaxhp[inparty[menupnt[39]]]);
                        gotoxy(15, 295);
                        printstring(
                            font, "Mp: " + charmp[inparty[menupnt[39]]] +
                                      " / " + charmaxmp[inparty[menupnt[39]]]);
                        gotoxy(15, 305);
                        printstring(
                            font, "Str: " + charstr[inparty[menupnt[39]]]);
                        gotoxy(15, 315);
                        printstring(
                            font, "Sta: " + charsta[inparty[menupnt[39]]]);
                        gotoxy(15, 325);
                        printstring(
                            font, "Agi: " + charagi[inparty[menupnt[39]]]);
                        gotoxy(15, 335);
                        printstring(font, "A: " + chara[inparty[menupnt[39]]]);
                        gotoxy(15, 345);
                        printstring(
                            font, "Int: " + charint[inparty[menupnt[39]]]);
                        gotoxy(15, 355);
                        printstring(
                            font, "Ac: " + charac[inparty[menupnt[39]]]);
                        gotoxy(15, 365);
                        printstring(
                            font, "Ws: " + charws[inparty[menupnt[39]]]);
                        gotoxy(15, 385);
                        printstring(font,
                            "Weapon: " +
                                weaponname
                                    [equippedweapon[inparty[menupnt[39]]]]);
                        gotoxy(15, 395);
                        printstring(font,
                            "Shield: " +
                                armorname
                                    [equippedshield[inparty[menupnt[39]]]]);
                        gotoxy(15, 405);
                        printstring(font,
                            "Armor: " +
                                armorname[equippedarmor[inparty[menupnt[39]]]]);
                        gotoxy(15, 415);
                        printstring(font,
                            "Helmet: " +
                                armorname
                                    [equippedhelmet[inparty[menupnt[39]]]]);
                        gotoxy(15, 425);
                        printstring(font,
                            "Legs: " +
                                armorname[equippedlegs[inparty[menupnt[39]]]]);
                        gotoxy(15, 435);
                        printstring(font,
                            "Ac1: " +
                                equipmentname
                                    [equippedequipment[inparty[menupnt[39]]]]);
                        gotoxy(15, 445);
                        printstring(font,
                            "Ac1: " +
                                relicname[equippedrelic[inparty[menupnt[39]]]]);
                        switch (menupnt[20]) {
                        case 1:
                            TscaleSprite(5, 385, 7, 9, 7, 9, pointer1);
                        case 2:
                            TscaleSprite(5, 395, 7, 9, 7, 9, pointer1);
                        case 3:
                            TscaleSprite(5, 405, 7, 9, 7, 9, pointer1);
                        case 4:
                            TscaleSprite(5, 415, 7, 9, 7, 9, pointer1);
                        case 5:
                            TscaleSprite(5, 425, 7, 9, 7, 9, pointer1);
                        case 6:
                            TscaleSprite(5, 435, 7, 9, 7, 9, pointer1);
                        case 7:
                            TscaleSprite(5, 445, 7, 9, 7, 9, pointer1);
                        }
                        showtime();
                        showpage();
                        updatecontrols();
                        If(key[80]) {
                            menupnt[20]++;
                            playsound(menuitemsound, 64, 128);
                            del(10, 0, 0, 0);
                        }
                        If(key[72]) {
                            menupnt[20]--;
                            playsound(menuitemsound, 64, 128);
                            del(10, 0, 0, 0);
                        }
                        If(menupnt[20] < 1) { menupnt[20] = 7; }
                        if (menupnt[20] > 7) {
                            menupnt[20] = 1;
                        }
                        if (key[28]) {
                            unpress(key[28]);
                            mmenu = 62;
                            while (mmenu = 62) {
                                render();
                                equipmenuparts();
                                tcopysprite(10, 160, 178, 318, mpic6);
                                Tcopysprite(15, 165, 96, 96,
                                    charpic[inparty[menupnt[39]]]);
                                gotoxy(15, 265);
                                printstring(
                                    font, charname[inparty[menupnt[39]]]);
                                gotoxy(15, 285);
                                printstring(font,
                                    "Hp: " + charhp[inparty[menupnt[39]]] +
                                        " / " +
                                        charmaxhp[inparty[menupnt[39]]]);
                                gotoxy(15, 295);
                                printstring(font,
                                    "Mp: " + charmp[inparty[menupnt[39]]] +
                                        " / " +
                                        charmaxmp[inparty[menupnt[39]]]);
                                gotoxy(15, 305);
                                printstring(font,
                                    "Str: " + charstr[inparty[menupnt[39]]]);
                                gotoxy(15, 315);
                                printstring(font,
                                    "Sta: " + charsta[inparty[menupnt[39]]]);
                                gotoxy(15, 325);
                                printstring(font,
                                    "Agi: " + charagi[inparty[menupnt[39]]]);
                                gotoxy(15, 335);
                                printstring(
                                    font, "A: " + chara[inparty[menupnt[39]]]);
                                gotoxy(15, 345);
                                printstring(font,
                                    "Int: " + charint[inparty[menupnt[39]]]);
                                gotoxy(15, 355);
                                printstring(font,
                                    "Ac: " + charac[inparty[menupnt[39]]]);
                                gotoxy(15, 365);
                                printstring(font,
                                    "Ws: " + charws[inparty[menupnt[39]]]);
                                gotoxy(15, 385);
                                printstring(
                                    font, "Weapon: " +
                                              weaponname[equippedweapon
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 395);
                                printstring(
                                    font, "Shield: " +
                                              armorname[equippedshield
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 405);
                                printstring(
                                    font, "Armor: " +
                                              armorname[equippedarmor
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 415);
                                printstring(
                                    font, "Helmet: " +
                                              armorname[equippedhelmet
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 425);
                                printstring(font,
                                    "Legs: " + armorname[equippedlegs
                                                       [inparty[menupnt[39]]]]);
                                gotoxy(15, 435);
                                printstring(font,
                                    "Ac1: " + equipmentname[equippedequipment
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 445);
                                printstring(font,
                                    "Ac1: " + relicname[equippedrelic
                                                      [inparty[menupnt[39]]]]);
                                Tcopysprite(465, 380, 179, 29, mpic3);
                                Tcopysprite(465, 410, 179, 29, mpic3);
                                switch (menupnt[45]) {
                                case 1:
                                    TscaleSprite(
                                        485, 415, 7, 9, 7, 9, pointer1);
                                case 2:
                                    TscaleSprite(
                                        555, 415, 7, 9, 7, 9, pointer1);
                                }
                                gotoxy(490, 385);
                                printstring(font, "Are you sure?");
                                gotoxy(490, 415);
                                printstring(font, " Yes ");
                                gotoxy(560, 415);
                                printstring(font, " No ");
                                showtime();
                                showpage();
                                updatecontrols();
                                If(key[77]) {
                                    menupnt[45]++;
                                    playsound(menuitemsound, 64, 128);
                                    del(10, 0, 0, 0);
                                }
                                If(key[75]) {
                                    menupnt[45]--;
                                    playsound(menuitemsound, 64, 128);
                                    del(10, 0, 0, 0);
                                }
                                if (menupnt[45] < 1) {
                                    menupnt[45] = 2;
                                }
                                if (menupnt[45] > 2) {
                                    menupnt[45] = 1;
                                }
                                if (key[28] && menupnt[45] = 2) {
                                    unpress(key[28]);
                                    mmenu = 63;
                                }
                                if (key[28] && menupnt[45] = 1) {
                                    unpress(key[28]);
                                    if (menupnt[20] = 1) {
                                        temp[701] = 0;
                                        temp[701] = equippedweapon
                                            [inparty[menupnt[39]]];
                                        equippedweapon[inparty[menupnt[39]]] =
                                            0;
                                        chamaxhp[inparty[menupnt[39]]] =
                                            chamaxhp[inparty[menupnt[39]]] -
                                            whpadd[temp[701]];
                                        chahp[inparty[menupnt[39]]] =
                                            chahp[inparty[menupnt[39]]] -
                                            whpadd[temp[701]];
                                        charhp[inparty[menupnt[39]]] =
                                            str(chahp[inparty[menupnt[39]]]);
                                        charmaxhp[inparty[menupnt[39]]] =
                                            str(chamaxhp[inparty[menupnt[39]]]);
                                        chamaxmp[inparty[menupnt[39]]] =
                                            chamaxmp[inparty[menupnt[39]]] -
                                            wmpadd[temp[701]];
                                        champ[inparty[menupnt[39]]] =
                                            champ[inparty[menupnt[39]]] -
                                            wmpadd[temp[701]];
                                        charmp[inparty[menupnt[39]]] =
                                            str(champ[inparty[menupnt[39]]]);
                                        charmaxmp[inparty[menupnt[39]]] =
                                            str(chamaxmp[inparty[menupnt[39]]]);
                                        chastr[inparty[menupnt[39]]] =
                                            chastr[inparty[menupnt[39]]] -
                                            wstradd[temp[701]];
                                        charstr[inparty[menupnt[39]]] =
                                            str(chastr[inparty[menupnt[39]]]);
                                        chasta[inparty[menupnt[39]]] =
                                            chasta[inparty[menupnt[39]]] -
                                            wstaadd[temp[701]];
                                        charsta[inparty[menupnt[39]]] =
                                            str(chasta[inparty[menupnt[39]]]);
                                        chaagi[inparty[menupnt[39]]] =
                                            chaagi[inparty[menupnt[39]]] -
                                            wagiadd[temp[701]];
                                        charagi[inparty[menupnt[39]]] =
                                            str(chaagi[inparty[menupnt[39]]]);
                                        chaa[inparty[menupnt[39]]] =
                                            chaa[inparty[menupnt[39]]] -
                                            waadd[temp[701]];
                                        chara[inparty[menupnt[39]]] =
                                            str(chaa[inparty[menupnt[39]]]);
                                        chaint[inparty[menupnt[39]]] =
                                            chaint[inparty[menupnt[39]]] -
                                            wintadd[temp[701]];
                                        charint[inparty[menupnt[39]]] =
                                            str(chaint[inparty[menupnt[39]]]);
                                        chrac[inparty[menupnt[39]]] =
                                            chrac[inparty[menupnt[39]]] -
                                            wacadd[temp[701]];
                                        charac[inparty[menupnt[39]]] =
                                            str(chrac[inparty[menupnt[39]]]);
                                        charws[inparty[menupnt[39]]] =
                                            str(chaws[inparty[menupnt[39]]]);
                                        if (inmenuweapon[menupnt[4]] = 22) {
                                            equippedshield
                                                [inparty[menupnt[39]]] = 0;
                                        }
                                        if (temp[701] = 22) {
                                            equippedshield
                                                [inparty[menupnt[39]]] = 0;
                                        }
                                        weaponamount[temp[701]] =
                                            weaponamount[temp[701]] + 1;
                                    }
                                    if (menupnt[20] = 3) {
                                        temp[702] = 0;
                                        temp[702] =
                                            equippedarmor[inparty[menupnt[39]]];
                                        chamaxhp[inparty[menupnt[39]]] =
                                            chamaxhp[inparty[menupnt[39]]] -
                                            armhpadd[temp[702]];
                                        chahp[inparty[menupnt[39]]] =
                                            chahp[inparty[menupnt[39]]] -
                                            armhpadd[temp[702]];
                                        charhp[inparty[menupnt[39]]] =
                                            str(chahp[inparty[menupnt[39]]]);
                                        charmaxhp[inparty[menupnt[39]]] =
                                            str(chamaxhp[inparty[menupnt[39]]]);
                                        chamaxmp[inparty[menupnt[39]]] =
                                            chamaxmp[inparty[menupnt[39]]] -
                                            armmpadd[temp[702]];
                                        champ[inparty[menupnt[39]]] =
                                            champ[inparty[menupnt[39]]] -
                                            armmpadd[temp[702]];
                                        charmp[inparty[menupnt[39]]] =
                                            str(champ[inparty[menupnt[39]]]);
                                        charmaxmp[inparty[menupnt[39]]] =
                                            str(chamaxmp[inparty[menupnt[39]]]);
                                        chastr[inparty[menupnt[39]]] =
                                            chastr[inparty[menupnt[39]]] -
                                            armstradd[temp[702]];
                                        charstr[inparty[menupnt[39]]] =
                                            str(chastr[inparty[menupnt[39]]]);
                                        chasta[inparty[menupnt[39]]] =
                                            chasta[inparty[menupnt[39]]] -
                                            armstaadd[temp[702]];
                                        charsta[inparty[menupnt[39]]] =
                                            str(chasta[inparty[menupnt[39]]]);
                                        chaagi[inparty[menupnt[39]]] =
                                            chaagi[inparty[menupnt[39]]] -
                                            armagiadd[temp[702]];
                                        charagi[inparty[menupnt[39]]] =
                                            str(chaagi[inparty[menupnt[39]]]);
                                        chaa[inparty[menupnt[39]]] =
                                            chaa[inparty[menupnt[39]]] -
                                            armaadd[temp[702]];
                                        chara[inparty[menupnt[39]]] =
                                            str(chaa[inparty[menupnt[39]]]);
                                        chaint[inparty[menupnt[39]]] =
                                            chaint[inparty[menupnt[39]]] -
                                            armintadd[temp[702]];
                                        charint[inparty[menupnt[39]]] =
                                            str(chaint[inparty[menupnt[39]]]);
                                        chrac[inparty[menupnt[39]]] =
                                            chrac[inparty[menupnt[39]]] -
                                            armacadd[temp[702]];
                                        charac[inparty[menupnt[39]]] =
                                            str(chrac[inparty[menupnt[39]]]);
                                        charws[inparty[menupnt[39]]] =
                                            str(chaws[inparty[menupnt[39]]]);
                                        equippedarmor[inparty[menupnt[39]]] = 0;
                                        armoramount[temp[702]] =
                                            armoramount[temp[702]] + 1;
                                    }
                                    if (menupnt[20] = 4) {
                                        temp[703] = 0;
                                        temp[703] = equippedhelmet
                                            [inparty[menupnt[39]]];
                                        chamaxhp[inparty[menupnt[39]]] =
                                            chamaxhp[inparty[menupnt[39]]] -
                                            armhpadd[temp[703]];
                                        chahp[inparty[menupnt[39]]] =
                                            chahp[inparty[menupnt[39]]] -
                                            armhpadd[temp[703]];
                                        charhp[inparty[menupnt[39]]] =
                                            str(chahp[inparty[menupnt[39]]]);
                                        charmaxhp[inparty[menupnt[39]]] =
                                            str(chamaxhp[inparty[menupnt[39]]]);
                                        chamaxmp[inparty[menupnt[39]]] =
                                            chamaxmp[inparty[menupnt[39]]] -
                                            armmpadd[temp[703]];
                                        champ[inparty[menupnt[39]]] =
                                            champ[inparty[menupnt[39]]] -
                                            armmpadd[temp[703]];
                                        charmp[inparty[menupnt[39]]] =
                                            str(champ[inparty[menupnt[39]]]);
                                        charmaxmp[inparty[menupnt[39]]] =
                                            str(chamaxmp[inparty[menupnt[39]]]);
                                        chastr[inparty[menupnt[39]]] =
                                            chastr[inparty[menupnt[39]]] -
                                            armstradd[temp[703]];
                                        charstr[inparty[menupnt[39]]] =
                                            str(chastr[inparty[menupnt[39]]]);
                                        chasta[inparty[menupnt[39]]] =
                                            chasta[inparty[menupnt[39]]] -
                                            armstaadd[temp[703]];
                                        charsta[inparty[menupnt[39]]] =
                                            str(chasta[inparty[menupnt[39]]]);
                                        chaagi[inparty[menupnt[39]]] =
                                            chaagi[inparty[menupnt[39]]] -
                                            armagiadd[temp[703]];
                                        charagi[inparty[menupnt[39]]] =
                                            str(chaagi[inparty[menupnt[39]]]);
                                        chaa[inparty[menupnt[39]]] =
                                            chaa[inparty[menupnt[39]]] -
                                            armaadd[temp[703]];
                                        chara[inparty[menupnt[39]]] =
                                            str(chaa[inparty[menupnt[39]]]);
                                        chaint[inparty[menupnt[39]]] =
                                            chaint[inparty[menupnt[39]]] -
                                            armintadd[temp[703]];
                                        charint[inparty[menupnt[39]]] =
                                            str(chaint[inparty[menupnt[39]]]);
                                        chrac[inparty[menupnt[39]]] =
                                            chrac[inparty[menupnt[39]]] -
                                            armacadd[temp[703]];
                                        charac[inparty[menupnt[39]]] =
                                            str(chrac[inparty[menupnt[39]]]);
                                        charws[inparty[menupnt[39]]] =
                                            str(chaws[inparty[menupnt[39]]]);
                                        equippedhelmet[inparty[menupnt[39]]] =
                                            0;
                                        armoramount[temp[703]] =
                                            armoramount[temp[703]] + 1;
                                    }
                                    if (menupnt[20] = 5) {
                                        temp[704] = 0;
                                        temp[704] =
                                            equippedlegs[inparty[menupnt[39]]];
                                        chamaxhp[inparty[menupnt[39]]] =
                                            chamaxhp[inparty[menupnt[39]]] -
                                            armhpadd[temp[704]];
                                        chahp[inparty[menupnt[39]]] =
                                            chahp[inparty[menupnt[39]]] -
                                            armhpadd[temp[704]];
                                        charhp[inparty[menupnt[39]]] =
                                            str(chahp[inparty[menupnt[39]]]);
                                        charmaxhp[inparty[menupnt[39]]] =
                                            str(chamaxhp[inparty[menupnt[39]]]);
                                        chamaxmp[inparty[menupnt[39]]] =
                                            chamaxmp[inparty[menupnt[39]]] -
                                            armmpadd[temp[704]];
                                        champ[inparty[menupnt[39]]] =
                                            champ[inparty[menupnt[39]]] -
                                            armmpadd[temp[704]];
                                        charmp[inparty[menupnt[39]]] =
                                            str(champ[inparty[menupnt[39]]]);
                                        charmaxmp[inparty[menupnt[39]]] =
                                            str(chamaxmp[inparty[menupnt[39]]]);
                                        chastr[inparty[menupnt[39]]] =
                                            chastr[inparty[menupnt[39]]] -
                                            armstradd[temp[704]];
                                        charstr[inparty[menupnt[39]]] =
                                            str(chastr[inparty[menupnt[39]]]);
                                        chasta[inparty[menupnt[39]]] =
                                            chasta[inparty[menupnt[39]]] -
                                            armstaadd[temp[704]];
                                        charsta[inparty[menupnt[39]]] =
                                            str(chasta[inparty[menupnt[39]]]);
                                        chaagi[inparty[menupnt[39]]] =
                                            chaagi[inparty[menupnt[39]]] -
                                            armagiadd[temp[704]];
                                        charagi[inparty[menupnt[39]]] =
                                            str(chaagi[inparty[menupnt[39]]]);
                                        chaa[inparty[menupnt[39]]] =
                                            chaa[inparty[menupnt[39]]] -
                                            armaadd[temp[704]];
                                        chara[inparty[menupnt[39]]] =
                                            str(chaa[inparty[menupnt[39]]]);
                                        chaint[inparty[menupnt[39]]] =
                                            chaint[inparty[menupnt[39]]] -
                                            armintadd[temp[704]];
                                        charint[inparty[menupnt[39]]] =
                                            str(chaint[inparty[menupnt[39]]]);
                                        chrac[inparty[menupnt[39]]] =
                                            chrac[inparty[menupnt[39]]] -
                                            armacadd[temp[704]];
                                        charac[inparty[menupnt[39]]] =
                                            str(chrac[inparty[menupnt[39]]]);
                                        charws[inparty[menupnt[39]]] =
                                            str(chaws[inparty[menupnt[39]]]);
                                        equippedlegs[inparty[menupnt[39]]] = 0;
                                        armoramount[temp[704]] =
                                            armoramount[temp[704]] + 1;
                                    }
                                    if (menupnt[20] = 2) {
                                        temp[705] = 0;
                                        temp[705] = equippedshield
                                            [inparty[menupnt[39]]];
                                        chamaxhp[inparty[menupnt[39]]] =
                                            chamaxhp[inparty[menupnt[39]]] -
                                            armhpadd[temp[705]];
                                        chahp[inparty[menupnt[39]]] =
                                            chahp[inparty[menupnt[39]]] -
                                            armhpadd[temp[705]];
                                        charhp[inparty[menupnt[39]]] =
                                            str(chahp[inparty[menupnt[39]]]);
                                        charmaxhp[inparty[menupnt[39]]] =
                                            str(chamaxhp[inparty[menupnt[39]]]);
                                        chamaxmp[inparty[menupnt[39]]] =
                                            chamaxmp[inparty[menupnt[39]]] -
                                            armmpadd[temp[705]];
                                        champ[inparty[menupnt[39]]] =
                                            champ[inparty[menupnt[39]]] -
                                            armmpadd[temp[705]];
                                        charmp[inparty[menupnt[39]]] =
                                            str(champ[inparty[menupnt[39]]]);
                                        charmaxmp[inparty[menupnt[39]]] =
                                            str(chamaxmp[inparty[menupnt[39]]]);
                                        chastr[inparty[menupnt[39]]] =
                                            chastr[inparty[menupnt[39]]] -
                                            armstradd[temp[705]];
                                        charstr[inparty[menupnt[39]]] =
                                            str(chastr[inparty[menupnt[39]]]);
                                        chasta[inparty[menupnt[39]]] =
                                            chasta[inparty[menupnt[39]]] -
                                            armstaadd[temp[705]];
                                        charsta[inparty[menupnt[39]]] =
                                            str(chasta[inparty[menupnt[39]]]);
                                        chaagi[inparty[menupnt[39]]] =
                                            chaagi[inparty[menupnt[39]]] -
                                            armagiadd[temp[705]];
                                        charagi[inparty[menupnt[39]]] =
                                            str(chaagi[inparty[menupnt[39]]]);
                                        chaa[inparty[menupnt[39]]] =
                                            chaa[inparty[menupnt[39]]] -
                                            armaadd[temp[705]];
                                        chara[inparty[menupnt[39]]] =
                                            str(chaa[inparty[menupnt[39]]]);
                                        chaint[inparty[menupnt[39]]] =
                                            chaint[inparty[menupnt[39]]] -
                                            armintadd[temp[705]];
                                        charint[inparty[menupnt[39]]] =
                                            str(chaint[inparty[menupnt[39]]]);
                                        chrac[inparty[menupnt[39]]] =
                                            chrac[inparty[menupnt[39]]] -
                                            armacadd[temp[705]];
                                        charac[inparty[menupnt[39]]] =
                                            str(chrac[inparty[menupnt[39]]]);
                                        charws[inparty[menupnt[39]]] =
                                            str(chaws[inparty[menupnt[39]]]);
                                        equippedshield[inparty[menupnt[39]]] =
                                            0;
                                        armoramount[temp[705]] =
                                            armoramount[temp[705]] + 1;
                                    }
                                    if (menupnt[20] = 6) {
                                        temp[706] = 0;
                                        temp[706] = equippedequipment
                                            [inparty[menupnt[39]]];
                                        chamaxhp[inparty[menupnt[39]]] =
                                            chamaxhp[inparty[menupnt[39]]] -
                                            equhpadd[temp[706]];
                                        chahp[inparty[menupnt[39]]] =
                                            chahp[inparty[menupnt[39]]] -
                                            equhpadd[temp[706]];
                                        charhp[inparty[menupnt[39]]] =
                                            str(chahp[inparty[menupnt[39]]]);
                                        charmaxhp[inparty[menupnt[39]]] =
                                            str(chamaxhp[inparty[menupnt[39]]]);
                                        chamaxmp[inparty[menupnt[39]]] =
                                            chamaxmp[inparty[menupnt[39]]] -
                                            equmpadd[temp[706]];
                                        champ[inparty[menupnt[39]]] =
                                            champ[inparty[menupnt[39]]] -
                                            equmpadd[temp[706]];
                                        charmp[inparty[menupnt[39]]] =
                                            str(champ[inparty[menupnt[39]]]);
                                        charmaxmp[inparty[menupnt[39]]] =
                                            str(chamaxmp[inparty[menupnt[39]]]);
                                        chastr[inparty[menupnt[39]]] =
                                            chastr[inparty[menupnt[39]]] -
                                            equstradd[temp[706]];
                                        charstr[inparty[menupnt[39]]] =
                                            str(chastr[inparty[menupnt[39]]]);
                                        chasta[inparty[menupnt[39]]] =
                                            chasta[inparty[menupnt[39]]] -
                                            equstaadd[temp[706]];
                                        charsta[inparty[menupnt[39]]] =
                                            str(chasta[inparty[menupnt[39]]]);
                                        chaagi[inparty[menupnt[39]]] =
                                            chaagi[inparty[menupnt[39]]] -
                                            equagiadd[temp[706]];
                                        charagi[inparty[menupnt[39]]] =
                                            str(chaagi[inparty[menupnt[39]]]);
                                        chaa[inparty[menupnt[39]]] =
                                            chaa[inparty[menupnt[39]]] -
                                            equaadd[temp[706]];
                                        chara[inparty[menupnt[39]]] =
                                            str(chaa[inparty[menupnt[39]]]);
                                        chaint[inparty[menupnt[39]]] =
                                            chaint[inparty[menupnt[39]]] -
                                            equintadd[temp[706]];
                                        charint[inparty[menupnt[39]]] =
                                            str(chaint[inparty[menupnt[39]]]);
                                        charac[inparty[menupnt[39]]] =
                                            str(chrac[inparty[menupnt[39]]]);
                                        charws[inparty[menupnt[39]]] =
                                            str(chaws[inparty[menupnt[39]]]);
                                        equippedequipment
                                            [inparty[menupnt[39]]] = 0;
                                        if (equippedequipment
                                                [inparty[menupnt[39]]] = 1) {
                                            cancausepara[inparty[menupnt[39]]] =
                                                0;
                                        }
                                        if (equippedequipment
                                                [inparty[menupnt[39]]] = 2) {
                                            cancausecurse
                                                [inparty[menupnt[39]]] = 0;
                                        }
                                        if (equippedequipment
                                                [inparty[menupnt[39]]] = 3) {
                                            cancausepoison
                                                [inparty[menupnt[39]]] = 0;
                                        }
                                        if (equippedequipment
                                                [inparty[menupnt[39]]] = 5) {
                                            cancausegrazy
                                                [inparty[menupnt[39]]] = 0;
                                        }
                                        equamount[temp[706]] =
                                            equamount[temp[706]] + 1;
                                    }
                                    if (menupnt[20] = 7) {
                                        temp[707] = 0;
                                        temp[707] =
                                            equippedrelic[inparty[menupnt[39]]];
                                        chamaxhp[inparty[menupnt[39]]] =
                                            chamaxhp[inparty[menupnt[39]]] -
                                            relichpadd[temp[707]];
                                        chahp[inparty[menupnt[39]]] =
                                            chahp[inparty[menupnt[39]]] -
                                            relichpadd[temp[707]];
                                        charhp[inparty[menupnt[39]]] =
                                            str(chahp[inparty[menupnt[39]]]);
                                        charmaxhp[inparty[menupnt[39]]] =
                                            str(chamaxhp[inparty[menupnt[39]]]);
                                        chamaxmp[inparty[menupnt[39]]] =
                                            chamaxmp[inparty[menupnt[39]]] -
                                            relicmpadd[temp[707]];
                                        champ[inparty[menupnt[39]]] =
                                            champ[inparty[menupnt[39]]] -
                                            relicmpadd[temp[707]];
                                        charmp[inparty[menupnt[39]]] =
                                            str(champ[inparty[menupnt[39]]]);
                                        charmaxmp[inparty[menupnt[39]]] =
                                            str(chamaxmp[inparty[menupnt[39]]]);
                                        chastr[inparty[menupnt[39]]] =
                                            chastr[inparty[menupnt[39]]] -
                                            relicstradd[temp[707]];
                                        charstr[inparty[menupnt[39]]] =
                                            str(chastr[inparty[menupnt[39]]]);
                                        chasta[inparty[menupnt[39]]] =
                                            chasta[inparty[menupnt[39]]] -
                                            relicstaadd[temp[707]];
                                        charsta[inparty[menupnt[39]]] =
                                            str(chasta[inparty[menupnt[39]]]);
                                        chaagi[inparty[menupnt[39]]] =
                                            chaagi[inparty[menupnt[39]]] -
                                            relicagiadd[temp[707]];
                                        charagi[inparty[menupnt[39]]] =
                                            str(chaagi[inparty[menupnt[39]]]);
                                        chaa[inparty[menupnt[39]]] =
                                            chaa[inparty[menupnt[39]]] -
                                            relicaadd[temp[707]];
                                        chara[inparty[menupnt[39]]] =
                                            str(chaa[inparty[menupnt[39]]]);
                                        chaint[inparty[menupnt[39]]] =
                                            chaint[inparty[menupnt[39]]] -
                                            relicintadd[temp[707]];
                                        charint[inparty[menupnt[39]]] =
                                            str(chaint[inparty[menupnt[39]]]);
                                        charac[inparty[menupnt[39]]] =
                                            str(chrac[inparty[menupnt[39]]]);
                                        charws[inparty[menupnt[39]]] =
                                            str(chaws[inparty[menupnt[39]]]);
                                        equippedrelic[inparty[menupnt[39]]] = 0;
                                        relicamount[temp[707]] =
                                            relicamount[temp[707]] + 1;
                                    }
                                    mmenu = 70;
                                    while (mmenu = 70) {
                                        render();
                                        equipmenuparts();
                                        Tcopysprite(465, 450, 179, 29, mpic3);
                                        gotoxy(490, 455);
                                        printstring(font, "Unequipped!!!");
                                        showtime();
                                        showpage();
                                        updatecontrols();
                                        if (key[28]) {
                                            unpress(key[28]);
                                            mmenu = 6;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
        if (key[28]) {
            unpress(key[28]);
            mmenu = 63;
            while (mmenu = 63) {
                render();
                equipmenuparts();
                TscaleSprite(0, 90 + (10 * menupnt[4]), 7, 9, 7, 9, pointer1);
                GotoXY(500, 340);
                printstring(1, "WEAPONS");
                GotoXY(500, 360);
                printstring(1, "ARMORS");
                GotoXY(500, 380);
                printstring(1, "EQUIPMENTS");
                GotoXY(500, 400);
                printstring(1, "RELICS");
                GotoXY(500, 420);
                printstring(1, "SPEC.EQUIPM.");
                GotoXY(500, 440);
                printstring(1, "UNEQUIP");
                switch (menupnt[20]) {
                case 1:
                    TscaleSprite(490, 340, 7, 9, 7, 9, pointer1);
                    shweapons();
                    gotoxy(10, 80);
                    printstring(font, "Weapon name:");
                    gotoxy(120, 80);
                    printstring(font, "Weapon type:");
                    gotoxy(220, 80);
                    printstring(font, "Weapon description:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                    Tcopysprite(465, 450, 179, 29, mpic3);
                    gotoxy(490, 455);
                    printstring(font, "Select weapon");
                case 2:
                    TscaleSprite(490, 360, 7, 9, 7, 9, pointer1);
                    sharmors();
                    gotoxy(10, 80);
                    printstring(font, "Armor name:");
                    gotoxy(120, 80);
                    printstring(font, "Armor type:");
                    gotoxy(220, 80);
                    printstring(font, "Armor description:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                    Tcopysprite(465, 450, 179, 29, mpic3);
                    gotoxy(490, 455);
                    printstring(font, "Select armor");
                case 3:
                    TscaleSprite(490, 380, 7, 9, 7, 9, pointer1);
                    shequs();
                    gotoxy(10, 80);
                    printstring(font, "Equipm. name:");
                    gotoxy(120, 80);
                    printstring(font, "Equipm. desc.:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                    Tcopysprite(465, 450, 179, 29, mpic3);
                    gotoxy(490, 455);
                    printstring(font, "Select equipment");
                case 4:
                    TscaleSprite(490, 400, 7, 9, 7, 9, pointer1);
                    shrelics();
                    gotoxy(10, 80);
                    printstring(font, "Relic name:");
                    gotoxy(120, 80);
                    printstring(font, "Relic description:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                    Tcopysprite(465, 450, 179, 29, mpic3);
                    gotoxy(490, 455);
                    printstring(font, "Select relic");
                case 5:
                    TscaleSprite(490, 420, 7, 9, 7, 9, pointer1);
                    gotoxy(10, 80);
                    printstring(font, "S.equipm.name:");
                    gotoxy(120, 80);
                    printstring(font, "S.equipm.desc.:");
                    gotoxy(360, 80);
                    printstring(font, "Amount:");
                    Tcopysprite(465, 450, 179, 29, mpic3);
                    gotoxy(490, 455);
                    printstring(font, "Select special equipment");
                }
                showtime();
                showpage();
                updatecontrols();
                If(key[80]) {
                    menupnt[4]++;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(key[72]) {
                    menupnt[4]--;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(menupnt[4] < 1) { menupnt[4] = 30; }
                if (menupnt[4] > 30) {
                    menupnt[4] = 1;
                }
                if (key[28]) {
                    unpress(key[28]);
                    menupnt[39] = 1;
                    mmenu = 60;
                    while (mmenu = 60) {
                        render();
                        equipmenuparts();
                        TscaleSprite(
                            0, 90 + (10 * menupnt[4]), 7, 9, 7, 9, pointer1);
                        GotoXY(500, 340);
                        printstring(1, "WEAPONS");
                        GotoXY(500, 360);
                        printstring(1, "ARMORS");
                        GotoXY(500, 380);
                        printstring(1, "EQUIPMENTS");
                        GotoXY(500, 400);
                        printstring(1, "RELICS");
                        GotoXY(500, 420);
                        printstring(1, "SPEC.EQUIPM.");
                        switch (menupnt[20]) {
                        case 1:
                            TscaleSprite(490, 340, 7, 9, 7, 9, pointer1);
                            shweapons();
                            gotoxy(10, 80);
                            printstring(font, "Weapon name:");
                            gotoxy(120, 80);
                            printstring(font, "Weapon type:");
                            gotoxy(220, 80);
                            printstring(font, "Weapon description:");
                            gotoxy(360, 80);
                            printstring(font, "Amount:");
                        case 2:
                            TscaleSprite(490, 360, 7, 9, 7, 9, pointer1);
                            sharmors();
                            gotoxy(10, 80);
                            printstring(font, "Armor name:");
                            gotoxy(120, 80);
                            printstring(font, "Armor type:");
                            gotoxy(220, 80);
                            printstring(font, "Armor description:");
                            gotoxy(360, 80);
                            printstring(font, "Amount:");
                        case 3:
                            TscaleSprite(490, 380, 7, 9, 7, 9, pointer1);
                            shequs();
                            gotoxy(10, 80);
                            printstring(font, "Equipm. name:");
                            gotoxy(120, 80);
                            printstring(font, "Equipm. desc.:");
                            gotoxy(360, 80);
                            printstring(font, "Amount:");
                        case 4:
                            TscaleSprite(490, 400, 7, 9, 7, 9, pointer1);
                            shrelics();
                            gotoxy(10, 80);
                            printstring(font, "Relic name:");
                            gotoxy(120, 80);
                            printstring(font, "Relic description:");
                            gotoxy(360, 80);
                            printstring(font, "Amount:");
                        case 5:
                            TscaleSprite(490, 420, 7, 9, 7, 9, pointer1);
                            gotoxy(10, 80);
                            printstring(font, "S.equipm.name:");
                            gotoxy(120, 80);
                            printstring(font, "S.equipm.desc.:");
                            gotoxy(360, 80);
                            printstring(font, "Amount:");
                        }
                        Tcopysprite(465, 450, 179, 29, mpic3);
                        gotoxy(490, 455);
                        printstring(font, "Equip it to whom?");
                        switch (menupnt[39]) {
                        case 1:
                            TscaleSprite(480, 70, 7, 9, 7, 9, pointer1);
                        case 2:
                            TscaleSprite(540, 70, 7, 9, 7, 9, pointer1);
                        case 3:
                            TscaleSprite(480, 130, 7, 9, 7, 9, pointer1);
                        case 4:
                            TscaleSprite(540, 130, 7, 9, 7, 9, pointer1);
                        case 5:
                            TscaleSprite(480, 190, 7, 9, 7, 9, pointer1);
                        case 6:
                            TscaleSprite(540, 190, 7, 9, 7, 9, pointer1);
                        case 7:
                            TscaleSprite(480, 250, 7, 9, 7, 9, pointer1);
                        case 8:
                            TscaleSprite(540, 250, 7, 9, 7, 9, pointer1);
                        }
                        showtime();
                        showpage();
                        updatecontrols();
                        If(key[77]) {
                            menupnt[39]++;
                            playsound(menuitemsound, 64, 128);
                            del(10, 0, 0, 0);
                        }
                        If(key[75]) {
                            menupnt[39]--;
                            playsound(menuitemsound, 64, 128);
                            del(10, 0, 0, 0);
                        }
                        If(menupnt[39] < 1) { menupnt[39] = numchars; }
                        If(menupnt[39] > numchars) { menupnt[39] = 1; }
                        If(key[80]) {
                            menupnt[39]++;
                            playsound(menuitemsound, 64, 128);
                            del(10, 0, 0, 0);
                        }
                        If(key[72]) {
                            menupnt[39]--;
                            playsound(menuitemsound, 64, 128);
                            del(10, 0, 0, 0);
                        }
                        If(menupnt[39] < 1) { menupnt[39] = numchars; }
                        if (menupnt[39] > numchars) {
                            menupnt[39] = 1;
                        }
                        if (key[28]) {
                            unpress(key[28]);
                            mmenu = 62;
                            charhp[inparty[menupnt[39]]] =
                                str(chahp[inparty[menupnt[39]]]);
                            charmaxhp[inparty[menupnt[39]]] =
                                str(chamaxhp[inparty[menupnt[39]]]);
                            charmp[inparty[menupnt[39]]] =
                                str(champ[inparty[menupnt[39]]]);
                            charmaxmp[inparty[menupnt[39]]] =
                                str(chamaxmp[inparty[menupnt[39]]]);
                            charstr[inparty[menupnt[39]]] =
                                str(chastr[inparty[menupnt[39]]]);
                            charsta[inparty[menupnt[39]]] =
                                str(chasta[inparty[menupnt[39]]]);
                            charagi[inparty[menupnt[39]]] =
                                str(chaagi[inparty[menupnt[39]]]);
                            chara[inparty[menupnt[39]]] =
                                str(chaa[inparty[menupnt[39]]]);
                            charint[inparty[menupnt[39]]] =
                                str(chaint[inparty[menupnt[39]]]);
                            charac[inparty[menupnt[39]]] =
                                str(chrac[inparty[menupnt[39]]]);
                            charws[inparty[menupnt[39]]] =
                                str(chaws[inparty[menupnt[39]]]);
                            while (mmenu = 62) {
                                render();
                                equipmenuparts();
                                switch (menupnt[20]) {
                                case 1:
                                    shweapons();
                                    gotoxy(10, 80);
                                    printstring(font, "Weapon name:");
                                    gotoxy(120, 80);
                                    printstring(font, "Weapon type:");
                                    gotoxy(220, 80);
                                    printstring(font, "Weapon description:");
                                    gotoxy(360, 80);
                                    printstring(font, "Amount:");
                                case 2:
                                    sharmors();
                                    gotoxy(10, 80);
                                    printstring(font, "Armor name:");
                                    gotoxy(120, 80);
                                    printstring(font, "Armor type:");
                                    gotoxy(220, 80);
                                    printstring(font, "Armor description:");
                                    gotoxy(360, 80);
                                    printstring(font, "Amount:");
                                case 3:
                                    shequs();
                                    gotoxy(10, 80);
                                    printstring(font, "Equipm. name:");
                                    gotoxy(120, 80);
                                    printstring(font, "Equipm. desc.:");
                                    gotoxy(360, 80);
                                    printstring(font, "Amount:");
                                case 4:
                                    shrelics();
                                    gotoxy(10, 80);
                                    printstring(font, "Relic name:");
                                    gotoxy(120, 80);
                                    printstring(font, "Relic description:");
                                    gotoxy(360, 80);
                                    printstring(font, "Amount:");
                                case 5:
                                    gotoxy(10, 80);
                                    printstring(font, "S.equipm.name:");
                                    gotoxy(120, 80);
                                    printstring(font, "S.equipm.desc.:");
                                    gotoxy(360, 80);
                                    printstring(font, "Amount:");
                                }

                                tcopysprite(10, 160, 178, 318, mpic6);
                                Tcopysprite(15, 165, 96, 96,
                                    charpic[inparty[menupnt[39]]]);
                                gotoxy(15, 265);
                                printstring(
                                    font, charname[inparty[menupnt[39]]]);
                                gotoxy(15, 285);
                                printstring(font,
                                    "Hp: " + charhp[inparty[menupnt[39]]] +
                                        " / " +
                                        charmaxhp[inparty[menupnt[39]]]);
                                gotoxy(15, 295);
                                printstring(font,
                                    "Mp: " + charmp[inparty[menupnt[39]]] +
                                        " / " +
                                        charmaxmp[inparty[menupnt[39]]]);
                                gotoxy(15, 305);
                                printstring(font,
                                    "Str: " + charstr[inparty[menupnt[39]]]);
                                gotoxy(15, 315);
                                printstring(font,
                                    "Sta: " + charsta[inparty[menupnt[39]]]);
                                gotoxy(15, 325);
                                printstring(font,
                                    "Agi: " + charagi[inparty[menupnt[39]]]);
                                gotoxy(15, 335);
                                printstring(
                                    font, "A: " + chara[inparty[menupnt[39]]]);
                                gotoxy(15, 345);
                                printstring(font,
                                    "Int: " + charint[inparty[menupnt[39]]]);
                                gotoxy(15, 355);
                                printstring(font,
                                    "Ac: " + charac[inparty[menupnt[39]]]);
                                gotoxy(15, 365);
                                printstring(font,
                                    "Ws: " + charws[inparty[menupnt[39]]]);
                                gotoxy(15, 385);
                                printstring(
                                    font, "Weapon: " +
                                              weaponname[equippedweapon
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 395);
                                printstring(
                                    font, "Shield: " +
                                              armorname[equippedshield
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 405);
                                printstring(
                                    font, "Armor: " +
                                              armorname[equippedarmor
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 415);
                                printstring(
                                    font, "Helmet: " +
                                              armorname[equippedhelmet
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 425);
                                printstring(font,
                                    "Legs: " + armorname[equippedlegs
                                                       [inparty[menupnt[39]]]]);
                                gotoxy(15, 435);
                                printstring(font,
                                    "Ac1: " + equipmentname[equippedequipment
                                                      [inparty[menupnt[39]]]]);
                                gotoxy(15, 445);
                                printstring(font,
                                    "Ac1: " + relicname[equippedrelic
                                                      [inparty[menupnt[39]]]]);
                                updates();
                                Tcopysprite(465, 380, 179, 29, mpic3);
                                Tcopysprite(465, 410, 179, 29, mpic3);
                                switch (menupnt[45]) {
                                case 1:
                                    TscaleSprite(
                                        485, 415, 7, 9, 7, 9, pointer1);
                                case 2:
                                    TscaleSprite(
                                        555, 415, 7, 9, 7, 9, pointer1);
                                }
                                gotoxy(490, 385);
                                printstring(font, "Are you sure?");
                                gotoxy(490, 415);
                                printstring(font, " Yes ");
                                gotoxy(560, 415);
                                printstring(font, " No ");
                                showtime();
                                showpage();
                                updatecontrols();
                                If(key[77]) {
                                    menupnt[45]++;
                                    playsound(menuitemsound, 64, 128);
                                    del(10, 0, 0, 0);
                                }
                                If(key[75]) {
                                    menupnt[45]--;
                                    playsound(menuitemsound, 64, 128);
                                    del(10, 0, 0, 0);
                                }
                                if (menupnt[45] < 1) {
                                    menupnt[45] = 2;
                                }
                                if (menupnt[45] > 2) {
                                    menupnt[45] = 1;
                                }
                                if (key[28] && menupnt[45] = 2) {
                                    unpress(key[28]);
                                    mmenu = 6;
                                }
                                if (key[28] && menupnt[45] = 1) {
                                    unpress(key[28]);
                                    if (menupnt[20] = 1) {
                                        temp[701] = 0;
                                        temp[701] = equippedweapon
                                            [inparty[menupnt[39]]];
                                        equippedweapon[inparty[menupnt[39]]] =
                                            inmenuweapon[menupnt[4]];
                                        if (inmenuweapon[menupnt[4]] = 22) {
                                            equippedshield
                                                [inparty[menupnt[39]]] = 14;
                                        }
                                        if (temp[701] = 22) {
                                            equippedshield
                                                [inparty[menupnt[39]]] = 0;
                                        }
                                        if (weapontype
                                                [inmenuweapon[menupnt[4]]] >
                                            0) {
                                            weaponamount
                                                [inmenuweapon[menupnt[4]]] =
                                                    weaponamount[inmenuweapon
                                                            [menupnt[4]]] -
                                                    1;
                                        }
                                        if (weapontype[temp[701]] > 0) {
                                            weaponamount[temp[701]] =
                                                weaponamount[temp[701]] + 1;
                                        }
                                    }
                                    if (menupnt[20] =
                                            2 &&
                                            armortype[inmenuarmor[menupnt[4]]] =
                                                1) {
                                        temp[702] =
                                            equippedarmor[inparty[menupnt[39]]];
                                        equippedarmor[inparty[menupnt[39]]] =
                                            inmenuarmor[menupnt[4]];
                                        armoramount[inmenuarmor[menupnt[4]]] =
                                            armoramount
                                                [inmenuarmor[menupnt[4]]] -
                                            1;
                                        armoramount[temp[702]] =
                                            armoramount[temp[702]] + 1;
                                    }
                                    if (menupnt[20] =
                                            2 &&
                                            armortype[inmenuarmor[menupnt[4]]] =
                                                2) {
                                        temp[703] = equippedhelmet
                                            [inparty[menupnt[39]]];
                                        equippedhelmet[inparty[menupnt[39]]] =
                                            inmenuarmor[menupnt[4]];
                                        armoramount[inmenuarmor[menupnt[4]]] =
                                            armoramount
                                                [inmenuarmor[menupnt[4]]] -
                                            1;
                                        armoramount[temp[703]] =
                                            armoramount[temp[703]] + 1;
                                    }
                                    if (menupnt[20] =
                                            2 &&
                                            armortype[inmenuarmor[menupnt[4]]] =
                                                4) {
                                        temp[704] =
                                            equippedlegs[inparty[menupnt[39]]];
                                        equippedlegs[inparty[menupnt[39]]] =
                                            inmenuarmor[menupnt[4]];
                                        armoramount[inmenuarmor[menupnt[4]]] =
                                            armoramount
                                                [inmenuarmor[menupnt[4]]] -
                                            1;
                                        armoramount[temp[704]] =
                                            armoramount[temp[704]] + 1;
                                    }
                                    if (menupnt[20] =
                                            2 &&
                                            armortype[inmenuarmor[menupnt[4]]] =
                                                6) {
                                        temp[705] = equippedshield
                                            [inparty[menupnt[39]]];
                                        equippedshield[inparty[menupnt[39]]] =
                                            inmenuarmor[menupnt[4]];
                                        armoramount[inmenuarmor[menupnt[4]]] =
                                            armoramount
                                                [inmenuarmor[menupnt[4]]] -
                                            1;
                                        armoramount[temp[705]] =
                                            armoramount[temp[705]] + 1;
                                    }
                                    if (menupnt[20] = 3) {
                                        temp[706] = equippedequipment
                                            [inparty[menupnt[39]]];
                                        if (temp[706] = 1) {
                                            cancausepara[inparty[menupnt[39]]] =
                                                0;
                                        }
                                        if (temp[706] = 2) {
                                            cancausecurse
                                                [inparty[menupnt[39]]] = 0;
                                        }
                                        if (temp[706] = 3) {
                                            cancausepoison
                                                [inparty[menupnt[39]]] = 0;
                                        }

                                        if (temp[706] = 5) {
                                            cancausegrazy
                                                [inparty[menupnt[39]]] = 0;
                                        }
                                        equippedequipment
                                            [inparty[menupnt[39]]] =
                                                inmenuequ[menupnt[4]];
                                        if (equippedequipment
                                                [inparty[menupnt[39]]] = 1) {
                                            cancausepara[inparty[menupnt[39]]] =
                                                1;
                                        }
                                        if (equippedequipment
                                                [inparty[menupnt[39]]] = 2) {
                                            cancausecurse
                                                [inparty[menupnt[39]]] = 1;
                                        }
                                        if (equippedequipment
                                                [inparty[menupnt[39]]] = 3) {
                                            cancausepoison
                                                [inparty[menupnt[39]]] = 1;
                                        }
                                        if (equippedequipment
                                                [inparty[menupnt[39]]] = 5) {
                                            cancausegrazy
                                                [inparty[menupnt[39]]] = 1;
                                        }
                                        equamount[inmenuequ[menupnt[4]]] =
                                            equamount[inmenuequ[menupnt[4]]] -
                                            1;
                                        equamount[temp[706]] =
                                            equamount[temp[706]] + 1;
                                    }
                                    if (menupnt[20] = 4) {
                                        temp[707] =
                                            equippedrelic[inparty[menupnt[39]]];
                                        equippedrelic[inparty[menupnt[39]]] =
                                            inmenurelic[menupnt[4]];
                                        relicamount[inmenurelic[menupnt[4]]] =
                                            relicamount
                                                [inmenurelic[menupnt[4]]] -
                                            1;
                                        relicamount[temp[707]] =
                                            relicamount[temp[707]] + 1;
                                    }
                                    chamaxhp[inparty[menupnt[39]]] = temp[7002];
                                    if (chahp[inparty[menupnt[39]]] >
                                        chamaxhp[inparty[menupnt[39]]]) {
                                        chahp[inparty[menupnt[39]]] =
                                            chamaxhp[inparty[menupnt[39]]];
                                    }
                                    chamaxmp[inparty[menupnt[39]]] = temp[7004];
                                    if (champ[inparty[menupnt[39]]] >
                                        chamaxmp[inparty[menupnt[39]]]) {
                                        champ[inparty[menupnt[39]]] =
                                            chamaxmp[inparty[menupnt[39]]];
                                    }
                                    chastr[inparty[menupnt[39]]] = temp[7006];
                                    chasta[inparty[menupnt[39]]] = temp[7008];
                                    chaagi[inparty[menupnt[39]]] = temp[7010];
                                    chaa[inparty[menupnt[39]]] = temp[7012];
                                    chaint[inparty[menupnt[39]]] = temp[7014];
                                    if (menupnt[20] = 1) {
                                        chrac[inparty[menupnt[39]]] =
                                            temp[7016];
                                    }
                                    if (menupnt[20] = 2) {
                                        chrac[inparty[menupnt[39]]] =
                                            temp[7016];
                                    }
                                    charmaxhp[inparty[menupnt[39]]] =
                                        str(chamaxhp[inparty[menupnt[39]]]);
                                    charhp[inparty[menupnt[39]]] =
                                        str(chahp[inparty[menupnt[39]]]);
                                    charmaxmp[inparty[menupnt[39]]] =
                                        str(chamaxmp[inparty[menupnt[39]]]);
                                    charmp[inparty[menupnt[39]]] =
                                        str(champ[inparty[menupnt[39]]]);
                                    charstr[inparty[menupnt[39]]] =
                                        str(chastr[inparty[menupnt[39]]]);
                                    charsta[inparty[menupnt[39]]] =
                                        str(chasta[inparty[menupnt[39]]]);
                                    charagi[inparty[menupnt[39]]] =
                                        str(chaagi[inparty[menupnt[39]]]);
                                    chara[inparty[menupnt[39]]] =
                                        str(chaa[inparty[menupnt[39]]]);
                                    charint[inparty[menupnt[39]]] =
                                        str(chaint[inparty[menupnt[39]]]);
                                    charac[inparty[menupnt[39]]] =
                                        str(chrac[inparty[menupnt[39]]]);
                                    mmenu = 65;
                                    while (mmenu = 65) {
                                        render();
                                        equipmenuparts();
                                        TscaleSprite(0, 90 + (10 * menupnt[4]),
                                            7, 9, 7, 9, pointer1);
                                        GotoXY(500, 340);
                                        printstring(1, "WEAPONS");
                                        GotoXY(500, 360);
                                        printstring(1, "ARMORS");
                                        GotoXY(500, 380);
                                        printstring(1, "EQUIPMENTS");
                                        GotoXY(500, 400);
                                        printstring(1, "RELICS");
                                        GotoXY(500, 420);
                                        printstring(1, "SPEC.EQUIPM.");
                                        switch (menupnt[20]) {
                                        case 1:
                                            TscaleSprite(
                                                490, 340, 7, 9, 7, 9, pointer1);
                                            shweapons();
                                            gotoxy(10, 80);
                                            printstring(font, "Weapon name:");
                                            gotoxy(120, 80);
                                            printstring(font, "Weapon type:");
                                            gotoxy(220, 80);
                                            printstring(
                                                font, "Weapon description:");
                                            gotoxy(360, 80);
                                            printstring(font, "Amount:");
                                        case 2:
                                            TscaleSprite(
                                                490, 360, 7, 9, 7, 9, pointer1);
                                            sharmors();
                                            gotoxy(10, 80);
                                            printstring(font, "Armor name:");
                                            gotoxy(120, 80);
                                            printstring(font, "Armor type:");
                                            gotoxy(220, 80);
                                            printstring(
                                                font, "Armor description:");
                                            gotoxy(360, 80);
                                            printstring(font, "Amount:");
                                        case 3:
                                            TscaleSprite(
                                                490, 380, 7, 9, 7, 9, pointer1);
                                            shequs();
                                            gotoxy(10, 80);
                                            printstring(font, "Equipm. name:");
                                            gotoxy(120, 80);
                                            printstring(font, "Equipm. desc.:");
                                            gotoxy(360, 80);
                                            printstring(font, "Amount:");
                                        case 4:
                                            TscaleSprite(
                                                490, 400, 7, 9, 7, 9, pointer1);
                                            shrelics();
                                            gotoxy(10, 80);
                                            printstring(font, "Relic name:");
                                            gotoxy(120, 80);
                                            printstring(
                                                font, "Relic description:");
                                            gotoxy(360, 80);
                                            printstring(font, "Amount:");
                                        case 5:
                                            TscaleSprite(
                                                490, 420, 7, 9, 7, 9, pointer1);
                                            gotoxy(10, 80);
                                            printstring(font, "S.equipm.name:");
                                            gotoxy(120, 80);
                                            printstring(
                                                font, "S.equipm.desc.:");
                                            gotoxy(360, 80);
                                            printstring(font, "Amount:");
                                        }
                                        tcopysprite(10, 160, 178, 318, mpic6);
                                        Tcopysprite(15, 165, 96, 96,
                                            charpic[inparty[menupnt[39]]]);
                                        gotoxy(15, 265);
                                        printstring(font,
                                            charname[inparty[menupnt[39]]]);
                                        gotoxy(15, 285);
                                        printstring(font,
                                            "Hp: " +
                                                charhp[inparty[menupnt[39]]] +
                                                " / " +
                                                charmaxhp
                                                    [inparty[menupnt[39]]]);
                                        gotoxy(15, 295);
                                        printstring(font,
                                            "Mp: " +
                                                charmp[inparty[menupnt[39]]] +
                                                " / " +
                                                charmaxmp
                                                    [inparty[menupnt[39]]]);
                                        gotoxy(15, 305);
                                        printstring(font,
                                            "Str: " +
                                                charstr[inparty[menupnt[39]]]);
                                        gotoxy(15, 315);
                                        printstring(font,
                                            "Sta: " +
                                                charsta[inparty[menupnt[39]]]);
                                        gotoxy(15, 325);
                                        printstring(font,
                                            "Agi: " +
                                                charagi[inparty[menupnt[39]]]);
                                        gotoxy(15, 335);
                                        printstring(font,
                                            "A: " +
                                                chara[inparty[menupnt[39]]]);
                                        gotoxy(15, 345);
                                        printstring(font,
                                            "Int: " +
                                                charint[inparty[menupnt[39]]]);
                                        gotoxy(15, 355);
                                        printstring(font,
                                            "Ac: " +
                                                charac[inparty[menupnt[39]]]);
                                        gotoxy(15, 365);
                                        printstring(font,
                                            "Ws: " +
                                                charws[inparty[menupnt[39]]]);
                                        gotoxy(15, 385);
                                        printstring(font,
                                            "Weapon: " +
                                                weaponname
                                                    [equippedweapon[inparty
                                                            [menupnt[39]]]]);
                                        gotoxy(15, 395);
                                        printstring(font,
                                            "Shield: " +
                                                armorname[equippedshield[inparty
                                                        [menupnt[39]]]]);
                                        gotoxy(15, 405);
                                        printstring(font,
                                            "Armor: " +
                                                armorname[equippedarmor[inparty
                                                        [menupnt[39]]]]);
                                        gotoxy(15, 415);
                                        printstring(font,
                                            "Helmet: " +
                                                armorname[equippedhelmet[inparty
                                                        [menupnt[39]]]]);
                                        gotoxy(15, 425);
                                        printstring(font,
                                            "Legs: " +
                                                armorname[equippedlegs[inparty
                                                        [menupnt[39]]]]);
                                        gotoxy(15, 435);
                                        printstring(font,
                                            "Ac1: " +
                                                equipmentname
                                                    [equippedequipment[inparty
                                                            [menupnt[39]]]]);
                                        gotoxy(15, 445);
                                        printstring(font,
                                            "Ac1: " +
                                                relicname[equippedrelic[inparty
                                                        [menupnt[39]]]]);
                                        Tcopysprite(465, 450, 179, 29, mpic3);
                                        gotoxy(490, 455);
                                        printstring(font, "Equipped!!");
                                        showpage();
                                        updatecontrols();
                                        if (key[28]) {
                                            unpress(key[28]);
                                            mmenu = 6;
                                        }
                                    }
                                }
                                if (key[29]) {
                                    unpress(key[28]);
                                    if (mmenu = 6 && battlegoing = 1) {
                                        mmenu = 0;
                                        battleselections();
                                    }
                                    if (mmenu = 6 && battlegoing = 0) {
                                        mmenu = 1;
                                    }
                                    if (mmenu = 63) {
                                        mmenu = 6;
                                    }
                                    if (mmenu = 60) {
                                        mmenu = 63;
                                    }
                                    if (mmenu = 62) {
                                        mmenu = 60;
                                    }
                                }
                            }
                        }
                        if (key[29]) {
                            unpress(key[28]);
                            if (mmenu = 6 && battlegoing = 1) {
                                mmenu = 0;
                                battleselections();
                            }
                            if (mmenu = 6 && battlegoing = 0) {
                                mmenu = 1;
                            }
                            if (mmenu = 63) {
                                mmenu = 6;
                            }
                            if (mmenu = 60) {
                                mmenu = 63;
                            }
                            if (mmenu = 62) {
                                mmenu = 60;
                            }
                        }
                    }
                }
                if (key[29]) {
                    unpress(key[28]);
                    if (mmenu = 6 && battlegoing = 1) {
                        mmenu = 0;
                        battleselections();
                    }
                    if (mmenu = 6 && battlegoing = 0) {
                        mmenu = 1;
                    }
                    if (mmenu = 63) {
                        mmenu = 6;
                    }
                    if (mmenu = 60) {
                        mmenu = 63;
                    }
                    if (mmenu = 62) {
                        mmenu = 60;
                    }
                }
            }
        }
        if (key[29]) {
            unpress(0);
            if (mmenu = 6 && battlegoing = 1) {
                mmenu = 0;
                battleselections();
            }
            if (mmenu = 6 && battlegoing = 0) {
                mmenu = 1;
            }
            if (mmenu = 63) {
                mmenu = 6;
            }
            if (mmenu = 60) {
                mmenu = 63;
            }
            if (mmenu = 62) {
                mmenu = 60;
            }
        }
    }
}
void updates() {
    switch (menupnt[20]) {
    case 1:
        temp[7001] = chamaxhp[inparty[menupnt[39]]] -
                     whpadd[equippedweapon[inparty[menupnt[39]]]];
        temp[7002] = temp[7001] + whpadd[inmenuweapon[menupnt[4]]];
        tempstring[700] = str(temp[7002]);
        if (temp[7002] > chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font2, " -> " + tempstring[700]);
        }
        if (temp[7002] < chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font3, " -> " + tempstring[700]);
        }
        if (temp[7002] = chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font, " -> " + tempstring[700]);
        }
        temp[7003] = chamaxmp[inparty[menupnt[39]]] -
                     wmpadd[equippedweapon[inparty[menupnt[39]]]];
        temp[7004] = temp[7003] + wmpadd[inmenuweapon[menupnt[4]]];
        tempstring[701] = str(temp[7004]);
        if (temp[7004] > chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font2, " -> " + tempstring[701]);
        }
        if (temp[7004] < chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font3, " -> " + tempstring[701]);
        }
        if (temp[7004] = chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font, " -> " + tempstring[701]);
        }
        temp[7005] = chastr[inparty[menupnt[39]]] -
                     wstradd[equippedweapon[inparty[menupnt[39]]]];
        temp[7006] = temp[7005] + wstradd[inmenuweapon[menupnt[4]]];
        tempstring[702] = str(temp[7006]);
        if (temp[7006] > chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font2, " -> " + tempstring[702]);
        }
        if (temp[7006] < chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font3, " -> " + tempstring[702]);
        }
        if (temp[7006] = chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font, " -> " + tempstring[702]);
        }
        temp[7007] = chasta[inparty[menupnt[39]]] -
                     wstaadd[equippedweapon[inparty[menupnt[39]]]];
        temp[7008] = temp[7007] + wstaadd[inmenuweapon[menupnt[4]]];
        tempstring[703] = str(temp[7008]);
        if (temp[7008] > chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font2, " -> " + tempstring[703]);
        }
        if (temp[7008] < chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font3, " -> " + tempstring[703]);
        }
        if (temp[7008] = chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font, " -> " + tempstring[703]);
        }
        temp[7009] = chaagi[inparty[menupnt[39]]] -
                     wagiadd[equippedweapon[inparty[menupnt[39]]]];
        temp[7010] = temp[7009] + wagiadd[inmenuweapon[menupnt[4]]];
        tempstring[704] = str(temp[7010]);
        if (temp[7010] > chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font2, " -> " + tempstring[704]);
        }
        if (temp[7010] < chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font3, " -> " + tempstring[704]);
        }
        if (temp[7010] = chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font, " -> " + tempstring[704]);
        }
        temp[7011] = chaa[inparty[menupnt[39]]] -
                     waadd[equippedweapon[inparty[menupnt[39]]]];
        temp[7012] = temp[7011] + waadd[inmenuweapon[menupnt[4]]];
        tempstring[705] = str(temp[7012]);
        if (temp[7012] > chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font2, " -> " + tempstring[705]);
        }
        if (temp[7012] < chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font3, " -> " + tempstring[705]);
        }
        if (temp[7012] = chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font, " -> " + tempstring[705]);
        }
        temp[7013] = chaint[inparty[menupnt[39]]] -
                     wintadd[equippedweapon[inparty[menupnt[39]]]];
        temp[7014] = temp[7013] + wintadd[inmenuweapon[menupnt[4]]];
        tempstring[706] = str(temp[7014]);
        if (temp[7014] > chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font2, " -> " + tempstring[706]);
        }
        if (temp[7014] < chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font3, " -> " + tempstring[706]);
        }
        if (temp[7014] = chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font, " -> " + tempstring[706]);
        }
        temp[7015] = chrac[inparty[menupnt[39]]] -
                     wacadd[equippedweapon[inparty[menupnt[39]]]];
        temp[7016] = temp[7015] + wacadd[inmenuweapon[menupnt[4]]];
        tempstring[707] = str(temp[7016]);
        if (temp[7016] > chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 355);
            printstring(font2, " -> " + tempstring[707]);
        }
        if (temp[7016] < chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 355);
            printstring(font3, " -> " + tempstring[707]);
        }
        if (temp[7016] = chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 355);
            printstring(font, " -> " + tempstring[707]);
        }

    case 2:
        if (armortype[inmenuarmor[menupnt[4]]] = 1) {
            temp[7001] = chamaxhp[inparty[menupnt[39]]] -
                         armhpadd[equippedarmor[inparty[menupnt[39]]]];
            temp[7002] = temp[7001] + armhpadd[inmenuarmor[menupnt[4]]];
            tempstring[700] = str(temp[7002]);
            if (temp[7002] > chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font2, " -> " + tempstring[700]);
            }
            if (temp[7002] < chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font3, " -> " + tempstring[700]);
            }
            if (temp[7002] = chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font, " -> " + tempstring[700]);
            }
            temp[7003] = chamaxmp[inparty[menupnt[39]]] -
                         armmpadd[equippedarmor[inparty[menupnt[39]]]];
            temp[7004] = temp[7003] + armmpadd[inmenuarmor[menupnt[4]]];
            tempstring[701] = str(temp[7004]);
            if (temp[7004] > chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font2, " -> " + tempstring[701]);
            }
            if (temp[7004] < chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font3, " -> " + tempstring[701]);
            }
            if (temp[7004] = chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font, " -> " + tempstring[701]);
            }
            temp[7005] = chastr[inparty[menupnt[39]]] -
                         armstradd[equippedarmor[inparty[menupnt[39]]]];
            temp[7006] = temp[7005] + armstradd[inmenuarmor[menupnt[4]]];
            tempstring[702] = str(temp[7006]);
            if (temp[7006] > chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font2, " -> " + tempstring[702]);
            }
            if (temp[7006] < chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font3, " -> " + tempstring[702]);
            }
            if (temp[7006] = chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font, " -> " + tempstring[702]);
            }
            temp[7007] = chasta[inparty[menupnt[39]]] -
                         armstaadd[equippedarmor[inparty[menupnt[39]]]];
            temp[7008] = temp[7007] + armstaadd[inmenuarmor[menupnt[4]]];
            tempstring[703] = str(temp[7008]);
            if (temp[7008] > chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font2, " -> " + tempstring[703]);
            }
            if (temp[7008] < chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font3, " -> " + tempstring[703]);
            }
            if (temp[7008] = chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font, " -> " + tempstring[703]);
            }
            temp[7009] = chaagi[inparty[menupnt[39]]] -
                         armagiadd[equippedarmor[inparty[menupnt[39]]]];
            temp[7010] = temp[7009] + armagiadd[inmenuarmor[menupnt[4]]];
            tempstring[704] = str(temp[7010]);
            if (temp[7010] > chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font2, " -> " + tempstring[704]);
            }
            if (temp[7010] < chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font3, " -> " + tempstring[704]);
            }
            if (temp[7010] = chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font, " -> " + tempstring[704]);
            }
            temp[7011] = chaa[inparty[menupnt[39]]] -
                         armaadd[equippedarmor[inparty[menupnt[39]]]];
            temp[7012] = temp[7011] + armaadd[inmenuarmor[menupnt[4]]];
            tempstring[705] = str(temp[7012]);
            if (temp[7012] > chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font2, " -> " + tempstring[705]);
            }
            if (temp[7012] < chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font3, " -> " + tempstring[705]);
            }
            if (temp[7012] = chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font, " -> " + tempstring[705]);
            }
            temp[7013] = chaint[inparty[menupnt[39]]] -
                         armintadd[equippedarmor[inparty[menupnt[39]]]];
            temp[7014] = temp[7013] + armintadd[inmenuarmor[menupnt[4]]];
            tempstring[706] = str(temp[7014]);
            if (temp[7014] > chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font2, " -> " + tempstring[706]);
            }
            if (temp[7014] < chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font3, " -> " + tempstring[706]);
            }
            if (temp[7014] = chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font, " -> " + tempstring[706]);
            }
            temp[7015] = chrac[inparty[menupnt[39]]] -
                         armacadd[equippedarmor[inparty[menupnt[39]]]];
            temp[7016] = temp[7015] + armacadd[inmenuarmor[menupnt[4]]];
            tempstring[707] = str(temp[7016]);
            if (temp[7016] > chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font2, " -> " + tempstring[707]);
            }
            if (temp[7016] < chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font3, " -> " + tempstring[707]);
            }
            if (temp[7016] = chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font, " -> " + tempstring[707]);
            }
        }
        if (armortype[inmenuarmor[menupnt[4]]] = 4) {
            temp[7001] = chamaxhp[inparty[menupnt[39]]] -
                         armhpadd[equippedlegs[inparty[menupnt[39]]]];
            temp[7002] = temp[7001] + armhpadd[inmenuarmor[menupnt[4]]];
            tempstring[700] = str(temp[7002]);
            if (temp[7002] > chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font2, " -> " + tempstring[700]);
            }
            if (temp[7002] < chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font3, " -> " + tempstring[700]);
            }
            if (temp[7002] = chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font, " -> " + tempstring[700]);
            }
            temp[7003] = chamaxmp[inparty[menupnt[39]]] -
                         armmpadd[equippedlegs[inparty[menupnt[39]]]];
            temp[7004] = temp[7003] + armmpadd[inmenuarmor[menupnt[4]]];
            tempstring[701] = str(temp[7004]);
            if (temp[7004] > chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font2, " -> " + tempstring[701]);
            }
            if (temp[7004] < chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font3, " -> " + tempstring[701]);
            }
            if (temp[7004] = chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font, " -> " + tempstring[701]);
            }
            temp[7005] = chastr[inparty[menupnt[39]]] -
                         armstradd[equippedlegs[inparty[menupnt[39]]]];
            temp[7006] = temp[7005] + armstradd[inmenuarmor[menupnt[4]]];
            tempstring[702] = str(temp[7006]);
            if (temp[7006] > chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font2, " -> " + tempstring[702]);
            }
            if (temp[7006] < chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font3, " -> " + tempstring[702]);
            }
            if (temp[7006] = chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font, " -> " + tempstring[702]);
            }
            temp[7007] = chasta[inparty[menupnt[39]]] -
                         armstaadd[equippedlegs[inparty[menupnt[39]]]];
            temp[7008] = temp[7007] + armstaadd[inmenuarmor[menupnt[4]]];
            tempstring[703] = str(temp[7008]);
            if (temp[7008] > chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font2, " -> " + tempstring[703]);
            }
            if (temp[7008] < chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font3, " -> " + tempstring[703]);
            }
            if (temp[7008] = chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font, " -> " + tempstring[703]);
            }
            temp[7009] = chaagi[inparty[menupnt[39]]] -
                         armagiadd[equippedlegs[inparty[menupnt[39]]]];
            temp[7010] = temp[7009] + armagiadd[inmenuarmor[menupnt[4]]];
            tempstring[704] = str(temp[7010]);
            if (temp[7010] > chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font2, " -> " + tempstring[704]);
            }
            if (temp[7010] < chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font3, " -> " + tempstring[704]);
            }
            if (temp[7010] = chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font, " -> " + tempstring[704]);
            }
            temp[7011] = chaa[inparty[menupnt[39]]] -
                         armaadd[equippedlegs[inparty[menupnt[39]]]];
            temp[7012] = temp[7011] + armaadd[inmenuarmor[menupnt[4]]];
            tempstring[705] = str(temp[7012]);
            if (temp[7012] > chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font2, " -> " + tempstring[705]);
            }
            if (temp[7012] < chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font3, " -> " + tempstring[705]);
            }
            if (temp[7012] = chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font, " -> " + tempstring[705]);
            }
            temp[7013] = chaint[inparty[menupnt[39]]] -
                         armintadd[equippedlegs[inparty[menupnt[39]]]];
            temp[7014] = temp[7013] + armintadd[inmenuarmor[menupnt[4]]];
            tempstring[706] = str(temp[7014]);
            if (temp[7014] > chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font2, " -> " + tempstring[706]);
            }
            if (temp[7014] < chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font3, " -> " + tempstring[706]);
            }
            if (temp[7014] = chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font, " -> " + tempstring[706]);
            }

            temp[7015] = chrac[inparty[menupnt[39]]] -
                         armacadd[equippedlegs[inparty[menupnt[39]]]];
            temp[7016] = temp[7015] + armacadd[inmenuarmor[menupnt[4]]];
            tempstring[707] = str(temp[7016]);
            if (temp[7016] > chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font2, " -> " + tempstring[707]);
            }
            if (temp[7016] < chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font3, " -> " + tempstring[707]);
            }
            if (temp[7016] = chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font, " -> " + tempstring[707]);
            }
        }
        if (armortype[inmenuarmor[menupnt[4]]] = 2) {
            temp[7001] = chamaxhp[inparty[menupnt[39]]] -
                         armhpadd[equippedhelmet[inparty[menupnt[39]]]];
            temp[7002] = temp[7001] + armhpadd[inmenuarmor[menupnt[4]]];
            tempstring[700] = str(temp[7002]);
            if (temp[7002] > chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font2, " -> " + tempstring[700]);
            }
            if (temp[7002] < chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font3, " -> " + tempstring[700]);
            }
            if (temp[7002] = chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font, " -> " + tempstring[700]);
            }
            temp[7003] = chamaxmp[inparty[menupnt[39]]] -
                         armmpadd[equippedhelmet[inparty[menupnt[39]]]];
            temp[7004] = temp[7003] + armmpadd[inmenuarmor[menupnt[4]]];
            tempstring[701] = str(temp[7004]);
            if (temp[7004] > chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font2, " -> " + tempstring[701]);
            }
            if (temp[7004] < chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font3, " -> " + tempstring[701]);
            }
            if (temp[7004] = chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font, " -> " + tempstring[701]);
            }
            temp[7005] = chastr[inparty[menupnt[39]]] -
                         armstradd[equippedhelmet[inparty[menupnt[39]]]];
            temp[7006] = temp[7005] + armstradd[inmenuarmor[menupnt[4]]];
            tempstring[702] = str(temp[7006]);
            if (temp[7006] > chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font2, " -> " + tempstring[702]);
            }
            if (temp[7006] < chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font3, " -> " + tempstring[702]);
            }
            if (temp[7006] = chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font, " -> " + tempstring[702]);
            }
            temp[7007] = chasta[inparty[menupnt[39]]] -
                         armstaadd[equippedhelmet[inparty[menupnt[39]]]];
            temp[7008] = temp[7007] + armstaadd[inmenuarmor[menupnt[4]]];
            tempstring[703] = str(temp[7008]);
            if (temp[7008] > chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font2, " -> " + tempstring[703]);
            }
            if (temp[7008] < chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font3, " -> " + tempstring[703]);
            }
            if (temp[7008] = chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font, " -> " + tempstring[703]);
            }
            temp[7009] = chaagi[inparty[menupnt[39]]] -
                         armagiadd[equippedhelmet[inparty[menupnt[39]]]];
            temp[7010] = temp[7009] + armagiadd[inmenuarmor[menupnt[4]]];
            tempstring[704] = str(temp[7010]);
            if (temp[7010] > chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font2, " -> " + tempstring[704]);
            }
            if (temp[7010] < chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font3, " -> " + tempstring[704]);
            }
            if (temp[7010] = chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font, " -> " + tempstring[704]);
            }
            temp[7011] = chaa[inparty[menupnt[39]]] -
                         armaadd[equippedhelmet[inparty[menupnt[39]]]];
            temp[7012] = temp[7011] + armaadd[inmenuarmor[menupnt[4]]];
            tempstring[705] = str(temp[7012]);
            if (temp[7012] > chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font2, " -> " + tempstring[705]);
            }
            if (temp[7012] < chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font3, " -> " + tempstring[705]);
            }
            if (temp[7012] = chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font, " -> " + tempstring[705]);
            }
            temp[7013] = chaint[inparty[menupnt[39]]] -
                         armintadd[equippedhelmet[inparty[menupnt[39]]]];
            temp[7014] = temp[7013] + armintadd[inmenuarmor[menupnt[4]]];
            tempstring[706] = str(temp[7014]);
            if (temp[7014] > chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font2, " -> " + tempstring[706]);
            }
            if (temp[7014] < chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font3, " -> " + tempstring[706]);
            }
            if (temp[7014] = chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font, " -> " + tempstring[706]);
            }

            temp[7015] = chrac[inparty[menupnt[39]]] -
                         armacadd[equippedhelmet[inparty[menupnt[39]]]];
            temp[7016] = temp[7015] + armacadd[inmenuarmor[menupnt[4]]];
            tempstring[707] = str(temp[7016]);
            if (temp[7016] > chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font2, " -> " + tempstring[707]);
            }
            if (temp[7016] < chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font3, " -> " + tempstring[707]);
            }
            if (temp[7016] = chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font, " -> " + tempstring[707]);
            }
        }
        if (armortype[inmenuarmor[menupnt[4]]] = 6) {
            temp[7001] = chamaxhp[inparty[menupnt[39]]] -
                         armhpadd[equippedshield[inparty[menupnt[39]]]];
            temp[7002] = temp[7001] + armhpadd[inmenuarmor[menupnt[4]]];
            tempstring[700] = str(temp[7002]);
            if (temp[7002] > chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font2, " -> " + tempstring[700]);
            }
            if (temp[7002] < chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font3, " -> " + tempstring[700]);
            }
            if (temp[7002] = chamaxhp[inparty[menupnt[39]]]) {
                gotoxy(95, 285);
                printstring(font, " -> " + tempstring[700]);
            }
            temp[7003] = chamaxmp[inparty[menupnt[39]]] -
                         armmpadd[equippedshield[inparty[menupnt[39]]]];
            temp[7004] = temp[7003] + armmpadd[inmenuarmor[menupnt[4]]];
            tempstring[701] = str(temp[7004]);
            if (temp[7004] > chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font2, " -> " + tempstring[701]);
            }
            if (temp[7004] < chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font3, " -> " + tempstring[701]);
            }
            if (temp[7004] = chamaxmp[inparty[menupnt[39]]]) {
                gotoxy(95, 295);
                printstring(font, " -> " + tempstring[701]);
            }
            temp[7005] = chastr[inparty[menupnt[39]]] -
                         armstradd[equippedshield[inparty[menupnt[39]]]];
            temp[7006] = temp[7005] + armstradd[inmenuarmor[menupnt[4]]];
            tempstring[702] = str(temp[7006]);
            if (temp[7006] > chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font2, " -> " + tempstring[702]);
            }
            if (temp[7006] < chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font3, " -> " + tempstring[702]);
            }
            if (temp[7006] = chastr[inparty[menupnt[39]]]) {
                gotoxy(95, 305);
                printstring(font, " -> " + tempstring[702]);
            }
            temp[7007] = chasta[inparty[menupnt[39]]] -
                         armstaadd[equippedshield[inparty[menupnt[39]]]];
            temp[7008] = temp[7007] + armstaadd[inmenuarmor[menupnt[4]]];
            tempstring[703] = str(temp[7008]);
            if (temp[7008] > chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font2, " -> " + tempstring[703]);
            }
            if (temp[7008] < chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font3, " -> " + tempstring[703]);
            }
            if (temp[7008] = chasta[inparty[menupnt[39]]]) {
                gotoxy(95, 315);
                printstring(font, " -> " + tempstring[703]);
            }
            temp[7009] = chaagi[inparty[menupnt[39]]] -
                         armagiadd[equippedshield[inparty[menupnt[39]]]];
            temp[7010] = temp[7009] + armagiadd[inmenuarmor[menupnt[4]]];
            tempstring[704] = str(temp[7010]);
            if (temp[7010] > chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font2, " -> " + tempstring[704]);
            }
            if (temp[7010] < chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font3, " -> " + tempstring[704]);
            }
            if (temp[7010] = chaagi[inparty[menupnt[39]]]) {
                gotoxy(95, 325);
                printstring(font, " -> " + tempstring[704]);
            }
            temp[7011] = chaa[inparty[menupnt[39]]] -
                         armaadd[equippedshield[inparty[menupnt[39]]]];
            temp[7012] = temp[7011] + armaadd[inmenuarmor[menupnt[4]]];
            tempstring[705] = str(temp[7012]);
            if (temp[7012] > chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font2, " -> " + tempstring[705]);
            }
            if (temp[7012] < chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font3, " -> " + tempstring[705]);
            }
            if (temp[7012] = chaa[inparty[menupnt[39]]]) {
                gotoxy(95, 335);
                printstring(font, " -> " + tempstring[705]);
            }
            temp[7013] = chaint[inparty[menupnt[39]]] -
                         armintadd[equippedshield[inparty[menupnt[39]]]];
            temp[7014] = temp[7013] + armintadd[inmenuarmor[menupnt[4]]];
            tempstring[706] = str(temp[7014]);
            if (temp[7014] > chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font2, " -> " + tempstring[706]);
            }
            if (temp[7014] < chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font3, " -> " + tempstring[706]);
            }
            if (temp[7014] = chaint[inparty[menupnt[39]]]) {
                gotoxy(95, 345);
                printstring(font, " -> " + tempstring[706]);
            }

            temp[7015] = chrac[inparty[menupnt[39]]] -
                         armacadd[equippedshield[inparty[menupnt[39]]]];
            temp[7016] = temp[7015] + armacadd[inmenuarmor[menupnt[4]]];
            tempstring[707] = str(temp[7016]);
            if (temp[7016] > chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font2, " -> " + tempstring[707]);
            }
            if (temp[7016] < chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font3, " -> " + tempstring[707]);
            }
            if (temp[7016] = chrac[inparty[menupnt[39]]]) {
                gotoxy(95, 355);
                printstring(font, " -> " + tempstring[707]);
            }
        }
    case 4:
        temp[7001] = chamaxhp[inparty[menupnt[39]]] -
                     relichpadd[equippedrelic[inparty[menupnt[39]]]];
        temp[7002] = temp[7001] + relichpadd[inmenurelic[menupnt[4]]];
        tempstring[700] = str(temp[7002]);
        if (temp[7002] > chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font2, " -> " + tempstring[700]);
        }
        if (temp[7002] < chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font3, " -> " + tempstring[700]);
        }
        if (temp[7002] = chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font, " -> " + tempstring[700]);
        }
        temp[7003] = chamaxmp[inparty[menupnt[39]]] -
                     relicmpadd[equippedrelic[inparty[menupnt[39]]]];
        temp[7004] = temp[7003] + relicmpadd[inmenurelic[menupnt[4]]];
        tempstring[701] = str(temp[7004]);
        if (temp[7004] > chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font2, " -> " + tempstring[701]);
        }
        if (temp[7004] < chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font3, " -> " + tempstring[701]);
        }
        if (temp[7004] = chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font, " -> " + tempstring[701]);
        }
        temp[7005] = chastr[inparty[menupnt[39]]] -
                     relicstradd[equippedrelic[inparty[menupnt[39]]]];
        temp[7006] = temp[7005] + relicstradd[inmenurelic[menupnt[4]]];
        tempstring[702] = str(temp[7006]);
        if (temp[7006] > chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font2, " -> " + tempstring[702]);
        }
        if (temp[7006] < chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font3, " -> " + tempstring[702]);
        }
        if (temp[7006] = chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font, " -> " + tempstring[702]);
        }
        temp[7007] = chasta[inparty[menupnt[39]]] -
                     relicstaadd[equippedrelic[inparty[menupnt[39]]]];
        temp[7008] = temp[7007] + relicstaadd[inmenurelic[menupnt[4]]];
        tempstring[703] = str(temp[7008]);
        if (temp[7008] > chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font2, " -> " + tempstring[703]);
        }
        if (temp[7008] < chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font3, " -> " + tempstring[703]);
        }
        if (temp[7008] = chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font, " -> " + tempstring[703]);
        }
        temp[7009] = chaagi[inparty[menupnt[39]]] -
                     relicagiadd[equippedrelic[inparty[menupnt[39]]]];
        temp[7010] = temp[7009] + relicagiadd[inmenurelic[menupnt[4]]];
        tempstring[704] = str(temp[7010]);
        if (temp[7010] > chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font2, " -> " + tempstring[704]);
        }
        if (temp[7010] < chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font3, " -> " + tempstring[704]);
        }
        if (temp[7010] = chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font, " -> " + tempstring[704]);
        }
        temp[7011] = chaa[inparty[menupnt[39]]] -
                     relicaadd[equippedrelic[inparty[menupnt[39]]]];
        temp[7012] = temp[7011] + relicaadd[inmenurelic[menupnt[4]]];
        tempstring[705] = str(temp[7012]);
        if (temp[7012] > chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font2, " -> " + tempstring[705]);
        }
        if (temp[7012] < chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font3, " -> " + tempstring[705]);
        }
        if (temp[7012] = chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font, " -> " + tempstring[705]);
        }
        temp[7013] = chaint[inparty[menupnt[39]]] -
                     relicintadd[equippedrelic[inparty[menupnt[39]]]];
        temp[7014] = temp[7013] + relicintadd[inmenurelic[menupnt[4]]];
        tempstring[706] = str(temp[7014]);
        if (temp[7014] > chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font2, " -> " + tempstring[706]);
        }
        if (temp[7014] < chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font3, " -> " + tempstring[706]);
        }
        if (temp[7014] = chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font, " -> " + tempstring[706]);
        }
    case 3:
        temp[7001] = chamaxhp[inparty[menupnt[39]]] -
                     equhpadd[equippedequipment[inparty[menupnt[39]]]];
        temp[7002] = temp[7001] + equhpadd[inmenuequ[menupnt[4]]];
        tempstring[700] = str(temp[7002]);
        if (temp[7002] > chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font2, " -> " + tempstring[700]);
        }
        if (temp[7002] < chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font3, " -> " + tempstring[700]);
        }
        if (temp[7002] = chamaxhp[inparty[menupnt[39]]]) {
            gotoxy(95, 285);
            printstring(font, " -> " + tempstring[700]);
        }
        temp[7003] = chamaxmp[inparty[menupnt[39]]] -
                     equmpadd[equippedequipment[inparty[menupnt[39]]]];
        temp[7004] = temp[7003] + equmpadd[inmenuequ[menupnt[4]]];
        tempstring[701] = str(temp[7004]);
        if (temp[7004] > chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font2, " -> " + tempstring[701]);
        }
        if (temp[7004] < chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font3, " -> " + tempstring[701]);
        }
        if (temp[7004] = chamaxmp[inparty[menupnt[39]]]) {
            gotoxy(95, 295);
            printstring(font, " -> " + tempstring[701]);
        }
        temp[7005] = chastr[inparty[menupnt[39]]] -
                     equstradd[equippedequipment[inparty[menupnt[39]]]];
        temp[7006] = temp[7005] + equstradd[inmenuequ[menupnt[4]]];
        tempstring[702] = str(temp[7006]);
        if (temp[7006] > chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font2, " -> " + tempstring[702]);
        }
        if (temp[7006] < chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font3, " -> " + tempstring[702]);
        }
        if (temp[7006] = chastr[inparty[menupnt[39]]]) {
            gotoxy(95, 305);
            printstring(font, " -> " + tempstring[702]);
        }
        temp[7007] = chasta[inparty[menupnt[39]]] -
                     equstaadd[equippedequipment[inparty[menupnt[39]]]];
        temp[7008] = temp[7007] + equstaadd[inmenuequ[menupnt[4]]];
        tempstring[703] = str(temp[7008]);
        if (temp[7008] > chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font2, " -> " + tempstring[703]);
        }
        if (temp[7008] < chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font3, " -> " + tempstring[703]);
        }
        if (temp[7008] = chasta[inparty[menupnt[39]]]) {
            gotoxy(95, 315);
            printstring(font, " -> " + tempstring[703]);
        }
        temp[7009] = chaagi[inparty[menupnt[39]]] -
                     equagiadd[equippedequipment[inparty[menupnt[39]]]];
        temp[7010] = temp[7009] + equagiadd[inmenuequ[menupnt[4]]];
        tempstring[704] = str(temp[7010]);
        if (temp[7010] > chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font2, " -> " + tempstring[704]);
        }
        if (temp[7010] < chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font3, " -> " + tempstring[704]);
        }
        if (temp[7010] = chaagi[inparty[menupnt[39]]]) {
            gotoxy(95, 325);
            printstring(font, " -> " + tempstring[704]);
        }
        temp[7011] = chaa[inparty[menupnt[39]]] -
                     equaadd[equippedequipment[inparty[menupnt[39]]]];
        temp[7012] = temp[7011] + equaadd[inmenuequ[menupnt[4]]];
        tempstring[705] = str(temp[7012]);
        if (temp[7012] > chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font2, " -> " + tempstring[705]);
        }
        if (temp[7012] < chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font3, " -> " + tempstring[705]);
        }
        if (temp[7012] = chaa[inparty[menupnt[39]]]) {
            gotoxy(95, 335);
            printstring(font, " -> " + tempstring[705]);
        }
        temp[7013] = chaint[inparty[menupnt[39]]] -
                     equintadd[equippedequipment[inparty[menupnt[39]]]];
        temp[7014] = temp[7013] + equintadd[inmenuequ[menupnt[4]]];
        tempstring[706] = str(temp[7014]);
        if (temp[7014] > chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font2, " -> " + tempstring[706]);
        }
        if (temp[7014] < chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font3, " -> " + tempstring[706]);
        }
        if (temp[7014] = chaint[inparty[menupnt[39]]]) {
            gotoxy(95, 345);
            printstring(font, " -> " + tempstring[706]);
        }
    }
}
void shequs() {
    inmenu[2] = 0;
    a = 100;
    showequs();
    temp[9024] = inmenu[5] + 1;
    For(x = 1; x < temp[9024]; x++) {
        if (equamount[inmenuequ[x]] > 0) {
            gotoxy(10, a);
            printstring(font, equipmentname[inmenuequ[x]]);
            gotoxy(120, a);
            printstring(font, equipmentdesc[inmenuequ[x]]);
            gotoxy(370, a);
            eqamount[inmenuequ[x]] = str(equamount[inmenuequ[x]]);
            printstring(font, eqamount[inmenuequ[x]]);
            a = a + 10;
        }
    }
}
void showequs() {
    b = 1;
    inmenu[5] = 0;
    For(x = 1; x < 100; x++) {
        if (equamount[equ[x]] > 0) {
            inmenuequ[b] = equ[x];
            equamount[inmenuequ[b]] = equamount[equ[x]];
            inmenu[5] = inmenu[5] + 1;
            b = b + 1;
        }
    }
}
void shrelics() {
    inmenu[2] = 0;
    a = 100;
    showrelics();
    temp[9028] = inmenu[6] + 1;
    For(x = 1; x < temp[9028]; x++) {
        if (relicamount[inmenurelic[x]] > 0) {
            gotoxy(10, a);
            printstring(font, relicname[inmenurelic[x]]);
            gotoxy(120, a);
            printstring(font, relicdesc[inmenurelic[x]]);
            gotoxy(370, a);
            relamount[inmenurelic[x]] = str(relicamount[inmenurelic[x]]);
            printstring(font, relamount[inmenurelic[x]]);
            a = a + 10;
        }
    }
}
void showrelics() {
    f = 1;
    inmenu[6] = 0;
    For(x = 1; x < 100; x++) {
        if (relicamount[relic[x]] > 0) {
            inmenurelic[f] = relic[x];
            relicamount[inmenurelic[f]] = relicamount[relic[x]];
            inmenu[6] = inmenu[6] + 1;
            f = f + 1;
        }
    }
}

void sharmors() {
    inmenu[2] = 0;
    a = 100;
    showarmors();
    temp[9027] = inmenu[4] + 1;
    For(x = 1; x < temp[9027]; x++) {
        if (armoramount[inmenuarmor[x]] > 0) {
            gotoxy(10, a);
            printstring(font, armorname[inmenuarmor[x]]);
            gotoxy(120, a);
            armortypes();
            printstring(font, armtype[inmenuarmor[x]]);
            gotoxy(220, a);
            printstring(font, armordesc[inmenuarmor[x]]);
            gotoxy(370, a);
            armamount[inmenuarmor[x]] = str(armoramount[inmenuarmor[x]]);
            printstring(font, armamount[inmenuarmor[x]]);
            if (shop > 0) {
                gotoxy(400, a);
                temp[450] = armorprice[inmenuarmor[x]] / 2;
                tempstring[4] = str(temp[450]);
                printstring(font, tempstring[4]);
            }
            a = a + 10;
        }
    }
}
void showarmors() {
    inmenu[2] = 0;
    c = 1;
    inmenu[4] = 0;
    For(x = 1; x < 300; x++) {
        if (armoramount[armor[x]] > 0) {
            inmenuarmor[c] = armor[x];
            armortype[inmenuarmor[c]] = armortype[armor[x]];
            armoramount[inmenuarmor[c]] = armoramount[armor[x]];
            inmenu[4] = inmenu[4] + 1;
            c = c + 1;
        }
    }
}

void shweapons() {
    inmenu[2] = 0;
    a = 100;
    showweapons();
    temp[9026] = inmenu[3] + 1;
    For(x = 1; x < temp[9026]; x++) {
        if (weaponamount[inmenuweapon[x]] > 0) {
            gotoxy(10, a);
            printstring(font, weaponname[inmenuweapon[x]]);
            gotoxy(120, a);
            weapontypes();
            printstring(font, wetype[inmenuweapon[x]]);
            gotoxy(220, a);
            printstring(font, weapondesc[inmenuweapon[x]]);
            gotoxy(370, a);
            weamount[inmenuweapon[x]] = str(weaponamount[inmenuweapon[x]]);
            printstring(font, weamount[inmenuweapon[x]]);
            if (shop > 0) {
                gotoxy(400, a);
                temp[450] = weaponprice[inmenuweapon[x]] / 2;
                tempstring[4] = str(temp[450]);
                printstring(font, tempstring[4]);
            }
            a = a + 10;
        }
    }
}
void showweapons() {
    inmenu[2] = 0;
    d = 1;
    inmenu[3] = 0;
    For(x = 0; x < 100; x++) {
        if (weaponamount[weapon[x]] > 0) {
            inmenuweapon[d] = weapon[x];
            weaponbasetype[inmenuweapon[d]] = weaponbasetype[weapon[x]];
            weaponamount[inmenuweapon[d]] = weaponamount[weapon[x]];
            inmenu[3] = inmenu[3] + 1;
            d = d + 1;
        }
    }
}

void armortypes() {
    switch (armortype[inmenuarmor[x]]) {
    case 1:
        armtype[inmenuarmor[x]] = "Bodyarmor";
    case 2:
        armtype[inmenuarmor[x]] = "Helmet";
    case 3:
        armtype[inmenuarmor[x]] = "Leggins";
    case 4:
        armtype[inmenuarmor[x]] = "Boots";
    case 5:
        armtype[inmenuarmor[x]] = "Gloves";
    case 6:
        armtype[inmenuarmor[x]] = "Shield";
    }
}
void shoparmortypes() {
    switch (armortype[shoparmor[x]]) {
    case 1:
        armtype[shoparmor[x]] = "Bodyarmor";
    case 2:
        armtype[shoparmor[x]] = "Helmet";
    case 3:
        armtype[shoparmor[x]] = "Leggins";
    case 4:
        armtype[shoparmor[x]] = "Boots";
    case 5:
        armtype[shoparmor[x]] = "Gloves";
    case 6:
        armtype[shoparmor[x]] = "Shield";
    }
}
void weapontypes() {
    switch (weapontype[inmenuweapon[x]]) {
    case 0:
        wetype[inmenuweapon[x]] = "Hands";
    case 1:
        wetype[inmenuweapon[x]] = "Sword";
    case 2:
        wetype[inmenuweapon[x]] = "Knife";
    case 3:
        wetype[inmenuweapon[x]] = "Rapier";
    case 4:
        wetype[inmenuweapon[x]] = "Spear";
    case 5:
        wetype[inmenuweapon[x]] = "Stick";
    case 6:
        wetype[inmenuweapon[x]] = "Javelin";
    case 7:
        wetype[inmenuweapon[x]] = "Saber";
    case 8:
        wetype[inmenuweapon[x]] = "Axe";
    case 9:
        wetype[inmenuweapon[x]] = "Throw";
    case 10:
        wetype[inmenuweapon[x]] = "Sling";
    case 11:
        wetype[inmenuweapon[x]] = "Bow";
    case 12:
        wetype[inmenuweapon[x]] = "Pistol";
    case 13:
        wetype[inmenuweapon[x]] = "Machinegun";
    case 14:
        wetype[inmenuweapon[x]] = "Explosive";
    case 15:
        wetype[inmenuweapon[x]] = "Bazooka";
    case 16:
        wetype[inmenuweapon[x]] = "H.artillery";
    case 17:
        wetype[inmenuweapon[x]] = "Rifle";
    case 18:
        wetype[inmenuweapon[x]] = "Shotgun";
    }
}
void shopweapontypes() {
    switch (weapontype[shopweapon[x]]) {
    case 0:
        wetype[shopweapon[x]] = "Hands";
    case 1:
        wetype[shopweapon[x]] = "Sword";
    case 2:
        wetype[shopweapon[x]] = "Knife";
    case 3:
        wetype[shopweapon[x]] = "Rapier";
    case 4:
        wetype[shopweapon[x]] = "Spear";
    case 5:
        wetype[shopweapon[x]] = "Stick";
    case 6:
        wetype[shopweapon[x]] = "Javelin";
    case 7:
        wetype[shopweapon[x]] = "Saber";
    case 8:
        wetype[shopweapon[x]] = "Axe";
    case 9:
        wetype[shopweapon[x]] = "Throw";
    case 10:
        wetype[shopweapon[x]] = "Sling";
    case 11:
        wetype[shopweapon[x]] = "Bow";
    case 12:
        wetype[shopweapon[x]] = "Pistol";
    case 13:
        wetype[shopweapon[x]] = "Machinegun";
    case 14:
        wetype[shopweapon[x]] = "Explosive";
    case 15:
        wetype[shopweapon[x]] = "Bazooka";
    case 16:
        wetype[shopweapon[x]] = "H.artillery";
    case 17:
        wetype[shopweapon[x]] = "Rifle";
    case 18:
        wetype[shopweapon[x]] = "Shotgun";
    }
}
void spelltypes() {
    switch (spelltype[spell[x]]) {
    case 1:
        spetype[spell[x]] = "Heal(Hp)";
    case 2:
        spetype[spell[x]] = "Heal(Mp)";
    case 3:
        spetype[spell[x]] = "Heal(Mp+Hp)";
    case 4:
        spetype[spell[x]] = "Heal(Poison)";
    case 5:
        spetype[spell[x]] = "Heal(Sleep)";
    case 6:
        spetype[spell[x]] = "Heal(Confusion)";
    case 7:
        spetype[spell[x]] = "Heal(Silence)";
    case 8:
        spetype[spell[x]] = "Heal(Stroke)";
    case 9:
        spetype[spell[x]] = "Heal(Curse)";
    case 10:
        spetype[spell[x]] = "Heal(All)";
    case 11:
        spetype[spell[x]] = "Raise stats(Str)";
    case 12:
        spetype[spell[x]] = "Raise stats(Agi)";
    case 13:
        spetype[spell[x]] = "Raise stats(Ac)";
    case 14:
        spetype[spell[x]] = "Raise stats(A)";
    case 15:
        spetype[spell[x]] = "Raise stats(Sta)";
    case 16:
        spetype[spell[x]] = "Raise stats(Int)";
    case 17:
        spetype[spell[x]] = "Raise stats(THAC0)";
    case 18:
        spetype[spell[x]] = "Attack(Fire)";
    case 19:
        spetype[spell[x]] = "Attack(Earth)";
    case 20:
        spetype[spell[x]] = "Attack(Wind)";
    case 21:
        spetype[spell[x]] = "Attack(Water)";
    case 22:
        spetype[spell[x]] = "Attack(Black)";
    case 23:
        spetype[spell[x]] = "Attack(Status)";
    case 24:
        spetype[spell[x]] = "Attack(Summon)";
    case 25:
        spetype[spell[x]] = "Attack(Nonelement)";
    case 26:
        spetype[spell[x]] = "Attack(Ice)";
    }
}

void spellnames() {
    spellname[1] = "Cure";
    spelltype[1] = 1;
    spellpointcost[1] = 10;
    spellhealamount[1] = 20;
    spellbasetype[1] = 1;
    spelldesc[1] = "Heals 20 Hp";
    spellname[2] = "Flame";
    spelltype[2] = 18;
    spellpointcost[2] = 15;
    spellbasetype[2] = 2;
    spelldamage[2] = 15 + random(10);
    spelldesc[2] = "A small fire";
    spellname[4] = "Quake";
    spellname[5] = "Revive";
    spellname[6] = "Heal";
    spellname[7] = "Wave";
    spellname[3] = "Ice";
    spelltype[3] = 26;
    spellpointcost[3] = 20;
    spellbasetype[3] = 2;
    spelldesc[3] = "turns enemy to ice";
    spelldamage[3] = 15 + random(10);
}
void shspells() {
    a = 100;
    // showspells();
    For(x = 1; x < 10; x++) {
        if (gotspell[x] = 1) {
            spell[x] = x;
            gotoxy(10, a);
            printstring(font, spellname[x]);
            gotoxy(120, a);
            spelltypes();
            printstring(font, spetype[x]);
            gotoxy(220, a);
            printstring(font, spelldesc[x]);
            gotoxy(370, a);
            spepointcost[x] = str(spellpointcost[x]);
            printstring(font, spepointcost[x]);
            a = a + 10;
        }
    }
}
void showspells() {
    y = 1;
    For(x = 1; x < 500; x++) {
        if (gotspell[spell[x]] = 1) {
            inmenuspell[y] = spell[x];
            spellhealamount[inmenuspell[y]] = spellhealamount[spell[x]];
            spellpointcost[inmenuspell[y]] = spellpointcost[spell[x]];
            spellbasetype[inmenuspell[y]] = spellbasetype[spell[x]];
            spelldamage[inmenuspell[y]] = spelldamage[spell[x]];
            y = y + 1;
        }
    }
}
void scond() {
    if (charpoisoned[inparty[menupnt[30]]] =
            0 && charpara[inparty[menupnt[30]]] =
                0 && charcurse[inparty[menupnt[30]]] =
                    0 && charsleep[inparty[menupnt[30]]] =
                        0 && charsilence[inparty[menupnt[30]]] =
                            0 && charskillness[inparty[menupnt[30]]] =
                                0 && charstroke[inparty[menupnt[30]]] =
                                    0 && chargrazy[inparty[menupnt[30]]] =
                                        0 && charzombie[inparty[menupnt[30]]] =
                                            0 &&
                                            charberserk[inparty[menupnt[30]]] =
                                                0 &&
                                                charblind
                                                    [inparty[menupnt[30]]] =
                                                    0) {
        chacond[inparty[menupnt[30]]] = "Fine";
        gotoxy(15, 385);
        printstring(1, chacond[inparty[x]]);
    }
    if (charpoisoned[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "P";
        gotoxy(15, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (charpara[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "R";
        gotoxy(25, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (charcurse[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "C";
        gotoxy(35, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (charsleep[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "S";
        gotoxy(45, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (charsilence[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "L";
        gotoxy(55, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (charskillness[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "K";
        gotoxy(65, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (chargrazy[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "G";
        gotoxy(75, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (charzombie[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "Z";
        gotoxy(85, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (charberserk[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "B";
        gotoxy(95, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }

    if (charstroke[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "U";
        gotoxy(105, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
    if (charblind[inparty[menupnt[30]]] = 1) {
        chacond[inparty[menupnt[30]]] = "A";
        gotoxy(115, 385);
        printstring(font4, chacond[inparty[menupnt[30]]]);
    }
}
void magicmenu() {
    loadmenupics();
    spellnames();
    menupnt[5] = 1;
    menupnt[46] = 1;
    unpress(key[28]);
    render();
    while (mmenu = 5) {
        render();
        spellmenuparts();
        TscaleSprite(0, 90 + (10 * menupnt[5]), 7, 9, 7, 9, pointer1);
        shspells();
        Tcopysprite(465, 450, 179, 29, mpic3);
        gotoxy(490, 455);
        printstring(font, "Select spell");
        showtime();
        showpage();
        updatecontrols();
        If(key[80]) {
            menupnt[5]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            menupnt[5]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[5] < 1) { menupnt[5] = spellsinmenu; }
        if (menupnt[5] > spellsinmenu) {
            menupnt[5] = 1;
        }
        if (key[29]) {
            unpress(key[29]);
            if (battlegoing = 0) {
                mmenu = 1;
            }
            if (battlegoing = 1) {
                mmenu = 0;
                battle = 0;
                battleselections();
            }
        }
        if (key[28]) {
            if (champ[inparty[magi]] < spellpointcost[spell[menupnt[5]]]) {
                unpress(key[28]);
                mmenu = 30;
                while (mmenu = 30) {
                    render();
                    spellmenuparts();
                    TscaleSprite(
                        0, 90 + (10 * menupnt[5]), 7, 9, 7, 9, pointer1);
                    shspells();
                    Tcopysprite(465, 450, 179, 29, mpic3);
                    gotoxy(470, 455);
                    printstring(font, "Not enough magicpoints!!");
                    showtime();
                    showpage();
                    updatecontrols();
                    if (key[28]) {
                        unpress(key[28]);
                        vara[17] = 1;
                        mmenu = 5;
                    }
                }
            }
            if (spellbasetype[spell[menupnt[5]]] = 2 && battlegoing =
                    1 &&
                    champ[inparty[magi]] >= spellpointcost[spell[menupnt[5]]]) {
                unpress(key[28]);
                spellused = spell[menupnt[5]];
                mmenu = 0;
                render();
            }
            if (spellbasetype[spell[menupnt[5]]] = 1 && battlegoing =
                    1 &&
                    champ[inparty[magi]] >= spellpointcost[spell[menupnt[5]]]) {
                unpress(key[28]);
                spellused = spell[menupnt[5]];
                mmenu = 0;
                render();
            }

            if (spellbasetype[spell[menupnt[5]]] = 1 && battlegoing =
                    0 &&
                    champ[inparty[magi]] >= spellpointcost[spell[menupnt[5]]]) {
                unpress(key[28]);
                mmenu = 20;
                menupnt[30] = 1;
                while (mmenu = 20) {
                    render();
                    spellmenuparts();
                    TscaleSprite(
                        0, 90 + (10 * menupnt[2]), 7, 9, 7, 9, pointer1);
                    switch (menupnt[30]) {
                    case 1:
                        TscaleSprite(480, 70, 7, 9, 7, 9, pointer1);
                    case 2:
                        TscaleSprite(540, 70, 7, 9, 7, 9, pointer1);
                    case 3:
                        TscaleSprite(480, 130, 7, 9, 7, 9, pointer1);
                    case 4:
                        TscaleSprite(540, 130, 7, 9, 7, 9, pointer1);
                    case 5:
                        TscaleSprite(480, 190, 7, 9, 7, 9, pointer1);
                    case 6:
                        TscaleSprite(540, 190, 7, 9, 7, 9, pointer1);
                    case 7:
                        TscaleSprite(480, 250, 7, 9, 7, 9, pointer1);
                    case 8:
                        TscaleSprite(540, 250, 7, 9, 7, 9, pointer1);
                    }
                    Tcopysprite(465, 450, 179, 29, mpic3);
                    gotoxy(490, 455);
                    printstring(font, "Use it to whom?");
                    shspells();
                    showtime();
                    showpage();
                    updatecontrols();
                    If(key[77]) {
                        menupnt[30]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[75]) {
                        menupnt[30]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[30] < 1) { menupnt[30] = numchars; }
                    If(menupnt[30] > numchars) { menupnt[30] = 1; }
                    If(key[80]) {
                        menupnt[30]++;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(key[72]) {
                        menupnt[30]--;
                        playsound(menuitemsound, 64, 128);
                        del(10, 0, 0, 0);
                    }
                    If(menupnt[30] < 1) { menupnt[30] = numchars; }
                    if (menupnt[30] > numchars) {
                        menupnt[30] = 1;
                    }
                    if (key[29]) {
                        unpress(key[29]);
                        mmenu = 5;
                    }
                    if (key[28]) {
                        unpress(key[28]);
                        mmenu = 21;
                        charhp[inparty[menupnt[30]]] =
                            str(chahp[inparty[menupnt[30]]]);
                        charmaxhp[inparty[menupnt[30]]] =
                            str(chamaxhp[inparty[menupnt[30]]]);
                        charmp[inparty[menupnt[30]]] =
                            str(champ[inparty[menupnt[30]]]);
                        charmaxmp[inparty[menupnt[30]]] =
                            str(chamaxmp[inparty[menupnt[30]]]);
                        charstr[inparty[menupnt[30]]] =
                            str(chastr[inparty[menupnt[30]]]);
                        charsta[inparty[menupnt[30]]] =
                            str(chasta[inparty[menupnt[30]]]);
                        charagi[inparty[menupnt[30]]] =
                            str(chaagi[inparty[menupnt[30]]]);
                        chara[inparty[menupnt[30]]] =
                            str(chaa[inparty[menupnt[30]]]);
                        charint[inparty[menupnt[30]]] =
                            str(chaint[inparty[menupnt[30]]]);
                        charac[inparty[menupnt[30]]] =
                            str(chrac[inparty[menupnt[30]]]);
                        charws[inparty[menupnt[30]]] =
                            str(chaws[inparty[menupnt[30]]]);
                        while (mmenu = 21) {
                            render();
                            spellmenuparts();
                            shspells();
                            tcopysprite(10, 160, 178, 318, mpic6);
                            Tcopysprite(
                                15, 165, 96, 96, charpic[inparty[menupnt[30]]]);
                            gotoxy(15, 265);
                            printstring(font, charname[inparty[menupnt[30]]]);
                            gotoxy(15, 285);
                            printstring(font,
                                "Hp: " + charhp[inparty[menupnt[30]]] + " / " +
                                    charmaxhp[inparty[menupnt[30]]]);
                            gotoxy(15, 295);
                            printstring(font,
                                "Mp: " + charmp[inparty[menupnt[30]]] + " / " +
                                    charmaxmp[inparty[menupnt[30]]]);
                            gotoxy(15, 305);
                            printstring(
                                font, "Str: " + charstr[inparty[menupnt[30]]]);
                            gotoxy(15, 315);
                            printstring(
                                font, "Sta: " + charsta[inparty[menupnt[30]]]);
                            gotoxy(15, 325);
                            printstring(
                                font, "Agi: " + charagi[inparty[menupnt[30]]]);
                            gotoxy(15, 335);
                            printstring(
                                font, "A: " + chara[inparty[menupnt[30]]]);
                            gotoxy(15, 345);
                            printstring(
                                font, "Int: " + charint[inparty[menupnt[30]]]);
                            gotoxy(15, 355);
                            printstring(
                                font, "Ac: " + charac[inparty[menupnt[30]]]);
                            gotoxy(15, 365);
                            printstring(
                                font, "Ws: " + charws[inparty[menupnt[30]]]);
                            scond();
                            Tcopysprite(465, 380, 179, 29, mpic3);
                            Tcopysprite(465, 410, 179, 29, mpic3);
                            switch (menupnt[46]) {
                            case 1:
                                TscaleSprite(485, 415, 7, 9, 7, 9, pointer1);
                            case 2:
                                TscaleSprite(555, 415, 7, 9, 7, 9, pointer1);
                            }
                            gotoxy(490, 385);
                            printstring(font, "Are you sure?");
                            gotoxy(490, 415);
                            printstring(font, " Yes ");
                            gotoxy(560, 415);
                            printstring(font, " No ");
                            showtime();
                            showpage();
                            updatecontrols();
                            If(key[77]) {
                                menupnt[46]++;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            If(key[75]) {
                                menupnt[46]--;
                                playsound(menuitemsound, 64, 128);
                                del(10, 0, 0, 0);
                            }
                            if (menupnt[46] < 1) {
                                menupnt[46] = 2;
                            }
                            if (menupnt[46] > 2) {
                                menupnt[46] = 1;
                            }
                            if (key[29]) {
                                unpress(key[29]);
                                mmenu = 20;
                            }
                            if (key[28] && menupnt[46] = 2) {
                                unpress(key[28]);
                                mmenu = 5;
                            }
                            if (key[28] && menupnt[46] = 1) {
                                unpress(key[28]);
                                mmenu = 22;
                                if (gotspell[spell[menupnt[5]]] > 0 &&
                                        champ[inparty[magi]] > 0 &&
                                        charsilence[inparty[magi]] = 0) {
                                    switch (spelltype[spell[menupnt[5]]]) {
                                    case 1:
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        temp[8000] =
                                            chamaxhp[inparty[menupnt[30]]] -
                                            chahp[inparty[menupnt[30]]];
                                        chahp[inparty[menupnt[30]]] =
                                            chahp[inparty[menupnt[30]]] +
                                            spellhealamount[spell[menupnt[5]]];
                                        if (chahp[inparty[menupnt[30]]] >
                                            chamaxhp[inparty[menupnt[30]]]) {
                                            chahp[inparty[menupnt[30]]] =
                                                chamaxhp[inparty[menupnt[30]]];
                                        }
                                        champ[inparty[magi]] =
                                            champ[inparty[magi]] -
                                            spellpointcost[spell[menupnt[5]]];
                                        if (deadchar[menupnt[30]] =
                                                0 &&
                                                chahp[inparty[menupnt[30]]] >
                                                    0) {
                                            charstroke[inparty[menupnt[30]]] =
                                                0;
                                            deadchar[menupnt[30]] = 1;
                                            entity.specframe
                                                [battlechar[menupnt[30]]] = 0;
                                        }
                                        if (champ[inparty[magi]] < 0) {
                                            champ[inparty[magi]] = 0;
                                        }
                                        shspells();
                                    }
                                    charhp[inparty[menupnt[30]]] =
                                        str(chahp[inparty[menupnt[30]]]);
                                    charmaxhp[inparty[menupnt[30]]] =
                                        str(chamaxhp[inparty[menupnt[30]]]);
                                    charmp[inparty[menupnt[30]]] =
                                        str(champ[inparty[menupnt[30]]]);
                                    charmaxmp[inparty[menupnt[30]]] =
                                        str(chamaxmp[inparty[menupnt[30]]]);
                                    charstr[inparty[menupnt[30]]] =
                                        str(chastr[inparty[menupnt[30]]]);
                                    charsta[inparty[menupnt[30]]] =
                                        str(chasta[inparty[menupnt[30]]]);
                                    charagi[inparty[menupnt[30]]] =
                                        str(chaagi[inparty[menupnt[30]]]);
                                    chara[inparty[menupnt[30]]] =
                                        str(chaa[inparty[menupnt[30]]]);
                                    charint[inparty[menupnt[30]]] =
                                        str(chaint[inparty[menupnt[30]]]);
                                    charac[inparty[menupnt[30]]] =
                                        str(chrac[inparty[menupnt[30]]]);
                                    charws[inparty[menupnt[30]]] =
                                        str(chaws[inparty[menupnt[30]]]);
                                }
                                while (mmenu = 22) {
                                    render();
                                    spellmenuparts();
                                    shspells();
                                    tcopysprite(10, 160, 178, 318, mpic6);
                                    Tcopysprite(15, 165, 96, 96,
                                        charpic[inparty[menupnt[30]]]);
                                    gotoxy(15, 265);
                                    printstring(
                                        font, charname[inparty[menupnt[30]]]);
                                    gotoxy(15, 285);
                                    printstring(font,
                                        "Hp: " + charhp[inparty[menupnt[30]]] +
                                            " / " +
                                            charmaxhp[inparty[menupnt[30]]]);
                                    gotoxy(15, 295);
                                    printstring(font,
                                        "Mp: " + charmp[inparty[menupnt[30]]] +
                                            " / " +
                                            charmaxmp[inparty[menupnt[30]]]);
                                    gotoxy(15, 305);
                                    printstring(font,
                                        "Str: " +
                                            charstr[inparty[menupnt[30]]]);
                                    gotoxy(15, 315);
                                    printstring(font,
                                        "Sta: " +
                                            charsta[inparty[menupnt[30]]]);
                                    gotoxy(15, 325);
                                    printstring(font,
                                        "Agi: " +
                                            charagi[inparty[menupnt[30]]]);
                                    gotoxy(15, 335);
                                    printstring(font,
                                        "A: " + chara[inparty[menupnt[30]]]);
                                    gotoxy(15, 345);
                                    printstring(font,
                                        "Int: " +
                                            charint[inparty[menupnt[30]]]);
                                    gotoxy(15, 355);
                                    printstring(font,
                                        "Ac: " + charac[inparty[menupnt[30]]]);
                                    gotoxy(15, 365);
                                    printstring(font,
                                        "Ws: " + charws[inparty[menupnt[30]]]);
                                    scond();
                                    Tcopysprite(465, 450, 179, 29, mpic3);
                                    gotoxy(490, 455);
                                    printstring(font, "Spell casted!!!");
                                    showpage();
                                    updatecontrols();
                                    if (key[28]) {
                                        if (battlegoing = 0) {
                                            unpress(key[28]);
                                            mmenu = 5;
                                        }
                                        if (battlegoing = 1) {
                                            unpress(key[28]);
                                            mmenu = 0;
                                            render();
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

void skillsmenu() {
    loadmenupics();
    while (mmenu = 4) {
        render();
        Tcopysprite(0, 0, 640, 480, mpic1);
        Tcopysprite(0, 0, 179, 29, mpic3);
        gotoXY(10, 10);
        printstring(1, "SKILLS");
        if (inparty[1] > 0) {
            Tscalesprite(490, 20, 96, 96, 48, 48, charpic[inparty[1]]);
            gotoXY(490, 70);
            printstring(font, charname[inparty[1]]);
        }
        if (inparty[2] > 0) {
            Tscalesprite(550, 20, 96, 96, 48, 48, charpic[inparty[2]]);
            gotoXY(550, 70);
            printstring(font, charname[inparty[2]]);
        }
        if (inparty[3] > 0) {
            Tscalesprite(490, 80, 96, 96, 48, 48, charpic[inparty[3]]);
            gotoXY(490, 130);
            printstring(font, charname[inparty[3]]);
        }
        if (inparty[4] > 0) {
            Tscalesprite(550, 80, 96, 96, 48, 48, charpic[inparty[4]]);
            gotoXY(550, 130);
            printstring(font, charname[inparty[4]]);
        }
        if (inparty[5] > 0) {
            Tscalesprite(490, 140, 96, 96, 48, 48, charpic[inparty[5]]);
            gotoXY(490, 190);
            printstring(font, charname[inparty[5]]);
        }
        if (inparty[6] > 0) {
            Tscalesprite(550, 140, 96, 96, 48, 48, charpic[inparty[6]]);
            gotoXY(550, 190);
            printstring(font, charname[inparty[6]]);
        }
        if (inparty[7] > 0) {
            Tscalesprite(490, 200, 96, 96, 48, 48, charpic[inparty[7]]);
            gotoXY(490, 250);
            printstring(font, charname[inparty[7]]);
        }
        if (inparty[8] > 0) {
            Tscalesprite(550, 200, 96, 96, 48, 48, charpic[inparty[8]]);
            gotoXY(550, 250);
            printstring(font, charname[inparty[8]]);
        }
        showtime();
        showpage();
        updatecontrols();
        if (key[29]) {
            unpress(key[29]);
            mmenu = 1;
        }
    }
}
void statusmenu() {
    charpotr[1] = loadimage("eportr.pcx");
    loadmenupics();
    charmaxhp[inparty[stat]] = str(chamaxhp[inparty[stat]]);
    charmp[inparty[stat]] = str(champ[inparty[stat]]);
    charmaxmp[inparty[stat]] = str(chamaxmp[inparty[stat]]);
    charstr[inparty[stat]] = str(chastr[inparty[stat]]);
    charsta[inparty[stat]] = str(chasta[inparty[stat]]);
    charagi[inparty[stat]] = str(chaagi[inparty[stat]]);
    chara[inparty[stat]] = str(chaa[inparty[stat]]);
    charint[inparty[stat]] = str(chaint[inparty[stat]]);
    charac[inparty[stat]] = str(chrac[inparty[stat]]);
    charws[inparty[stat]] = str(chaws[inparty[stat]]);
    while (mmenu = 3) {
        render();
        Tcopysprite(0, 0, 640, 480, mpic1);
        Tcopysprite(0, 0, 179, 29, mpic3);
        gotoXY(10, 10);
        printstring(1, "STATUS");
        showstatus();
        gotoxy(15, 255);
        printstring(font, "Str: " + charstr[inparty[stat]]);
        gotoxy(15, 265);
        printstring(font, "Sta: " + charsta[inparty[stat]]);
        gotoxy(15, 275);
        printstring(font, "Agi: " + charagi[inparty[stat]]);
        gotoxy(15, 285);
        printstring(font, "A: " + chara[inparty[stat]]);
        gotoxy(15, 295);
        printstring(font, "Int: " + charint[inparty[stat]]);
        gotoxy(15, 305);
        printstring(font, "Ac: " + charac[inparty[stat]]);
        gotoxy(15, 315);
        printstring(font, "Ws: " + charws[inparty[stat]]);
        gotoxy(15, 335);
        printstring(
            font, "Weapon: " + weaponname[equippedweapon[inparty[stat]]]);
        gotoxy(15, 345);
        printstring(
            font, "Shield: " + armorname[equippedshield[inparty[stat]]]);
        gotoxy(15, 355);
        printstring(font, "Armor: " + armorname[equippedarmor[inparty[stat]]]);
        gotoxy(15, 365);
        printstring(
            font, "Helmet: " + armorname[equippedhelmet[inparty[stat]]]);
        gotoxy(15, 375);
        printstring(font, "Legs: " + armorname[equippedlegs[inparty[stat]]]);
        gotoxy(15, 385);
        printstring(
            font, "Ac1: " + equipmentname[equippedequipment[inparty[stat]]]);
        gotoxy(15, 395);
        printstring(font, "Ac2: " + relicname[equippedrelic[inparty[stat]]]);
        statuscharconditions();
        showtime();
        showpage();
        updatecontrols();
        if (key[29]) {
            unpress(key[29]);
            if (battlegoing = 0) {
                mmenu = 1;
            }
            if (battlegoing = 1) {
                mmenu = 0;
                battle = 0;
                battleselections();
            }
        }
    }
}
void itemmenuparts() {
    Tcopysprite(0, 0, 640, 480, mpic1);
    Tcopysprite(0, 0, 179, 29, mpic3);
    gotoXY(10, 10);
    printstring(1, "ITEM");
    if (inparty[1] > 0) {
        Tscalesprite(490, 20, 96, 96, 48, 48, charpic[inparty[1]]);
        gotoXY(490, 70);
        printstring(font, charname[inparty[1]]);
    }
    if (inparty[2] > 0) {
        Tscalesprite(550, 20, 96, 96, 48, 48, charpic[inparty[2]]);
        gotoXY(550, 70);
        printstring(font, charname[inparty[2]]);
    }
    if (inparty[3] > 0) {
        Tscalesprite(490, 80, 96, 96, 48, 48, charpic[inparty[3]]);
        gotoXY(490, 130);
        printstring(font, charname[inparty[3]]);
    }
    if (inparty[4] > 0) {
        Tscalesprite(550, 80, 96, 96, 48, 48, charpic[inparty[4]]);
        gotoXY(550, 130);
        printstring(font, charname[inparty[4]]);
    }
    if (inparty[5] > 0) {
        Tscalesprite(490, 140, 96, 96, 48, 48, charpic[inparty[5]]);
        gotoXY(490, 190);
        printstring(font, charname[inparty[5]]);
    }
    if (inparty[6] > 0) {
        Tscalesprite(550, 140, 96, 96, 48, 48, charpic[inparty[6]]);
        gotoXY(550, 190);
        printstring(font, charname[inparty[6]]);
    }
    if (inparty[7] > 0) {
        Tscalesprite(490, 200, 96, 96, 48, 48, charpic[inparty[7]]);
        gotoXY(490, 250);
        printstring(font, charname[inparty[7]]);
    }
    if (inparty[8] > 0) {
        Tscalesprite(550, 200, 96, 96, 48, 48, charpic[inparty[8]]);
        gotoXY(550, 250);
        printstring(font, charname[inparty[8]]);
    }
    gotoxy(10, 80);
    printstring(font, "Item name:");
    gotoxy(120, 80);
    printstring(font, "Item type:");
    gotoxy(220, 80);
    printstring(font, "Item description:");
    gotoxy(350, 80);
    printstring(font, "Amount:");
    maxpages = 6;
    maxpage = str(maxpages);
    itempages = str(itempage);
    GotoXY(350, 60);
    Printstring(1, itempages);
    printstring(1, " / ");
    printstring(1, maxpage);
}
void equipmenuparts() {
    inmenu[2] = 0;
    Tcopysprite(0, 0, 640, 480, mpic1);
    Tcopysprite(0, 0, 179, 29, mpic3);
    gotoXY(10, 10);
    printstring(1, "EQUIP");
    if (inparty[1] > 0) {
        Tscalesprite(490, 20, 96, 96, 48, 48, charpic[inparty[1]]);
        gotoXY(490, 70);
        printstring(font, charname[inparty[1]]);
    }
    if (inparty[2] > 0) {
        Tscalesprite(550, 20, 96, 96, 48, 48, charpic[inparty[2]]);
        gotoXY(550, 70);
        printstring(font, charname[inparty[2]]);
    }
    if (inparty[3] > 0) {
        Tscalesprite(490, 80, 96, 96, 48, 48, charpic[inparty[3]]);
        gotoXY(490, 130);
        printstring(font, charname[inparty[3]]);
    }
    if (inparty[4] > 0) {
        Tscalesprite(550, 80, 96, 96, 48, 48, charpic[inparty[4]]);
        gotoXY(550, 130);
        printstring(font, charname[inparty[4]]);
    }
    if (inparty[5] > 0) {
        Tscalesprite(490, 140, 96, 96, 48, 48, charpic[inparty[5]]);
        gotoXY(490, 190);
        printstring(font, charname[inparty[5]]);
    }
    if (inparty[6] > 0) {
        Tscalesprite(550, 140, 96, 96, 48, 48, charpic[inparty[6]]);
        gotoXY(550, 190);
        printstring(font, charname[inparty[6]]);
    }
    if (inparty[7] > 0) {
        Tscalesprite(490, 200, 96, 96, 48, 48, charpic[inparty[7]]);
        gotoXY(490, 250);
        printstring(font, charname[inparty[7]]);
    }
    if (inparty[8] > 0) {
        Tscalesprite(550, 200, 96, 96, 48, 48, charpic[inparty[8]]);
        gotoXY(550, 250);
        printstring(font, charname[inparty[8]]);
    }
    maxpages = 6;
    maxpage = str(maxpages);
    itempages = str(itempage);
    GotoXY(350, 60);
    Printstring(1, itempages);
    printstring(1, " / ");
    printstring(1, maxpage);
}

void spellmenuparts() {
    Tcopysprite(0, 0, 640, 480, mpic1);
    Tcopysprite(0, 0, 179, 29, mpic3);
    gotoXY(10, 10);
    printstring(1, "Magic");
    if (inparty[1] > 0) {
        Tscalesprite(490, 20, 96, 96, 48, 48, charpic[inparty[1]]);
        gotoXY(490, 70);
        printstring(font, charname[inparty[1]]);
    }
    if (inparty[2] > 0) {
        Tscalesprite(550, 20, 96, 96, 48, 48, charpic[inparty[2]]);
        gotoXY(550, 70);
        printstring(font, charname[inparty[2]]);
    }
    if (inparty[3] > 0) {
        Tscalesprite(490, 80, 96, 96, 48, 48, charpic[inparty[3]]);
        gotoXY(490, 130);
        printstring(font, charname[inparty[3]]);
    }
    if (inparty[4] > 0) {
        Tscalesprite(550, 80, 96, 96, 48, 48, charpic[inparty[4]]);
        gotoXY(550, 130);
        printstring(font, charname[inparty[4]]);
    }
    if (inparty[5] > 0) {
        Tscalesprite(490, 140, 96, 96, 48, 48, charpic[inparty[5]]);
        gotoXY(490, 190);
        printstring(font, charname[inparty[5]]);
    }
    if (inparty[6] > 0) {
        Tscalesprite(550, 140, 96, 96, 48, 48, charpic[inparty[6]]);
        gotoXY(550, 190);
        printstring(font, charname[inparty[6]]);
    }
    if (inparty[7] > 0) {
        Tscalesprite(490, 200, 96, 96, 48, 48, charpic[inparty[7]]);
        gotoXY(490, 250);
        printstring(font, charname[inparty[7]]);
    }
    if (inparty[8] > 0) {
        Tscalesprite(550, 200, 96, 96, 48, 48, charpic[inparty[8]]);
        gotoXY(550, 250);
        printstring(font, charname[inparty[8]]);
    }
    gotoxy(10, 80);
    printstring(font, "Spell name:");
    gotoxy(120, 80);
    printstring(font, "Spell type:");
    gotoxy(220, 80);
    printstring(font, "Spell description:");
    gotoxy(360, 80);
    printstring(font, "Sp cost:");
    maxpages = 6;
    maxpage = str(maxpages);
    itempages = str(itempage);
    GotoXY(350, 60);
    Printstring(1, itempages);
    printstring(1, " / ");
    printstring(1, maxpage);
}
void infomenuparts() {
    Tcopysprite(0, 0, 640, 480, mpic1);
    Tcopysprite(0, 0, 179, 29, mpic3);
    gotoXY(10, 10);
    printstring(1, "Info");
    if (inparty[1] > 0) {
        Tscalesprite(490, 20, 96, 96, 48, 48, charpic[inparty[1]]);
        gotoXY(490, 70);
        printstring(font, charname[inparty[1]]);
    }
    if (inparty[2] > 0) {
        Tscalesprite(550, 20, 96, 96, 48, 48, charpic[inparty[2]]);
        gotoXY(550, 70);
        printstring(font, charname[inparty[2]]);
    }
    if (inparty[3] > 0) {
        Tscalesprite(490, 80, 96, 96, 48, 48, charpic[inparty[3]]);
        gotoXY(490, 130);
        printstring(font, charname[inparty[3]]);
    }
    if (inparty[4] > 0) {
        Tscalesprite(550, 80, 96, 96, 48, 48, charpic[inparty[4]]);
        gotoXY(550, 130);
        printstring(font, charname[inparty[4]]);
    }
    if (inparty[5] > 0) {
        Tscalesprite(490, 140, 96, 96, 48, 48, charpic[inparty[5]]);
        gotoXY(490, 190);
        printstring(font, charname[inparty[5]]);
    }
    if (inparty[6] > 0) {
        Tscalesprite(550, 140, 96, 96, 48, 48, charpic[inparty[6]]);
        gotoXY(550, 190);
        printstring(font, charname[inparty[6]]);
    }
    if (inparty[7] > 0) {
        Tscalesprite(490, 200, 96, 96, 48, 48, charpic[inparty[7]]);
        gotoXY(490, 250);
        printstring(font, charname[inparty[7]]);
    }
    if (inparty[8] > 0) {
        Tscalesprite(550, 200, 96, 96, 48, 48, charpic[inparty[8]]);
        gotoXY(550, 250);
        printstring(font, charname[inparty[8]]);
    }
}
void itemparts() {
    render();
    itemmenuparts();
    shitems();
    tcopysprite(10, 160, 178, 318, mpic6);
    Tcopysprite(15, 165, 96, 96, charpic[inparty[menupnt[30]]]);
    gotoxy(15, 265);
    printstring(font, charname[inparty[menupnt[30]]]);
    gotoxy(15, 285);
    printstring(font, "Hp: " + charhp[inparty[menupnt[30]]] + " / " +
                          charmaxhp[inparty[menupnt[30]]]);
    gotoxy(15, 295);
    printstring(font, "Mp: " + charmp[inparty[menupnt[30]]] + " / " +
                          charmaxmp[inparty[menupnt[30]]]);
    gotoxy(15, 305);
    printstring(font, "Str: " + charstr[inparty[menupnt[30]]]);
    gotoxy(15, 315);
    printstring(font, "Sta: " + charsta[inparty[menupnt[30]]]);
    gotoxy(15, 325);
    printstring(font, "Agi: " + charagi[inparty[menupnt[30]]]);
    gotoxy(15, 335);
    printstring(font, "A: " + chara[inparty[menupnt[30]]]);
    gotoxy(15, 345);
    printstring(font, "Int: " + charint[inparty[menupnt[30]]]);
    gotoxy(15, 355);
    printstring(font, "Ac: " + charac[inparty[menupnt[30]]]);
    gotoxy(15, 365);
    printstring(font, "Ws: " + charws[inparty[menupnt[30]]]);
    scond();
}
void itemmenu() {
    maxmenuitems = 32;
    loadmenupics();
    menupnt[2] = 1;
    menupnt[47] = 1;
    itemnames();
    unpress(key[28]);
    while (mmenu = 2) {
        render();
        itemmenuparts();
        TscaleSprite(0, 90 + (10 * menupnt[2]), 7, 9, 7, 9, pointer1);
        shitems();
        showtime();
        showpage();
        updatecontrols();
        If(key[77]) {
            itempage++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[75]) {
            itempage--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(itempage < 1) { itempage = 6; }
        If(itempage > 6) { itempage = 1; }
        If(key[80]) {
            menupnt[2]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            menupnt[2]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[2] < 1) { menupnt[2] = inmenu[1]; }
        if (menupnt[2] > inmenu[1]) {
            menupnt[2] = 1;
        }
        if (key[29]) {
            unpress(key[29]);
            if (battlegoing = 0) {
                mmenu = 1;
                render();
            }
            if (battlegoing = 1) {
                mmenu = 0;
                battle = 0;
                battleselections();
                render();
            }
        }

        if (key[28] && itemtype[inmenuitem[menupnt[2]]] < 26) {
            unpress(key[28]);
            mmenu = 20;
            menupnt[30] = 1;
            while (mmenu = 20) {
                render();
                itemmenuparts();
                TscaleSprite(0, 90 + (10 * menupnt[2]), 7, 9, 7, 9, pointer1);
                switch (menupnt[30]) {
                case 1:
                    TscaleSprite(480, 70, 7, 9, 7, 9, pointer1);
                case 2:
                    TscaleSprite(540, 70, 7, 9, 7, 9, pointer1);
                case 3:
                    TscaleSprite(480, 130, 7, 9, 7, 9, pointer1);
                case 4:
                    TscaleSprite(540, 130, 7, 9, 7, 9, pointer1);
                case 5:
                    TscaleSprite(480, 190, 7, 9, 7, 9, pointer1);
                case 6:
                    TscaleSprite(540, 190, 7, 9, 7, 9, pointer1);
                case 7:
                    TscaleSprite(480, 250, 7, 9, 7, 9, pointer1);
                case 8:
                    TscaleSprite(540, 250, 7, 9, 7, 9, pointer1);
                }
                Tcopysprite(465, 450, 179, 29, mpic3);
                gotoxy(490, 455);
                printstring(font, "Use it to whom?");
                shitems();
                showtime();
                showpage();
                updatecontrols();
                If(key[77]) {
                    menupnt[30]++;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(key[75]) {
                    menupnt[30]--;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(menupnt[30] < 1) { menupnt[30] = numchars; }
                If(menupnt[30] > numchars) { menupnt[30] = 1; }
                If(key[80]) {
                    menupnt[30]++;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(key[72]) {
                    menupnt[30]--;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(menupnt[30] < 1) { menupnt[30] = numchars; }
                if (menupnt[30] > numchars) {
                    menupnt[30] = 1;
                }
                if (key[29]) {
                    unpress(key[29]);
                    mmenu = 2;
                    render();
                }
                if (key[28]) {
                    unpress(key[28]);
                    mmenu = 21;
                    charhp[inparty[menupnt[30]]] =
                        str(chahp[inparty[menupnt[30]]]);
                    charmaxhp[inparty[menupnt[30]]] =
                        str(chamaxhp[inparty[menupnt[30]]]);
                    charmp[inparty[menupnt[30]]] =
                        str(champ[inparty[menupnt[30]]]);
                    charmaxmp[inparty[menupnt[30]]] =
                        str(chamaxmp[inparty[menupnt[30]]]);
                    charstr[inparty[menupnt[30]]] =
                        str(chastr[inparty[menupnt[30]]]);
                    charsta[inparty[menupnt[30]]] =
                        str(chasta[inparty[menupnt[30]]]);
                    charagi[inparty[menupnt[30]]] =
                        str(chaagi[inparty[menupnt[30]]]);
                    chara[inparty[menupnt[30]]] =
                        str(chaa[inparty[menupnt[30]]]);
                    charint[inparty[menupnt[30]]] =
                        str(chaint[inparty[menupnt[30]]]);
                    charac[inparty[menupnt[30]]] =
                        str(chrac[inparty[menupnt[30]]]);
                    charws[inparty[menupnt[30]]] =
                        str(chaws[inparty[menupnt[30]]]);
                    while (mmenu = 21) {
                        itemparts();
                        Tcopysprite(465, 380, 179, 29, mpic3);
                        Tcopysprite(465, 410, 179, 29, mpic3);
                        switch (menupnt[47]) {
                        case 1:
                            TscaleSprite(485, 415, 7, 9, 7, 9, pointer1);
                        case 2:
                            TscaleSprite(555, 415, 7, 9, 7, 9, pointer1);
                        }
                        gotoxy(490, 385);
                        printstring(font, "Are you sure?");
                        gotoxy(490, 415);
                        printstring(font, " Yes ");
                        gotoxy(560, 415);
                        printstring(font, " No ");
                        showtime();
                        showpage();
                        updatecontrols();
                        If(key[77]) {
                            menupnt[47]++;
                            playsound(menuitemsound, 64, 128);
                            del(10, 0, 0, 0);
                        }
                        If(key[75]) {
                            menupnt[47]--;
                            playsound(menuitemsound, 64, 128);
                            del(10, 0, 0, 0);
                        }
                        if (menupnt[47] < 1) {
                            menupnt[47] = 2;
                        }
                        if (menupnt[47] > 2) {
                            menupnt[47] = 1;
                        }
                        if (key[29]) {
                            unpress(key[29]);
                            mmenu = 20;
                            render();
                        }
                        if (key[28] && menupnt[47] = 2) {
                            unpress(key[28]);
                            mmenu = 2;
                        }
                        if (key[28] && menupnt[47] = 1) {
                            unpress(key[28]);
                            mmenu = 22;
                            if (itemamount[inmenuitem[menupnt[2]]] > 0) {
                                switch (itemtype[inmenuitem[menupnt[2]]]) {
                                case 1:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    temp[8000] =
                                        chamaxhp[inparty[menupnt[30]]] -
                                        chahp[inparty[menupnt[30]]];
                                    chahp[inparty[menupnt[30]]] =
                                        chahp[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    if (temp[8000] >
                                        healamount[inmenuitem[menupnt[2]]]) {
                                        partyspirit =
                                            partyspirit +
                                            healamount[inmenuitem[menupnt[2]]];
                                    }
                                    if (temp[8000] = healamount
                                            [inmenuitem[menupnt[2]]]) {
                                        partyspirit =
                                            partyspirit +
                                            healamount[inmenuitem[menupnt[2]]];
                                    }
                                    if (temp[8000] <
                                        healamount[inmenuitem[menupnt[2]]]) {
                                        partyspirit = partyspirit + temp[8000];
                                    }
                                    if (partyspirit > maxpartyspirit) {
                                        partyspirit = maxpartyspirit;
                                    }
                                    partspirit = str(partyspirit);
                                    if (chahp[inparty[menupnt[30]]] >
                                        chamaxhp[inparty[menupnt[30]]]) {
                                        chahp[inparty[menupnt[30]]] =
                                            chamaxhp[inparty[menupnt[30]]];
                                    }
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                    if (deadchar[menupnt[30]] =
                                            0 &&
                                            chahp[inparty[menupnt[30]]] > 0) {
                                        deadchar[menupnt[30]] = 1;
                                        charstroke[inparty[menupnt[30]]] = 0;
                                        entity.specframe
                                            [battlechar[menupnt[30]]] = 0;
                                    }
                                case 2:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    temp[8000] =
                                        chamaxmp[inparty[menupnt[30]]] -
                                        champ[inparty[menupnt[30]]];
                                    champ[inparty[menupnt[30]]] =
                                        champ[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    if (champ[inparty[menupnt[30]]] >
                                        chamaxmp[inparty[menupnt[30]]]) {
                                        champ[inparty[menupnt[30]]] =
                                            chamaxmp[inparty[menupnt[30]]];
                                    }
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                    if (deadchar[menupnt[30]] =
                                            0 &&
                                            chahp[inparty[menupnt[30]]] > 0) {
                                        deadchar[menupnt[30]] = 1;
                                        entity.specframe
                                            [battlechar[menupnt[30]]] = 0;
                                    }
                                case 3:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    temp[8000] =
                                        chamaxhp[inparty[menupnt[30]]] -
                                        chahp[inparty[menupnt[30]]];
                                    chahp[inparty[menupnt[30]]] =
                                        chahp[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    if (temp[8000] >
                                        healamount[inmenuitem[menupnt[2]]]) {
                                        partyspirit =
                                            partyspirit +
                                            healamount[inmenuitem[menupnt[2]]];
                                    }
                                    if (temp[8000] = healamount
                                            [inmenuitem[menupnt[2]]]) {
                                        partyspirit =
                                            partyspirit +
                                            healamount[inmenuitem[menupnt[2]]];
                                    }
                                    if (temp[8000] <
                                        healamount[inmenuitem[menupnt[2]]]) {
                                        partyspirit = partyspirit + temp[8000];
                                    }
                                    if (partyspirit > maxpartyspirit) {
                                        partyspirit = maxpartyspirit;
                                    }
                                    partspirit = str(partyspirit);
                                    if (chahp[inparty[menupnt[30]]] >
                                        chamaxhp[inparty[menupnt[30]]]) {
                                        chahp[inparty[menupnt[30]]] =
                                            chamaxhp[inparty[menupnt[30]]];
                                    }
                                    temp[8000] =
                                        chamaxmp[inparty[menupnt[30]]] -
                                        champ[inparty[menupnt[30]]];
                                    champ[inparty[menupnt[30]]] =
                                        champ[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    if (champ[inparty[menupnt[30]]] >
                                        chamaxmp[inparty[menupnt[30]]]) {
                                        champ[inparty[menupnt[30]]] =
                                            chamaxmp[inparty[menupnt[30]]];
                                    }
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                    if (deadchar[menupnt[30]] =
                                            0 &&
                                            chahp[inparty[menupnt[30]]] > 0) {
                                        deadchar[menupnt[30]] = 1;
                                        charstroke[inparty[menupnt[30]]] = 0;
                                        entity.specframe
                                            [battlechar[menupnt[30]]] = 0;
                                    }
                                case 4:
                                    if (charpoisoned[inparty[menupnt[30]]] =
                                            0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }
                                    if (charpoisoned[inparty[menupnt[30]]] =
                                            1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charpoisoned[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 5:
                                    if (charsleep[inparty[menupnt[30]]] = 0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }
                                    if (charsleep[inparty[menupnt[30]]] = 1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charsleep[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 6:
                                    if (charsilence[inparty[menupnt[30]]] = 0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }
                                    if (charsilence[inparty[menupnt[30]]] = 1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charsilence[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 7:
                                    if (chargrazy[inparty[menupnt[30]]] = 0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }

                                    if (chargrazy[inparty[menupnt[30]]] = 1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        chargrazy[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 8:
                                    if (charskillness[inparty[menupnt[30]]] =
                                            0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }
                                    if (charskillness[inparty[menupnt[30]]] =
                                            1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charskillness[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 10:
                                    if (charcurse[inparty[menupnt[30]]] = 0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }

                                    if (charcurse[inparty[menupnt[30]]] = 1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charcurse[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 11:
                                    if (charpoisoned[inparty[menupnt[30]]] =
                                            0 &&
                                            charpara[inparty[menupnt[30]]] =
                                                0 &&
                                                charcurse
                                                    [inparty[menupnt[30]]] =
                                                    0 &&
                                                    charsleep
                                                        [inparty[menupnt[30]]] =
                                                        0 &&
                                                        charsilence[inparty
                                                                [menupnt[30]]] =
                                                            0 &&
                                                            charskillness
                                                                [inparty[menupnt
                                                                        [30]]] =
                                                                0 &&
                                                                charstroke
                                                                    [inparty[menupnt
                                                                            [30]]] =
                                                                    0 &&
                                                                    chargrazy[menupnt
                                                                            [30]] =
                                                                        0 &&
                                                                        charzombie[menupnt
                                                                                [30]] =
                                                                            0 &&
                                                                            charberserk[menupnt
                                                                                    [30]] =
                                                                                0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }
                                    ELSE {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        if (charcurse[inparty[menupnt[30]]] =
                                                1) {
                                            charcurse[inparty[menupnt[30]]] = 0;
                                        }
                                        if (charpoisoned[inparty[menupnt[30]]] =
                                                1) {
                                            charpoisoned[inparty[menupnt[30]]] =
                                                0;
                                        }
                                        if (charsleep[inparty[menupnt[30]]] =
                                                1) {
                                            charsleep[inparty[menupnt[30]]] = 0;
                                        }
                                        if (charsilence[inparty[menupnt[30]]] =
                                                1) {
                                            charsilence[inparty[menupnt[30]]] =
                                                0;
                                        }
                                        if (charskillness
                                                [inparty[menupnt[30]]] = 1) {
                                            charskillness
                                                [inparty[menupnt[30]]] = 0;
                                        }
                                        if (chargrazy[inparty[menupnt[30]]] =
                                                1) {
                                            chargrazy[inparty[menupnt[30]]] = 0;
                                        }
                                        if (charberserk[inparty[menupnt[30]]] =
                                                1) {
                                            charberserk[inparty[menupnt[30]]] =
                                                0;
                                        }
                                        if (charzombie[inparty[menupnt[30]]] =
                                                1) {
                                            charzombie[inparty[menupnt[30]]] =
                                                0;
                                        }
                                        if (charpara[inparty[menupnt[30]]] =
                                                1) {
                                            charpara[inparty[menupnt[30]]] = 0;
                                        }
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 22:
                                    if (charberserk[inparty[menupnt[30]]] = 0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }

                                    if (charberserk[inparty[menupnt[30]]] = 1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charberserk[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 23:
                                    if (charzombie[inparty[menupnt[30]]] = 0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }
                                    if (charzombie[inparty[menupnt[30]]] = 1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charzombie[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 24:
                                    if (charpara[inparty[menupnt[30]]] = 0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }

                                    if (charpara[inparty[menupnt[30]]] = 1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charpara[inparty[menupnt[30]]] = 0;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 25:
                                    if (charblind[inparty[menupnt[30]]] = 0) {
                                        mmenu = 23;
                                        while (mmenu = 23) {
                                            itemparts();
                                            Tcopysprite(
                                                465, 450, 179, 29, mpic3);
                                            gotoxy(490, 455);
                                            printstring(font, "No effect..");
                                            showtime();
                                            showpage();
                                            updatecontrols();
                                            if (key[28]) {
                                                unpress(key[28]);
                                                mmenu = 22;
                                            }
                                        }
                                    }
                                    if (charblind[inparty[menupnt[30]]] = 1) {
                                        soundeffect[9] =
                                            cachesound("heal1.wav");
                                        playsound(soundeffect[9], 64, 128);
                                        charblind[inparty[menupnt[30]]] = 0;
                                        chaws[inparty[menupnt[30]]] = 85;
                                        itemamount[inmenuitem[menupnt[2]]] =
                                            itemamount[inmenuitem[menupnt[2]]] -
                                            1;
                                        if (itemamount[inmenuitem[menupnt[2]]] <
                                            0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        if (itemamount[inmenuitem[menupnt[2]]] =
                                                0) {
                                            inmenu[1] = inmenu[1] - 1;
                                        }
                                        itamount[inmenuitem[menupnt[2]]] = str(
                                            itemamount[inmenuitem[menupnt[2]]]);
                                    }
                                case 13:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chastr[inparty[menupnt[30]]] =
                                        chastr[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                case 14:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chamaxhp[inparty[menupnt[30]]] =
                                        chamaxhp[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                case 15:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chamaxmp[inparty[menupnt[30]]] =
                                        chamaxmp[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                case 16:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chaagi[inparty[menupnt[30]]] =
                                        chaagi[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                case 17:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chasta[inparty[menupnt[30]]] =
                                        chasta[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                case 18:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chaa[inparty[menupnt[30]]] =
                                        chaa[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                case 19:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chaint[inparty[menupnt[30]]] =
                                        chaint[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                case 20:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chaws[inparty[menupnt[30]]] =
                                        chaws[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                case 21:
                                    soundeffect[9] = cachesound("heal1.wav");
                                    playsound(soundeffect[9], 64, 128);
                                    chrac[inparty[menupnt[30]]] =
                                        chrac[inparty[menupnt[30]]] +
                                        healamount[inmenuitem[menupnt[2]]];
                                    itemamount[inmenuitem[menupnt[2]]] =
                                        itemamount[inmenuitem[menupnt[2]]] - 1;
                                    if (itemamount[inmenuitem[menupnt[2]]] <
                                        0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    if (itemamount[inmenuitem[menupnt[2]]] =
                                            0) {
                                        inmenu[1] = inmenu[1] - 1;
                                    }
                                    itamount[inmenuitem[menupnt[2]]] =
                                        str(itemamount[inmenuitem[menupnt[2]]]);
                                    shitems();
                                }
                                charhp[inparty[menupnt[30]]] =
                                    str(chahp[inparty[menupnt[30]]]);
                                charmaxhp[inparty[menupnt[30]]] =
                                    str(chamaxhp[inparty[menupnt[30]]]);
                                charmp[inparty[menupnt[30]]] =
                                    str(champ[inparty[menupnt[30]]]);
                                charmaxmp[inparty[menupnt[30]]] =
                                    str(chamaxmp[inparty[menupnt[30]]]);
                                charstr[inparty[menupnt[30]]] =
                                    str(chastr[inparty[menupnt[30]]]);
                                charsta[inparty[menupnt[30]]] =
                                    str(chasta[inparty[menupnt[30]]]);
                                charagi[inparty[menupnt[30]]] =
                                    str(chaagi[inparty[menupnt[30]]]);
                                chara[inparty[menupnt[30]]] =
                                    str(chaa[inparty[menupnt[30]]]);
                                charint[inparty[menupnt[30]]] =
                                    str(chaint[inparty[menupnt[30]]]);
                                charac[inparty[menupnt[30]]] =
                                    str(chrac[inparty[menupnt[30]]]);
                                charws[inparty[menupnt[30]]] =
                                    str(chaws[inparty[menupnt[30]]]);
                            }
                            while (mmenu = 22) {
                                itemparts();
                                showtime();
                                showpage();
                                updatecontrols();
                                if (key[28]) {
                                    if (battlegoing = 0) {
                                        unpress(key[28]);
                                        mmenu = 2;
                                    }
                                    if (battlegoing = 1) {
                                        unpress(key[28]);
                                        mmenu = 0;
                                        render();
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

void clock() {
    ms++;
    If(ms = 100) {
        sec++;
        ms = 0;
    }
    If(sec = 60) {
        min++;
        sec = 0;
    }
    If(sec < 10) { col1 = ":0"; }
    Else { col1 = ":"; }
    If(min = 60) {
        hour++;
        min = 0;
    }
    If(min < 10) { col2 = ":0"; }
    Else { col2 = ":"; }
    time = str(hour) + col2 + str(min) + col1 + str(sec);
}
void charbeginning() {
    menupnt[9] = 1;
    inparty[1] = 1;
    deadchar[1] = 1;
    character[1] = 1;
    character[2] = 0;
    character[3] = 0;
    character[4] = 0;
    charexp[1] = 0;
    charexp[3] = 350;
    crowns = 0;
    crownamount = str(crowns);
    for (x = 1; x < 500; x++) {
        itemamount[x] = 0;
    }
    characternames();
    charexp[3] = 0;
    For(x = 0; x < 50; x++) {
        stone[x] = 0;
        ichest[x] = 0;
        wochest[x] = 0;
    }
    chalevel[1] = 0;
    loadmenupics();
    numchars = 1;
    For(x = 1; x < 500; x++) {
        item[x] = x;
        weapon[x] = x;
    }
    For(x = 1; x < 300; x++) { armor[x] = x; }
    For(x = 1; x < 100; x++) {
        spell[x] = x;
        equ[x] = x;
        relic[x] = x;
    }
    itemnames();
    spellnames();
    equipmentnames();
    armornames();
    gotspell[1] = 1;
    spellsinmenu = 1;
    equippedweapon[1] = 1;
    equippedarmor[1] = 1;
    equippedhelmet[1] = 0;
    equippedlegs[1] = 4;
    equippedshield[1] = 0;
    equippedrelic[1] = 0;
    equippedequipment[1] = 0;
    weaponamount[0] = 1;
    weaponnames();
    tonext[1] = 50;
    tonext[4] = 45;
    tonext[6] = 55;
    tonext[7] = 55;
    tnext[1] = str(tonext[1]);
    tnext[4] = str(tonext[4]);
    tnext[6] = str(tonext[6]);
    tnext[7] = str(tonext[7]);
    basehp[1] = 75;
    basehp[4] = 60;
    basehp[6] = 50;
    basehp[7] = 65;
    partyspirit = 200;
    maxpartyspirit = 200;
    statistics(1);
}
void relicnames() {
    relicname[0] = "None";
    relicname[1] = "Pendant";
    relichpadd[1] = 0;
    relicmpadd[1] = 0;
    relicstradd[1] = 0;
    relicstaadd[1] = 2;
    relicagiadd[1] = 0;
    relicaadd[1] = 0;
    relicintadd[1] = 0;
    relicdesc[1] = "Protective pendant";
}
void statistics(int char) {
    if (char = 1) {
        chamaxhp[1] = basehp[1] + whpadd[equippedweapon[1]] +
                      armhpadd[equippedarmor[1]] + armhpadd[equippedhelmet[1]] +
                      armhpadd[equippedlegs[1]] + armhpadd[equippedshield[1]] +
                      equhpadd[equippedequipment[1]] +
                      relichpadd[equippedrelic[1]];
        if (loaded = 0) {
            chahp[1] = chamaxhp[1];
        }
        chamaxmp[1] = 50 + wmpadd[equippedweapon[1]] +
                      armmpadd[equippedarmor[1]] + armmpadd[equippedhelmet[1]] +
                      armmpadd[equippedlegs[1]] + armmpadd[equippedshield[1]] +
                      equmpadd[equippedequipment[1]] +
                      relicmpadd[equippedrelic[1]];
        if (loaded = 0) {
            champ[1] = chamaxmp[1];
        }
        chaa[1] = 1 + waadd[equippedweapon[1]] + armaadd[equippedarmor[1]] +
                  armaadd[equippedhelmet[1]] + armaadd[equippedlegs[1]] +
                  armaadd[equippedshield[1]] + equaadd[equippedequipment[1]] +
                  relicaadd[equippedrelic[1]];
        chasta[1] = 3 + wstaadd[equippedweapon[1]] +
                    armstaadd[equippedarmor[1]] + armstaadd[equippedhelmet[1]] +
                    armstaadd[equippedlegs[1]] + armstaadd[equippedshield[1]] +
                    equstaadd[equippedequipment[1]] +
                    relicstaadd[equippedrelic[1]];
        chaagi[1] = 4 + wagiadd[equippedweapon[1]] +
                    armagiadd[equippedarmor[1]] + armagiadd[equippedhelmet[1]] +
                    armagiadd[equippedlegs[1]] + armagiadd[equippedshield[1]] +
                    equagiadd[equippedequipment[1]] +
                    relicagiadd[equippedrelic[1]];
        chastr[1] = 3 + wstradd[equippedweapon[1]] +
                    armstradd[equippedarmor[1]] + armstradd[equippedhelmet[1]] +
                    armstradd[equippedlegs[1]] + armstradd[equippedshield[1]] +
                    equstradd[equippedequipment[1]] +
                    relicstradd[equippedrelic[1]];
        chaint[1] = 9 + wintadd[equippedweapon[1]] +
                    armintadd[equippedarmor[1]] + armintadd[equippedhelmet[1]] +
                    armintadd[equippedlegs[1]] + armintadd[equippedshield[1]] +
                    equintadd[equippedequipment[1]] +
                    relicintadd[equippedrelic[1]];
        chrac[1] = 0 + wacadd[equippedweapon[1]] + armacadd[equippedarmor[1]] +
                   armacadd[equippedhelmet[1]] + armacadd[equippedlegs[1]] +
                   armacadd[equippedshield[1]];
        chaws[1] = 85;
    }
    if (char = 4) {
        chamaxhp[4] = basehp[4] + whpadd[equippedweapon[4]] +
                      armhpadd[equippedarmor[4]] + armhpadd[equippedhelmet[4]] +
                      armhpadd[equippedlegs[4]] + armhpadd[equippedshield[4]] +
                      equhpadd[equippedequipment[4]] +
                      relichpadd[equippedrelic[4]];
        if (loaded = 0) {
            chahp[4] = chamaxhp[4];
        }
        chamaxmp[4] = 0;
        champ[4] = 0;
        chaa[4] = 1 + waadd[equippedweapon[4]] + armaadd[equippedarmor[4]] +
                  armaadd[equippedhelmet[4]] + armaadd[equippedlegs[4]] +
                  armaadd[equippedshield[4]] + equaadd[equippedequipment[4]] +
                  relicaadd[equippedrelic[4]];
        chasta[4] = 3 + wstaadd[equippedweapon[4]] +
                    armstaadd[equippedarmor[4]] + armstaadd[equippedhelmet[4]] +
                    armstaadd[equippedlegs[4]] + armstaadd[equippedshield[4]] +
                    equstaadd[equippedequipment[4]] +
                    relicstaadd[equippedrelic[4]];
        chaagi[4] = 5 + wagiadd[equippedweapon[4]] +
                    armagiadd[equippedarmor[4]] + armagiadd[equippedhelmet[4]] +
                    armagiadd[equippedlegs[4]] + armagiadd[equippedshield[4]] +
                    equagiadd[equippedequipment[4]] +
                    relicagiadd[equippedrelic[4]];
        chastr[4] = 3 + wstradd[equippedweapon[4]] +
                    armstradd[equippedarmor[4]] + armstradd[equippedhelmet[4]] +
                    armstradd[equippedlegs[4]] + armstradd[equippedshield[4]] +
                    equstradd[equippedequipment[4]] +
                    relicstradd[equippedrelic[4]];
        chaint[4] = 7 + wintadd[equippedweapon[4]] +
                    armintadd[equippedarmor[4]] + armintadd[equippedhelmet[4]] +
                    armintadd[equippedlegs[4]] + armintadd[equippedshield[4]] +
                    equintadd[equippedequipment[4]] +
                    relicintadd[equippedrelic[4]];
        chrac[4] = 0 + wacadd[equippedweapon[4]] + armacadd[equippedarmor[4]] +
                   armacadd[equippedhelmet[4]] + armacadd[equippedlegs[4]] +
                   armacadd[equippedshield[4]];
        chaws[4] = 85;
    }
    if (char = 6) {
        chamaxhp[6] = basehp[6] + whpadd[equippedweapon[6]] +
                      armhpadd[equippedarmor[6]] + armhpadd[equippedhelmet[6]] +
                      armhpadd[equippedlegs[6]] + armhpadd[equippedshield[6]] +
                      equhpadd[equippedequipment[6]] +
                      relichpadd[equippedrelic[6]];
        if (loaded = 0) {
            chahp[6] = chamaxhp[6];
        }
        chamaxmp[6] = 0;
        champ[6] = 0;
        chaa[6] = 1 + waadd[equippedweapon[6]] + armaadd[equippedarmor[6]] +
                  armaadd[equippedhelmet[6]] + armaadd[equippedlegs[6]] +
                  armaadd[equippedshield[6]] + equaadd[equippedequipment[6]] +
                  relicaadd[equippedrelic[6]];
        chasta[6] = 3 + wstaadd[equippedweapon[6]] +
                    armstaadd[equippedarmor[6]] + armstaadd[equippedhelmet[6]] +
                    armstaadd[equippedlegs[6]] + armstaadd[equippedshield[6]] +
                    equstaadd[equippedequipment[6]] +
                    relicstaadd[equippedrelic[6]];
        chaagi[6] = 4 + wagiadd[equippedweapon[6]] +
                    armagiadd[equippedarmor[6]] + armagiadd[equippedhelmet[6]] +
                    armagiadd[equippedlegs[6]] + armagiadd[equippedshield[6]] +
                    equagiadd[equippedequipment[6]] +
                    relicagiadd[equippedrelic[6]];
        chastr[6] = 2 + wstradd[equippedweapon[6]] +
                    armstradd[equippedarmor[6]] + armstradd[equippedhelmet[6]] +
                    armstradd[equippedlegs[6]] + armstradd[equippedshield[6]] +
                    equstradd[equippedequipment[6]] +
                    relicstradd[equippedrelic[6]];
        chaint[6] = 8 + wintadd[equippedweapon[6]] +
                    armintadd[equippedarmor[6]] + armintadd[equippedhelmet[6]] +
                    armintadd[equippedlegs[6]] + armintadd[equippedshield[6]] +
                    equintadd[equippedequipment[6]] +
                    relicintadd[equippedrelic[6]];
        chrac[6] = 0 + wacadd[equippedweapon[6]] + armacadd[equippedarmor[6]] +
                   armacadd[equippedhelmet[6]] + armacadd[equippedlegs[6]] +
                   armacadd[equippedshield[6]];
        chaws[6] = 85;
    }
    if (char = 7) {
        chamaxhp[7] = basehp[7] + whpadd[equippedweapon[7]] +
                      armhpadd[equippedarmor[7]] + armhpadd[equippedhelmet[7]] +
                      armhpadd[equippedlegs[7]] + armhpadd[equippedshield[7]] +
                      equhpadd[equippedequipment[7]] +
                      relichpadd[equippedrelic[7]];
        if (loaded = 0) {
            chahp[7] = chamaxhp[7];
        }
        chamaxmp[7] = 0;
        champ[7] = 0;
        chaa[7] = 1 + waadd[equippedweapon[7]] + armaadd[equippedarmor[7]] +
                  armaadd[equippedhelmet[7]] + armaadd[equippedlegs[7]] +
                  armaadd[equippedshield[7]] + equaadd[equippedequipment[7]] +
                  relicaadd[equippedrelic[7]];
        chasta[7] = 3 + wstaadd[equippedweapon[7]] +
                    armstaadd[equippedarmor[7]] + armstaadd[equippedhelmet[7]] +
                    armstaadd[equippedlegs[7]] + armstaadd[equippedshield[7]] +
                    equstaadd[equippedequipment[7]] +
                    relicstaadd[equippedrelic[7]];
        chaagi[7] = 4 + wagiadd[equippedweapon[7]] +
                    armagiadd[equippedarmor[7]] + armagiadd[equippedhelmet[7]] +
                    armagiadd[equippedlegs[7]] + armagiadd[equippedshield[7]] +
                    equagiadd[equippedequipment[7]] +
                    relicagiadd[equippedrelic[7]];
        chastr[7] = 2 + wstradd[equippedweapon[7]] +
                    armstradd[equippedarmor[7]] + armstradd[equippedhelmet[7]] +
                    armstradd[equippedlegs[7]] + armstradd[equippedshield[7]] +
                    equstradd[equippedequipment[7]] +
                    relicstradd[equippedrelic[7]];
        chaint[7] = 8 + wintadd[equippedweapon[7]] +
                    armintadd[equippedarmor[7]] + armintadd[equippedhelmet[7]] +
                    armintadd[equippedlegs[7]] + armintadd[equippedshield[7]] +
                    equintadd[equippedequipment[7]] +
                    relicintadd[equippedrelic[7]];
        chrac[7] = 0 + wacadd[equippedweapon[7]] + armacadd[equippedarmor[7]] +
                   armacadd[equippedhelmet[7]] + armacadd[equippedlegs[7]] +
                   armacadd[equippedshield[7]];
        chaws[7] = 85;
    }
}

void levels() {}
void experience() {}
void itemnames() {
    itemname[1] = "Energydrink";
    itemtype[1] = 1;
    healamount[1] = 20;
    itemprice[1] = 10;
    itemname[2] = "Apple";
    itemtype[2] = 1;
    healamount[2] = 5;
    itemprice[2] = 5;
    itemname[3] = "Milk";
    itemtype[3] = 1;
    healamount[3] = 5;
    itemprice[3] = 2;
    itemname[4] = "Chocolatebar";
    itemtype[4] = 1;
    healamount[4] = 10;
    itemprice[4] = 5;
    itemname[5] = "Orange";
    itemtype[5] = 1;
    healamount[5] = 15;
    itemprice[5] = 4;
    itemname[6] = "Medikit";
    healamount[6] = 50;
    itemtype[6] = 1;
    itemprice[6] = 25;
    itemname[7] = "Hp potion";
    itemprice[7] = 55;
    healamount[7] = 50;
    itemtype[7] = 1;
    itemdesc[7] = "Heals  50 hp";
    itemname[8] = "Mp potion";
    itemprice[8] = 30;
    healamount[8] = 20;
    itemtype[8] = 2;
    itemdesc[8] = "Heals  20 Mp";
    itemname[9] = "Iodine";
    itemprice[9] = 20;
    healamount[9] = 1;
    itemtype[9] = 17;
    itemdesc[9] = "Raises sta by 1";
    itemname[10] = "Codliveroil";
    itemprice[10] = 20;
    itemtype[10] = 19;
    healamount[10] = 1;
    itemdesc[10] = "Raises Int by 1";
    itemname[11] = "Camphordrops";
    itemprice[11] = 35;
    itemdesc[11] = "Raises Agi by 1";
    itemtype[11] = 16;
    healamount[11] = 1;
    itemname[13] = "Gungaleaf ";
    itemtype[13] = 4;
    itemprice[13] = 15;
    itemname[12] = "Tarnak fruit ";
    itemprice[12] = 20;
    itemtype[12] = 13;
    healamount[12] = 1;
    itemname[14] = "Gingseng";
    itemprice[14] = 20;
    itemtype[14] = 24;
    itemdesc[14] = "Cures paralyze";
    itemname[15] = "Coldwater";
    itemprice[15] = 20;
    itemtype[15] = 5;
    itemdesc[15] = "Cures sleepiness";
    itemname[16] = "Prayer";
    itemprice[16] = 20;
    itemtype[16] = 10;
    itemdesc[16] = "Cures curse";
    itemname[17] = "Soulpotion";
    itemprice[17] = 25;
    itemtype[17] = 23;
    itemdesc[17] = "Cures Zombie";
    itemname[18] = "Blackcurrant";
    itemprice[18] = 15;
    itemtype[18] = 8;
    itemdesc[18] = "Cures skillness";
    itemname[19] = "Mouthwash";
    itemprice[19] = 15;
    itemtype[19] = 6;
    itemdesc[19] = "Cures silence";
    itemname[20] = "Red bottle";
    itemprice[20] = 25;
    itemtype[20] = 7;
    itemdesc[20] = "Cures Insanity";
    itemname[21] = "Tranquilizer";
    itemprice[21] = 35;
    itemtype[21] = 22;
    itemdesc[21] = "Cures berserk";
    itemname[22] = "Deadrat";
    itemtype[22] = 26;
    itemdesc[22] = "a Rat carcass";
    itemname[23] = "Deadspider";
    itemtype[23] = 26;
    itemdesc[23] = "a Spider carcass";
    itemname[24] = "Deadslime";
    itemtype[24] = 26;
    itemdesc[24] = "a Slime carcass";
    itemname[25] = "Deadparasite";
    itemtype[25] = 26;
    itemdesc[25] = "a Parasite carcass";
    itemname[26] = "Deadrslime";
    itemtype[26] = 26;
    itemdesc[26] = "a Redslime carcass";
    itemname[27] = "Deadleech";
    itemtype[27] = 26;
    itemdesc[27] = "a Leech carcass";
    itemname[28] = "DeadGspider";
    itemtype[28] = 26;
    itemdesc[28] = "a Gspider carcass";
    itemname[29] = "Deadbat";
    itemtype[29] = 26;
    itemdesc[29] = "a Bat carcass";
    itemname[30] = "Eyedrops";
    itemprice[30] = 27;
    itemtype[30] = 25;
    itemdesc[30] = "Heals blindness";
    itemname[31] = "Carrot";
    itemtype[31] = 1;
    healamount[31] = 10;
    itemprice[31] = 5;
    itemdesc[31] = "a fresh carrot";
    itemname[32] = "Turnip";
    itemtype[32] = 1;
    healamount[32] = 15;
    itemprice[32] = 10;
    itemdesc[32] = "a fresh turnip";
    itemname[33] = "Rutabaga";
    itemtype[33] = 1;
    healamount[33] = 20;
    itemprice[33] = 20;
    itemdesc[33] = "a fresh sweed";
    itemname[34] = "Beet";
    itemtype[34] = 2;
    healamount[34] = 5;
    itemprice[34] = 10;
    itemdesc[34] = "a fresh beet";
    itemname[35] = "Beans";
    itemtype[35] = 2;
    healamount[35] = 10;
    itemprice[35] = 20;
    itemdesc[35] = "a bag of beans";
    itemname[36] = "Potato";
    itemtype[36] = 1;
    healamount[36] = 10;
    itemprice[36] = 10;
    itemdesc[36] = "a fresh potato";
    itemname[37] = "Raddish";
    itemtype[37] = 1;
    healamount[37] = 10;
    itemprice[37] = 10;
    itemdesc[37] = "a fresh raddish";
    itemdesc[1] = "Heals  20 hp";
    itemdesc[2] = "Heals   5 hp";
    itemdesc[3] = "Heals   5 hp";
    itemdesc[4] = "Heals  10 hp";
    itemdesc[5] = "Heals  15 hp";
    itemdesc[6] = "Heals  50 hp";
    itemdesc[11] = "Raises Agi by 1";
    itemdesc[13] = "Cures poison ";
    itemdesc[12] = "Raises str by 1 ";
}
void equipmentnames() {
    equipmentname[0] = "None";
    equipmentname[1] = "W.bracelet";
    equhpadd[1] = 0;
    equmpadd[1] = 0;
    equstradd[1] = 0;
    equstaadd[1] = 0;
    equagiadd[1] = 0;
    equaadd[1] = 0;
    equintadd[1] = 0;
    equipmentdesc[1] = "prevents paralyze";
    equipmentname[2] = "S. earrings";
    equhpadd[2] = 0;
    equmpadd[2] = 0;
    equstradd[2] = 0;
    equstaadd[2] = 0;
    equagiadd[2] = 0;
    equaadd[2] = 0;
    equintadd[2] = 0;
    equipmentdesc[2] = "prevents curse";
    equipmentname[3] = "G. ribbon";
    equhpadd[3] = 0;
    equmpadd[3] = 0;
    equstradd[3] = 0;
    equstaadd[3] = 0;
    equagiadd[3] = 0;
    equaadd[3] = 0;
    equintadd[3] = 0;
    equipmentdesc[3] = "prevents poison";
    equipmentname[0] = "None";
    equipmentname[4] = "G. medallion";
    equhpadd[4] = 0;
    equmpadd[4] = 0;
    equstradd[4] = 1;
    equstaadd[4] = 1;
    equagiadd[4] = 0;
    equaadd[4] = 0;
    equintadd[4] = 0;
    equipmentdesc[4] = "Mothers medallion";
    equipmentname[5] = "Jesteridol";
    equhpadd[5] = 0;
    equmpadd[5] = 0;
    equstradd[5] = 0;
    equstaadd[5] = 0;
    equagiadd[5] = 0;
    equaadd[5] = 0;
    equintadd[5] = 0;
    equipmentdesc[5] = "prevents grazy";
    equipmentname[6] = "Ring";
    equhpadd[6] = 0;
    equmpadd[6] = 0;
    equstradd[6] = 1;
    equstaadd[6] = 0;
    equagiadd[6] = 0;
    equaadd[6] = 0;
    equintadd[6] = 0;
    equipmentdesc[6] = "raises strenght";
}
void shitems() {
    a = 100;
    showitems();
    temp[9023] = inmenu[1] + 1;
    For(x = 1; x < temp[9023]; x++) {
        if (itemamount[inmenuitem[x]] > 0) {
            gotoxy(10, a);
            printstring(font, itemname[inmenuitem[x]]);
            gotoxy(120, a);
            itemtypes();
            printstring(font, itetype[inmenuitem[x]]);
            gotoxy(220, a);
            printstring(font, itemdesc[inmenuitem[x]]);
            gotoxy(360, a);
            itamount[inmenuitem[x]] = str(itemamount[inmenuitem[x]]);
            printstring(font, itamount[inmenuitem[x]]);
            if (shop > 0) {
                gotoxy(400, a);
                temp[450] = itemprice[inmenuitem[x]] / 2;
                tempstring[4] = str(temp[450]);
                printstring(font, tempstring[4]);
            }
            a = a + 10;
        }
    }
}
void showitems() {
    y = 1;
    inmenu[1] = 0;
    For(x = 1; x < 500; x++) {
        if (itemamount[item[x]] > 0) {
            inmenuitem[y] = item[x];
            healamount[inmenuitem[y]] = healamount[item[x]];
            itemamount[inmenuitem[y]] = itemamount[item[x]];
            itemprice[inmenuitem[y]] = itemprice[item[x]];
            inmenu[1] = inmenu[1] + 1;
            y = y + 1;
        }
    }
}
void itemtypes() {
    switch (itemtype[inmenuitem[x]]) {
    case 1:
        itetype[inmenuitem[x]] = "Heal(Hp)";
    case 2:
        itetype[inmenuitem[x]] = "Heal(Mp)";
    case 3:
        itetype[inmenuitem[x]] = "Heal(Hp+Mp)";
    case 4:
        itetype[inmenuitem[x]] = "Cure(Poison)";
    case 5:
        itetype[inmenuitem[x]] = "Cure(Sleep)";
    case 6:
        itetype[inmenuitem[x]] = "Cure(Silence)";
    case 7:
        itetype[inmenuitem[x]] = "Cure(Insanity)";
    case 8:
        itetype[inmenuitem[x]] = "Cure(Skillness)";
    case 9:
        itetype[inmenuitem[x]] = "Cure(Stroke)";
    case 10:
        itetype[inmenuitem[x]] = "Cure(Curse)";
    case 11:
        itetype[inmenuitem[x]] = "Heal(All)";
    case 12:
        itetype[inmenuitem[x]] = "Attack enemy";
    case 13:
        itetype[inmenuitem[x]] = "Raise(Str)";
    case 14:
        itetype[inmenuitem[x]] = "Raise(Maxhp)";
    case 15:
        itetype[inmenuitem[x]] = "Raise(Maxmp)";
    case 16:
        itetype[inmenuitem[x]] = "Raise(Agi)";
    case 17:
        itetype[inmenuitem[x]] = "Raise(Sta)";
    case 18:
        itetype[inmenuitem[x]] = "Raise(A)";
    case 19:
        itetype[inmenuitem[x]] = "Raise(Int)";
    case 20:
        itetype[inmenuitem[x]] = "Raise(Ws)";
    case 21:
        itetype[inmenuitem[x]] = "Raise(Ac)";
    case 22:
        itetype[inmenuitem[x]] = "Cure(berserk)";
    case 23:
        itetype[inmenuitem[x]] = "Cure(zombie)";
    case 24:
        itetype[inmenuitem[x]] = "Cure(paralyze)";
    case 26:
        itetype[inmenuitem[x]] = "Carcass";
    case 25:
        itetype[inmenuitem[x]] = "Cure(blind)";
    }
}
void characternames() {
    charname[1] = "Elliot";
    charname[2] = "Peggy";
    charname[3] = "Ralf";
    charname[4] = "Jack";
    charname[5] = "Ragnar";
    charname[6] = "Tanya";
    charname[7] = "Freuden";
}
void freemenupics() {
    free(mpic1);
    free(mpic2);
    free(mpic3);
    free(mpic4);
    free(mpic5);
    free(mpic6);
    free(pointer1);
    free(charpotr[1]);
    free(charpic[1]);
    free(charpic[6]);
    free(charpic[4]);
    free(charpic[7]);
}
void loadmenupics() {
    mpic1 = loadimage("menu.pcx");
    mpic2 = loadimage("ibox1.pcx");
    mpic3 = loadimage("ibox1.pcx");
    mpic4 = loadimage("ibox1.pcx");
    mpic5 = loadimage("ibox1.pcx");
    mpic6 = loadimage("menu1.pcx");
    charpic[1] = loadimage("elliotb.pcx");
    charpic[6] = loadimage("tan.pcx");
    charpic[4] = loadimage("jc.pcx");
    charpic[7] = loadimage("lgilr.pcx");
    pointer1 = loadimage("point.pcx");
}
void partypics() {
    switch (inparty[1]) {
    case 1:
        tscalesprite(250, 223, 96, 96, 16, 16, charpic[1]);
    case 2:
        tscalesprite(250, 223, 96, 96, 16, 16, charpic[3]);
    case 3:
        tscalesprite(250, 223, 96, 96, 16, 16, charpic[3]);
    case 4:
        tscalesprite(250, 223, 96, 96, 16, 16, charpic[4]);
    case 5:
        tscalesprite(250, 223, 96, 96, 16, 16, charpic[3]);
    case 6:
        tscalesprite(250, 223, 96, 96, 16, 16, charpic[6]);
    case 7:
        tscalesprite(250, 223, 96, 96, 16, 16, charpic[7]);
    }
    switch (inparty[2]) {
    case 1:
        tscalesprite(250 + 17, 223, 96, 96, 16, 16, charpic[1]);
    case 2:
        tscalesprite(250 + 17, 223, 96, 96, 16, 16, charpic[3]);
    case 3:
        tscalesprite(250 + 17, 223, 96, 96, 16, 16, charpic[3]);
    case 4:
        tscalesprite(250 + 17, 223, 96, 96, 16, 16, charpic[4]);
    case 5:
        tscalesprite(250 + 17, 223, 96, 96, 16, 16, charpic[3]);
    case 6:
        tscalesprite(250 + 17, 223, 96, 96, 16, 16, charpic[6]);
    case 7:
        tscalesprite(250 + 17, 223, 96, 96, 16, 16, charpic[7]);
    }
    switch (inparty[3]) {
    case 1:
        tscalesprite(250 + 34, 223, 96, 96, 16, 16, charpic[1]);
    case 2:
        tscalesprite(250 + 34, 223, 96, 96, 16, 16, charpic[3]);
    case 3:
        tscalesprite(250 + 34, 223, 96, 96, 16, 16, charpic[3]);
    case 4:
        tscalesprite(250 + 34, 223, 96, 96, 16, 16, charpic[4]);
    case 5:
        tscalesprite(250 + 34, 223, 96, 96, 16, 16, charpic[3]);
    case 6:
        tscalesprite(250 + 34, 223, 96, 96, 16, 16, charpic[6]);
    case 7:
        tscalesprite(250 + 34, 223, 96, 96, 16, 16, charpic[7]);
    }
    switch (inparty[4]) {
    case 1:
        tscalesprite(250 + 51, 223, 96, 96, 16, 16, charpic[1]);
    case 2:
        tscalesprite(250 + 51, 223, 96, 96, 16, 16, charpic[3]);
    case 3:
        tscalesprite(250 + 51, 223, 96, 96, 16, 16, charpic[3]);
    case 4:
        tscalesprite(250 + 51, 223, 96, 96, 16, 16, charpic[4]);
    case 5:
        tscalesprite(250 + 51, 223, 96, 96, 16, 16, charpic[3]);
    case 6:
        tscalesprite(250 + 51, 223, 96, 96, 16, 16, charpic[6]);
    case 7:
        tscalesprite(250 + 51, 223, 96, 96, 16, 16, charpic[7]);
    }
}
void weaponnames() {
    weaponname[0] = "Bare hands";
    weapontype[0] = 0;
    weaponbasetype[0] = 0;
    weapondesc[0] = "Just hands";
    whpadd[0] = 0;
    wmpadd[0] = 0;
    wstradd[0] = 0;
    wintadd[0] = 0;
    wstaadd[0] = 0;
    wagiadd[0] = 0;
    waadd[0] = 0;
    wacadd[0] = 0;
    wthacoadd[0] = 0;
    weapondamage[0] = 10 + random(5);
    weaponname[1] = "Wooden sword";
    weapontype[1] = 1;
    weaponbasetype[1] = 1;
    whpadd[1] = 5;
    wmpadd[1] = 0;
    wstradd[1] = 1;
    wstaadd[1] = 0;
    wintadd[1] = 0;
    wagiadd[1] = 0;
    waadd[1] = 0;
    wacadd[1] = 0;
    wthacoadd[1] = 0;
    weapondamage[1] = 15 + random(10);
    weaponprice[1] = 50;
    weapondesc[1] = "a boys toy";
    weaponprice[2] = 65;
    weaponname[2] = "Iron sword";
    weapontype[2] = 1;
    whpadd[2] = 10;
    wmpadd[2] = 0;
    wstradd[2] = 2;
    wstaadd[2] = 0;
    wintadd[2] = 0;
    wacadd[2] = 0;
    wthacoadd[2] = 1;
    weapondesc[2] = "a sharp metalblade";
    weaponname[3] = "Shortsword";
    weapondesc[3] = "a small blade";
    weapontype[3] = 1;
    weaponbasetype[3] = 1;
    whpadd[3] = 5;
    wmpadd[3] = 0;
    wstradd[3] = 2;
    wstaadd[3] = 0;
    wintadd[3] = 0;
    wagiadd[3] = 0;
    waadd[3] = 0;
    wacadd[3] = 0;
    wthacoadd[3] = 0;
    weapondamage[3] = 15 + random(10);
    weaponprice[3] = 150;
    weaponname[4] = "Silverblade";
    weaponprice[4] = 95;
    whpadd[4] = 50;
    wmpadd[4] = 2;
    wstradd[4] = 2;
    wintadd[4] = 3;
    wacadd[4] = 0;
    wthacoadd[4] = 3;
    weapondesc[4] = "an elven blade";
    weaponname[5] = "Platinum sword";
    whpadd[5] = 65;
    weapondesc[5] = "a blade with stamina";
    weaponname[6] = "Mighty blade";
    whpadd[6] = 80;
    weapondesc[6] = "a long iron sword";
    weaponname[7] = "Giant sword";
    whpadd[7] = 100;
    weapondesc[7] = "a two handed blade";
    weaponname[8] = "Deathstalker";
    whpadd[8] = 120;
    weapondesc[8] = "an undead sword";
    weaponname[9] = "Spirit sword";
    whpadd[9] = 150;
    weapondesc[9] = "a blade with int";
    weaponname[10] = "Arma blade";
    weapondesc[10] = "a gigantic, shiny sword";
    weaponname[11] = "Convicion";
    weapondesc[11] = "a mermen's treasure";
    weaponname[12] = "Exelent";
    weapondesc[12] = "a sknall's treasure";
    weaponname[13] = "Magic sword";
    weapondesc[13] = "a magical blade";
    weaponname[14] = "Blue sword";
    weapondesc[14] = "a jewelry blade";
    weaponname[15] = "Diamond blade";
    weapondesc[15] = "a sword with toughness";
    weaponname[16] = "Darkblade";
    weapondesc[16] = "a blade of darkness";
    weaponname[17] = "Light sword";
    weapondesc[17] = "a blade of humanity";
    weaponname[18] = "Angel sword";
    weapondesc[18] = "a heavenly metalblade";
    weaponname[19] = "Quarablade";
    whpadd[19] = 2000;
    weapondesc[19] = "a legendary sword";
    weaponname[20] = "Orion";
    weapondesc[20] = "a sword with power";
    weaponname[21] = "Bowgun";
    weapondesc[21] = "a short bowgun";
    weapontype[21] = 11;
    whpadd[21] = 5;
    wmpadd[21] = 0;
    wstradd[21] = 1;
    wstaadd[21] = 0;
    wintadd[21] = 0;
    wacadd[21] = 0;
    wthacoadd[21] = 0;
    wstaadd[21] = 0;
    wagiadd[21] = 1;
    waadd[21] = 0;
    weaponprice[21] = 75;
    weapondamage[21] = 10 + random(10);
    weaponname[22] = "Slingshot";
    weapondesc[22] = "a small slingshot";
    weapontype[22] = 10;
    whpadd[22] = 5;
    wmpadd[22] = 0;
    wstradd[22] = 1;
    wstaadd[22] = 0;
    wintadd[22] = 0;
    wacadd[22] = 0;
    wthacoadd[22] = 0;
    wstaadd[22] = 0;
    wagiadd[22] = 1;
    waadd[22] = 0;
    weaponprice[22] = 30;
    weapondamage[22] = 10 + random(10);
    weaponname[23] = "Dagger";
    weapondesc[23] = "a small dagger";
    weapontype[23] = 2;
    whpadd[23] = 3;
    wmpadd[23] = 0;
    wstradd[23] = 0;
    wstaadd[23] = 0;
    wintadd[23] = 0;
    wacadd[23] = 0;
    wthacoadd[23] = 0;
    wstaadd[23] = 0;
    wagiadd[23] = 2;
    waadd[23] = 0;
    weaponprice[23] = 35;
    weapondamage[23] = 5 + random(15);
}

void armornames() {
    armorname[0] = "None";
    armorname[1] = "Clothes";
    armorprice[1] = 20;
    armhpadd[1] = 0;
    armmpadd[1] = 0;
    armstradd[1] = 0;
    armstaadd[1] = 0;
    armintadd[1] = 0;
    armagiadd[1] = 0;
    armaadd[1] = 0;
    armacadd[1] = 0;
    armthacoadd[1] = 0;
    armordesc[1] = "Ordinary clothes";
    armortype[1] = 1;
    armorprice[2] = 50;
    armorname[2] = "Breastplate";
    armordesc[2] = "A metal plate";
    armorname[3] = "Bandana";
    armordesc[3] = "Just a ragbandana";
    armortype[3] = 2;
    armhpadd[3] = 0;
    armmpadd[3] = 0;
    armstradd[3] = 0;
    armstaadd[3] = 1;
    armintadd[3] = 0;
    armagiadd[3] = 0;
    armaadd[3] = 0;
    armacadd[3] = 0;
    armthacoadd[3] = 0;
    armorprice[3] = 10;
    armorname[4] = "Shoes";
    armhpadd[4] = 0;
    armmpadd[4] = 0;
    armstradd[4] = 0;
    armstaadd[4] = 0;
    armintadd[4] = 0;
    armagiadd[4] = 0;
    armaadd[4] = 0;
    armacadd[4] = 0;
    armthacoadd[4] = 0;
    armorprice[4] = 20;
    armordesc[4] = "Ordinary shoes";
    armortype[4] = 4;
    armorname[5] = "Wooden shield";
    armhpadd[5] = 0;
    armmpadd[5] = 0;
    armorprice[5] = 25;
    armstradd[5] = 0;
    armstaadd[5] = 0;
    armintadd[5] = 0;
    armagiadd[5] = 0;
    armaadd[5] = 0;
    armacadd[5] = 3;
    armthacoadd[5] = 0;
    armordesc[5] = "Made from oak";
    armortype[5] = 6;
    armorname[6] = "Round hat";
    armhpadd[6] = 0;
    armmpadd[6] = 0;
    armstradd[6] = 0;
    armstaadd[6] = 0;
    armintadd[6] = 0;
    armagiadd[6] = 0;
    armaadd[6] = 0;
    armacadd[6] = 0;
    armthacoadd[6] = 0;
    armorprice[6] = 15;
    armordesc[6] = "a cowboy hat";
    armortype[6] = 2;
    armorname[7] = "Leather hat";
    armhpadd[7] = 0;
    armmpadd[7] = 0;
    armstradd[7] = 0;
    armstaadd[7] = 0;
    armintadd[7] = 0;
    armagiadd[7] = 0;
    armaadd[7] = 0;
    armacadd[7] = 1;
    armthacoadd[7] = 0;
    armorprice[7] = 20;
    armordesc[7] = "hat made of leather";
    armortype[7] = 2;
    armorname[8] = "L. jacket";
    armhpadd[8] = 0;
    armmpadd[8] = 0;
    armstradd[8] = 0;
    armstaadd[8] = 0;
    armintadd[8] = 0;
    armagiadd[8] = 0;
    armaadd[8] = 0;
    armacadd[8] = 1;
    armthacoadd[8] = 0;
    armordesc[8] = "a leatherjacket";
    armortype[8] = 1;
    armorprice[8] = 30;
    armorname[9] = "L.leggings";
    armhpadd[9] = 0;
    armmpadd[9] = 0;
    armstradd[9] = 0;
    armstaadd[9] = 0;
    armintadd[9] = 0;
    armagiadd[9] = 0;
    armaadd[9] = 0;
    armacadd[9] = 2;
    armthacoadd[9] = 0;
    armorprice[9] = 25;
    armordesc[9] = "leatherleggings";
    armortype[9] = 4;
    armorname[10] = "L.boots";
    armhpadd[10] = 0;
    armmpadd[10] = 0;
    armstradd[10] = 0;
    armstaadd[10] = 0;
    armintadd[10] = 0;
    armagiadd[10] = 0;
    armaadd[10] = 0;
    armacadd[10] = 1;
    armthacoadd[10] = 0;
    armorprice[10] = 15;
    armordesc[10] = "leatherboots";
    armortype[10] = 4;
    armorname[11] = "L.vest";
    armhpadd[11] = 0;
    armmpadd[11] = 0;
    armstradd[11] = 0;
    armstaadd[11] = 0;
    armintadd[11] = 0;
    armagiadd[11] = 0;
    armaadd[11] = 0;
    armacadd[11] = 2;
    armthacoadd[11] = 0;
    armordesc[11] = "vest made of leather";
    armortype[11] = 1;
    armorprice[11] = 20;
    armorname[12] = "L.helm";
    armhpadd[12] = 0;
    armmpadd[12] = 0;
    armstradd[12] = 0;
    armstaadd[12] = 0;
    armintadd[12] = 0;
    armagiadd[12] = 0;
    armaadd[12] = 0;
    armacadd[12] = 2;
    armthacoadd[12] = 0;
    armorprice[12] = 35;
    armordesc[12] = "a leatherhelmet";
    armortype[12] = 2;
    armorname[13] = "Oak shield";
    armhpadd[13] = 0;
    armmpadd[13] = 0;
    armstradd[13] = 0;
    armstaadd[13] = 0;
    armintadd[13] = 0;
    armagiadd[13] = 0;
    armaadd[13] = 0;
    armacadd[13] = 3;
    armthacoadd[13] = 0;
    armorprice[13] = 40;
    armordesc[13] = "a hard shield";
    armortype[13] = 6;
    armorname[14] = "Slingshot";
    armortype[14] = 6;
    armorname[15] = "Chainmail";
    armordesc[15] = "shirt made of iron";
    armortype[15] = 1;
    armhpadd[15] = 0;
    armmpadd[15] = 0;
    armstradd[15] = 0;
    armstaadd[15] = 0;
    armintadd[15] = 0;
    armagiadd[15] = 0;
    armaadd[15] = 0;
    armacadd[15] = 3;
    armthacoadd[15] = 0;
    armorprice[15] = 200;
    armorname[16] = "Chaincoif";
    armordesc[16] = "hood made of iron";
    armortype[16] = 2;
    armhpadd[16] = 0;
    armmpadd[16] = 0;
    armstradd[16] = 0;
    armstaadd[16] = 0;
    armintadd[16] = 0;
    armagiadd[16] = 0;
    armaadd[16] = 0;
    armacadd[16] = 3;
    armthacoadd[16] = 0;
    armorprice[16] = 100;
    armorname[17] = "Gauntlets";
    armordesc[17] = "iron gauntlets";
    armortype[17] = 6;
    armhpadd[17] = 0;
    armmpadd[17] = 0;
    armstradd[17] = 0;
    armstaadd[17] = 0;
    armintadd[17] = 0;
    armagiadd[17] = 0;
    armaadd[17] = 0;
    armacadd[17] = 2;
    armthacoadd[17] = 0;
    armorprice[17] = 130;
    armorname[18] = "Dwarfboots";
    armordesc[18] = "Heavy boots";
    armortype[18] = 4;
    armhpadd[18] = 0;
    armmpadd[18] = 0;
    armstradd[18] = 0;
    armstaadd[18] = 0;
    armintadd[18] = 0;
    armagiadd[18] = 0;
    armaadd[18] = 0;
    armacadd[18] = 2;
    armthacoadd[18] = 0;
    armorprice[18] = 60;
}
void shopweapons() {
    switch (weapongroup) {
    case 1:
        shopweapon[1] = 1;
        shopweapon[2] = 3;
        shopweapon[3] = 21;
        shopweapon[4] = 22;
        shopweapon[5] = 23;
    }
}
void shoparmors() {
    switch (armorgroup) {
    case 1:
        shoparmor[1] = 15;
        shoparmor[2] = 16;
        shoparmor[3] = 17;
        shoparmor[4] = 18;

    case 2:
        shoparmor[1] = 15;
        shoparmor[2] = 16;
        shoparmor[3] = 17;
    }
}

void shopitems() {
    switch (itemgroup) {
    case 1:
        shopitem[1] = 1;
        shopitem[2] = 2;
        shopitem[3] = 3;
        shopitem[4] = 4;
        shopitem[5] = 5;
        shopitem[6] = 6;
        shopitem[7] = 13;
        shopitem[8] = 14;
        shopitem[9] = 15;
        shopitem[10] = 16;

    case 2:
        shopitem[1] = 1;
        shopitem[2] = 6;
        shopitem[3] = 8;
        shopitem[4] = 16;
        shopitem[5] = 17;
        shopitem[6] = 20;
        shopitem[7] = 21;
        shopitem[8] = 13;
        shopitem[9] = 14;
    case 3:
        shopitem[1] = 31;
        shopitem[2] = 32;
        shopitem[3] = 33;
        shopitem[4] = 34;
        shopitem[5] = 35;
        shopitem[6] = 36;
        shopitem[7] = 37;
    }
}
void addcharacter(int char) {
    if (inparty[1] = 0 && added = 0) {
        inparty[1] = char;
        added = 1;
    }
    if (inparty[1] > 0 && inparty[2] = 0 && added = 0) {
        inparty[2] = char;
        added = 1;
    }
    if (inparty[1] > 0 && inparty[2] > 0 && inparty[3] = 0 && added = 0) {
        inparty[3] = char;
        added = 1;
    }
    if (inparty[1] > 0 && inparty[2] > 0 && inparty[3] > 0 && inparty[4] =
            0 && added = 0) {
        inparty[4] = char;
        added = 1;
    }
    if (inparty[1] > 0 && inparty[2] > 0 && inparty[3] > 0 &&
            inparty[4] > 0 && added = 0) {
        added = 1;
    }
    numchars = numchars + 1;
    numchars2 = numchars + 1;
    added = 0;
}

void removecharacter(int char) {
    if (inparty[1] = char&& removed = 0) {
        inparty[1] = 0;
        removed = 1;
    }
    if (inparty[2] = char&& removed = 0) {
        inparty[2] = 0;
        removed = 1;
    }
    if (inparty[3] = char&& removed = 0) {
        inparty[3] = 0;
        removed = 1;
    }
    if (inparty[4] = char&& removed = 0) {
        inparty[4] = 0;
        removed = 1;
    }
    numchars = numchars - 1;
    numchars2 = numchars - 1;
    removed = 0;
}
void jukeboxmenuparts() {
    Tcopysprite(0, 0, 640, 480, mpic1);
    Tcopysprite(0, 0, 179, 29, mpic3);
    gotoXY(10, 10);
    printstring(1, "Musicmenu");
    gotoxy(10, 80);
    printstring(font, "Song name:");
    gotoxy(280, 80);
    printstring(font, "Song duration:");
    gotoXY(280, 10);
    printstring(1, "Music Volume: ");
    song = str(menupnt[6]);
    printstring(1, song);
    gotoXY(400, 80);
    printstring(1, songpages + " / " + maxsongpage);
    gotoxy(10, 450);
    printstring(font, "Press Shift to change songpages");
}
void showsongs() {
    if (songpage = 1) {
        gotoxy(10, 100);
        printstring(font, "The Curse of Dragmoria");
        gotoxy(280, 100);
        printstring(font, "3.32 mins");
        gotoxy(10, 110);
        printstring(font, "The Night is falling");
        gotoxy(280, 110);
        printstring(font, "0.49 mins");
        gotoxy(10, 120);
        printstring(font, "Marquis Efrine theme");
        gotoxy(280, 120);
        printstring(font, "2.18 mins");
        gotoxy(10, 130);
        printstring(font, "The slums of Dalari");
        gotoxy(280, 130);
        printstring(font, "1.47 mins");
        gotoxy(10, 140);
        printstring(font, "The citizens");
        gotoxy(280, 140);
        printstring(font, "1.24 mins");
        gotoxy(10, 150);
        printstring(font, "The castle watchtower");
        gotoxy(280, 150);
        printstring(font, "0.59 mins");
        gotoxy(10, 160);
        printstring(font, "The Dalari sewers");
        gotoxy(280, 160);
        printstring(font, "1.05 mins");
        gotoxy(10, 170);
        printstring(font, "First fight song");
        gotoxy(280, 170);
        printstring(font, "1.20 mins");
        gotoxy(10, 180);
        printstring(font, "Your advantage one");
        gotoxy(280, 180);
        printstring(font, "1.12 mins");
        gotoxy(10, 190);
        printstring(font, "Enemy advantage one");
        gotoxy(280, 190);
        printstring(font, "1.09 mins");
        gotoxy(10, 200);
        printstring(font, "Boss battle one");
        gotoxy(280, 200);
        printstring(font, "1.23 mins");
        gotoxy(10, 210);
        printstring(font, "The prophecy");
        gotoxy(280, 210);
        printstring(font, "0.43 mins");
        gotoxy(10, 220);
        printstring(font, "Theme of horror");
        gotoxy(280, 220);
        printstring(font, "0.46 mins");
        gotoxy(10, 230);
        printstring(font, "The majestic structure");
        gotoxy(280, 230);
        printstring(font, "1.47 mins");
        gotoxy(10, 240);
        printstring(font, "Theme of strenght");
        gotoxy(280, 240);
        printstring(font, "1.48 mins");
        gotoxy(10, 250);
        printstring(font, "The gangleader");
        gotoxy(280, 250);
        printstring(font, "0.05 mins");
        gotoxy(10, 260);
        printstring(font, "Quara-ma the warrior");
        gotoxy(280, 260);
        printstring(font, "1.15 mins");
        gotoxy(10, 270);
        printstring(font, "Victory!!!");
        gotoxy(280, 270);
        printstring(font, "0.42 mins");
        gotoxy(10, 280);
        printstring(font, "Major victory!!!");
        gotoxy(280, 280);
        printstring(font, "0.46 mins");
        gotoxy(10, 290);
        printstring(font, "Theme of Quara");
        gotoxy(280, 290);
        printstring(font, "2.46 mins");
        gotoxy(10, 300);
        printstring(font, "The death of Katarina");
        gotoxy(280, 300);
        printstring(font, "3.18 mins");
        gotoxy(10, 310);
        printstring(font, "Dalari at night");
        gotoxy(280, 310);
        printstring(font, "2.20 mins");
        gotoxy(10, 320);
        printstring(font, "Theme of defeat");
        gotoxy(280, 320);
        printstring(font, "0.22 mins");
        gotoxy(10, 330);
        printstring(font, "The caverns");
        gotoxy(280, 330);
        printstring(font, "1.29 mins");
        gotoxy(10, 340);
        printstring(font, "A tender moment");
        gotoxy(280, 340);
        printstring(font, "1.42 mins");
        gotoxy(10, 350);
        printstring(font, "Second battle theme");
        gotoxy(280, 350);
        printstring(font, "1.39 mins");
        gotoxy(10, 360);
        printstring(font, "Your advantage two ");
        gotoxy(280, 360);
        printstring(font, "1.09 mins");
        gotoxy(10, 370);
        printstring(font, "Enemy advantage two ");
        gotoxy(280, 370);
        printstring(font, "0.48 mins");
        gotoxy(10, 380);
        printstring(font, "Boss battle two ");
        gotoxy(280, 380);
        printstring(font, "1.36 mins");
        gotoxy(10, 390);
        printstring(font, "The words of wisdom");
        gotoxy(280, 390);
        printstring(font, "0.38 mins");
        gotoxy(10, 400);
        printstring(font, "The palace courtyard");
        gotoxy(280, 400);
        printstring(font, "1.09 mins");
        gotoxy(10, 410);
        printstring(font, "Creature of the night");
        gotoxy(280, 410);
        printstring(font, "0.49 mins");
        gotoxy(10, 420);
        printstring(font, "The night of the lord");
        gotoxy(280, 420);
        printstring(font, "2.50 mins");
        gotoxy(10, 430);
        printstring(font, "Theme of love");
        gotoxy(280, 430);
        printstring(font, "1.27 mins");
    }
    if (songpage = 2) {
        gotoxy(10, 100);
        printstring(font, "The Grande marquis");
        gotoxy(280, 100);
        printstring(font, "1.57 mins");
        gotoxy(10, 110);
        printstring(font, "The eruption");
        gotoxy(280, 110);
        printstring(font, "1.04 mins");
        gotoxy(10, 120);
        printstring(font, "Please help us!");
        gotoxy(280, 120);
        printstring(font, "1.26 mins");
        gotoxy(10, 130);
        printstring(font, "Theme of Magnus Henrik");
        gotoxy(280, 130);
        printstring(font, "1.47 mins");
        gotoxy(10, 140);
        printstring(font, "The Dalari hotel");
        gotoxy(280, 140);
        printstring(font, "1.29 mins");
        gotoxy(10, 150);
        printstring(font, "The wheel starts turning");
        gotoxy(280, 150);
        printstring(font, "1.26 mins");
        gotoxy(10, 160);
        printstring(font, "The theme of Dalari");
        gotoxy(280, 160);
        printstring(font, "5.56 mins");
        gotoxy(10, 170);
        printstring(font, "The house of God");
        gotoxy(280, 170);
        printstring(font, "2.14 mins");
        gotoxy(10, 180);
        printstring(font, "The adventure begins");
        gotoxy(280, 180);
        printstring(font, "3.09 mins");
        gotoxy(10, 190);
        printstring(font, "Theme of Dalar from TCoD verge1");
        gotoxy(280, 190);
        printstring(font, "0.56 mins");
    }
}
void jukeboxmenu() {
    unpress(key[28]);
    menupnt[5] = 1;
    songpage = 1;
    maxsongpages = 2;
    songpages = str(songpage);
    maxsongpage = str(maxsongpages);
    menupnt[6] = 100;
    while (mmenu = 10) {
        render();
        jukeboxmenuparts();
        showsongs();
        TscaleSprite(0, 90 + (10 * menupnt[5]), 7, 9, 7, 9, pointer1);
        showpage();
        music_volume = menupnt[6];
        songpages = str(songpage);
        updatecontrols();
        If(key[80]) {
            menupnt[5]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            menupnt[5]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[5] < 1) { menupnt[5] = 34; }
        if (menupnt[5] > 34) {
            menupnt[5] = 1;
        }
        If(key[77]) {
            menupnt[6]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[75]) {
            menupnt[6]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(menupnt[6] < 0) { menupnt[6] = 0; }
        if (menupnt[6] > 200) {
            menupnt[6] = 200;
        }
        If(key[54]) {
            songpage++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(songpage < 1) { songpage = 1; }
        if (songpage > maxsongpages) {
            songpage = 1;
        }
        if (key[29]) {
            unpress(key[29]);
            mmenu = 1;
        }
        if (key[28]) {
            music_volume = 0;
            del(10, 0, 0, 0);
            playmusic("sil.s3m");
            del(10, 0, 0, 0);
            music_volume = menupnt[6];
            if (songpage = 1) {
                switch (menupnt[5]) {
                case 1:
                    playmusic("tcod.s3m");
                case 2:
                    playmusic("strange.s3m");
                case 3:
                    playmusic("palace.s3m");
                case 4:
                    playmusic("slums.s3m");
                case 5:
                    playmusic("goblin.s3m");
                case 6:
                    playmusic("climb.s3m");
                case 7:
                    playmusic("sewers2.s3m");
                case 8:
                    playmusic("battle10.s3m");
                case 9:
                    playmusic("battle13.s3m");
                case 10:
                    playmusic("battle14.s3m");
                case 11:
                    playmusic("boss11.s3m");
                case 12:
                    playmusic("moment.s3m");
                case 13:
                    playmusic("demon.s3m");
                case 14:
                    playmusic("dam.s3m");
                case 15:
                    playmusic("shop1.s3m");
                case 16:
                    playmusic("gilron1.s3m");
                case 17:
                    playmusic("boss13.s3m");
                case 18:
                    playmusic("vict3.s3m");
                case 19:
                    playmusic("vict1.s3m");
                case 20:
                    playmusic("moria.s3m");
                case 21:
                    playmusic("sorrow.s3m");
                case 22:
                    playmusic("journey6.s3m");
                case 23:
                    playmusic("dead.s3m");
                case 24:
                    playmusic("journe13.s3m");
                case 25:
                    playmusic("love2.s3m");
                case 26:
                    playmusic("battle15.s3m");
                case 27:
                    playmusic("battle18.s3m");
                case 28:
                    playmusic("battle2.s3m");
                case 29:
                    playmusic("boss5.s3m");
                case 30:
                    playmusic("some17.s3m");
                case 31:
                    playmusic("palace2.s3m");
                case 32:
                    playmusic("castle.s3m");
                case 33:
                    playmusic("gatza.s3m");
                case 34:
                    playmusic("love.s3m");
                }
            }
            if (songpage = 2) {
                switch (menupnt[5]) {
                case 1:
                    playmusic("journe18.s3m");
                case 2:
                    playmusic("erupt.s3m");
                case 3:
                    playmusic("dalari3.s3m");
                case 4:
                    playmusic("journe24.s3m");
                case 5:
                    playmusic("hotel.s3m");
                case 6:
                    playmusic("town4.s3m");
                case 7:
                    playmusic("dalari.s3m");
                case 8:
                    playmusic("church.s3m");
                case 9:
                    playmusic("palace6.s3m");
                case 10:
                    playmusic("agony.s3m");
                }
            }
        }
    }
}

void optionmenuparts() {
    Tcopysprite(0, 0, 640, 480, mpic1);
    Tcopysprite(0, 0, 179, 29, mpic3);
    gotoXY(10, 10);
    printstring(1, "Optionmenu");
    gotoxy(10, 80);
    printstring(font, "Option name:");
    gotoxy(110, 80);
    printstring(font, "Option effect:");
    gotoxy(350, 80);
    printstring(font, "Currently:");
}
void optionmenu() {
    unpress(key[28]);
    optionpnt[1] = 1;
    optionpnt[2] = 1;
    while (mmenu = 8) {
        render();
        optionmenuparts();
        TscaleSprite(0, 90 + (10 * optionpnt[1]), 7, 9, 7, 9, pointer1);
        showoptions();
        Tcopysprite(465, 450, 179, 29, mpic3);
        gotoxy(490, 455);
        printstring(font, "Select option");
        showpage();
        updatecontrols();
        If(key[80]) {
            optionpnt[1]++;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(key[72]) {
            optionpnt[1]--;
            playsound(menuitemsound, 64, 128);
            del(10, 0, 0, 0);
        }
        If(optionpnt[1] < 1) { optionpnt[1] = 34; }
        if (optionpnt[1] > 34) {
            optionpnt[1] = 1;
        }
        if (key[29]) {
            unpress(key[29]);
            mmenu = 1;
        }
        if (key[28]) {
            unpress(key[28]);
            mmenu = 10;
            while (mmenu = 10) {
                render();
                optionmenuparts();
                TscaleSprite(0, 90 + (10 * optionpnt[1]), 7, 9, 7, 9, pointer1);
                showoptions();
                Tcopysprite(465, 380, 179, 29, mpic3);
                Tcopysprite(465, 410, 179, 29, mpic3);
                gotoxy(490, 385);
                printstring(font, "Optionstatus?");
                gotoxy(490, 415);
                printstring(font, " On ");
                gotoxy(560, 415);
                printstring(font, " Off ");
                switch (optionpnt[2]) {
                case 1:
                    TscaleSprite(485, 415, 7, 9, 7, 9, pointer1);
                case 2:
                    TscaleSprite(555, 415, 7, 9, 7, 9, pointer1);
                }
                showpage();
                updatecontrols();
                If(key[77]) {
                    optionpnt[2]++;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                If(key[75]) {
                    optionpnt[2]--;
                    playsound(menuitemsound, 64, 128);
                    del(10, 0, 0, 0);
                }
                if (optionpnt[2] < 1) {
                    optionpnt[2] = 2;
                }
                if (optionpnt[2] > 2) {
                    optionpnt[2] = 1;
                }
                if (key[28]) {
                    unpress(key[28]);
                    switch (optionpnt[1]) {
                    case 1:
                        if (optionpnt[2] = 1) {
                            boxes = 0;
                            mmenu = 8;
                        }
                        if (optionpnt[2] = 2) {
                            boxes = 1;
                            mmenu = 8;
                        }
                    }
                }
            }
        }
    }
}

void showoptions() {
    gotoxy(10, 100);
    printstring(font, "Textbox");
    gotoxy(110, 100);
    printstring(font, "Textbox either on or off");
    if (boxes = 0) {
        gotoxy(350, 100);
        printstring(font, "-On-");
    }
    if (boxes = 1) {
        gotoxy(350, 100);
        printstring(font, "-Off-");
    }
}
